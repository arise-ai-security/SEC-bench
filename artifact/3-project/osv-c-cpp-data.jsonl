{"instance_id": "php.osv-2021-1670", "repo": "php/php-src", "base_commit": "9c6b843ff0f4b7af926a69ef89d7f9ec1db31866", "date": "2021-12-07T14:26:19", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 9c6b843ff0f4b7af926a69ef89d7f9ec1db31866\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=42156\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4681290541039616\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-parser\nJob Type: libfuzzer_asan_i386_php\nPlatform Id: linux\n\nCrash Type: Dynamic-stack-buffer-overflow READ 4\nCrash Address: 0xffdcb0e8\nCrash State:\n  zend_calc_live_ranges\n  pass_two\n  zend_compile_func_decl\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_i386_php&range=202112020608:202112090606\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4681290541039616\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "91734fc5795bc07dc718f9d884a014a90097e56f", "url": "https://github.com/php/php-src.git/commit/91734fc5795bc07dc718f9d884a014a90097e56f"}]}
{"instance_id": "icu.osv-2020-867", "repo": "unicode-org/icu", "base_commit": "f4f74c1f2ee380c20434f224d7fea05fdb4e91d6", "date": "2022-03-31T19:39:13", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout f4f74c1f2ee380c20434f224d7fea05fdb4e91d6\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=15613\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5695958395912192\n\nProject: icu\nFuzzer: libFuzzer_icu_collator_rulebased_fuzzer\nFuzz target binary: collator_rulebased_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x614000010698\nCrash State:\n  icu_64::CollationIterator::appendCEsFromCE32\n  icu_64::DataBuilderCollationIterator::fetchCEs\n  icu_64::CollationDataBuilder::getCEs\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=201906250235:201906260234\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5695958395912192\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "4833cc89b2fae2e8863b46bf1dc785964847e882", "url": "https://github.com/unicode-org/icu.git/commit/4833cc89b2fae2e8863b46bf1dc785964847e882"}]}
{"instance_id": "icu.osv-2021-1236", "repo": "unicode-org/icu", "base_commit": "f4f74c1f2ee380c20434f224d7fea05fdb4e91d6", "date": "2022-03-31T19:39:13", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout f4f74c1f2ee380c20434f224d7fea05fdb4e91d6\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=38390\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5448661421654016\n\nProject: icu\nFuzzing Engine: libFuzzer\nFuzz Target: collator_rulebased_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x7f26c3fa77e0\nCrash State:\n  icu_70::UCharsTrie::branchNext\n  icu_70::UCharsTrie::firstForCodePoint\n  icu_70::CollationIterator::nextCE32FromContraction\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=202109090608:202109100613\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5448661421654016\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "4833cc89b2fae2e8863b46bf1dc785964847e882", "url": "https://github.com/unicode-org/icu.git/commit/4833cc89b2fae2e8863b46bf1dc785964847e882"}]}
{"instance_id": "bloaty.osv-2018-134", "repo": "google/bloaty", "base_commit": "a950a61921c3aaaf31e27fad1727a1ddf528df1e", "date": "2018-02-19T16:29:23", "project_name": "bloaty", "lang": "c++", "dockerfile": "# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER jhaberman@gmail.com\nRUN apt-get update && apt-get install -y cmake ninja-build g++\nRUN git clone https://github.com/google/bloaty.git bloaty\nRUN git -C bloaty checkout a950a61921c3aaaf31e27fad1727a1ddf528df1e\nWORKDIR bloaty\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\ncd $WORK\ncmake -G Ninja -DBUILD_TESTING=false $SRC/bloaty\nninja -j$(nproc)\ncp fuzz_target $OUT\nzip -j $OUT/fuzz_target_seed_corpus.zip $SRC/bloaty/tests/testdata/fuzz_corpus/*\n", "work_dir": "/src/bloaty", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=5873\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5703202205859840\n\nProject: bloaty\nFuzzer: libFuzzer_bloaty_fuzz_target\nFuzz target binary: fuzz_target\nJob Type: libfuzzer_asan_bloaty\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x61b000000d80\nCrash State:\n  bloaty::DisassembleFindReferences\n  bloaty::ReadELFSymbols\n  bloaty::ReadELFSymbols\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_bloaty&range=201801250543:201801260542\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5703202205859840\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you have questions for the OSS-Fuzz team, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [], "candidate_fixes": [{"sha": "18384d6c6cbb666d08d08c0dabc4a0d1b7623f6f", "url": "https://github.com/google/bloaty.git/commit/18384d6c6cbb666d08d08c0dabc4a0d1b7623f6f"}]}
{"instance_id": "simdutf.osv-2024-1043", "repo": "simdutf/simdutf", "base_commit": "c87a4a14591703f92f7c48c987bd9322a1e27737", "date": "2024-08-19T15:38:27", "project_name": "simdutf", "lang": "c++", "dockerfile": "# Copyright 2023 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make cmake\nRUN git clone https://github.com/simdutf/simdutf simdutf\nRUN git -C simdutf checkout c87a4a14591703f92f7c48c987bd9322a1e27737\nWORKDIR simdutf\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2024 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nfuzz/build.sh\n", "work_dir": "/src/simdutf", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=71307\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6249684870430720\n\nProject: simdutf\nFuzzing Engine: libFuzzer\nFuzz Target: conversion\nJob Type: libfuzzer_asan_simdutf\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE {*}\nCrash Address: 0x5190000018a1\nCrash State:\n  simdutf::haswell::implementation::convert_utf8_to_latin1\n  Conversion<\n  Conversion<\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_simdutf&range=202408120618:202408130625\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6249684870430720\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "522758e534b731acf43daa91dbaaea91b875acf3", "url": "https://github.com/simdutf/simdutf/commit/522758e534b731acf43daa91dbaaea91b875acf3"}]}
{"instance_id": "php.osv-2020-1787", "repo": "php/php-src", "base_commit": "3b2410ebf6216733410b3d12566ffba3a99519c7", "date": "2020-09-16T04:06:19", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 3b2410ebf6216733410b3d12566ffba3a99519c7\nRUN git clone https://github.com/kkos/oniguruma.git php-src/oniguruma\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build oniguruma and link statically\npushd oniguruma\nautoreconf -vfi\n./configure\nmake -j$(nproc)\npopd\nexport ONIG_CFLAGS=\"-I$PWD/oniguruma/src\"\nexport ONIG_LIBS=\"-L$PWD/oniguruma/src/.libs -l:libonig.a\"\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# build project\n./buildconf\n./configure \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-mbstring \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-mbstring\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=25678\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5146486399303680\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-execute\nJob Type: libfuzzer_msan_php\nPlatform Id: linux\n\nCrash Type: Use-of-uninitialized-value\nCrash Address:\nCrash State:\n  zend_generator_search_multi_children_node\n  zend_generator_add_child\n  zend_generator_yield_from\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_php&range=202008280605:202008290628\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5146486399303680\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "392f0abf687c7519ba02d7d41b9622f0b3d1a8e2", "url": "https://github.com/php/php-src.git/commit/392f0abf687c7519ba02d7d41b9622f0b3d1a8e2"}]}
{"instance_id": "harfbuzz.osv-2018-174", "repo": "harfbuzz/harfbuzz", "base_commit": "f074da8c2b6a7061c71d12213a6c494c119eb20e", "date": "2018-11-03T15:07:39", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout f074da8c2b6a7061c71d12213a6c494c119eb20e\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr\"\n\n# Build the library.\n./autogen.sh\n./configure\nmake clean\nmake -j$(nproc) V=1 all\nmake CPPFLAGS=\"-DHB_NO_VISIBILITY\" -C src V=1 fuzzing\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-fuzzing.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset-fuzzing.a ./src/.libs/libharfbuzz-fuzzing.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shaping/data/in-house/fonts \\\n\ttest/shaping/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11245\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5735679418433536\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x60700000033e\nCrash State:\n  BEInt<unsigned char, 1>::operator unsigned char\n  OT::KernSubTableFormat3::get_kerning\n  hb_kern_machine_t<OT::KernSubTableFormat3>::kern\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201811020143:201811030141\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5735679418433536\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "8d98c51d133b058a845ed7a84bfe8a43083bbb03", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/8d98c51d133b058a845ed7a84bfe8a43083bbb03"}]}
{"instance_id": "libraw.osv-2021-427", "repo": "libraw/libraw", "base_commit": "371161a06d7f98f231a001dad4af2dfb463e270a", "date": "2021-07-27T07:02:08", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout 371161a06d7f98f231a001dad4af2dfb463e270a\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=31181\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5078026003021824\n\nProject: libraw\nFuzzing Engine: libFuzzer\nFuzz Target: libraw_fuzzer\nJob Type: libfuzzer_asan_libraw\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x61900000047f\nCrash State:\n  LibRaw::kodak_c330_load_raw\n  LibRaw::unpack\n  libraw_fuzzer.cc\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libraw&range=202101290609:202101300625\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5078026003021824\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  LibRaw lib_raw;\n\n  int result = lib_raw.open_buffer(\n      const_cast<char*>(reinterpret_cast<const char*>(data)), size);\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "363e91ea656f4ce46584b4b0af6285030f236b7e", "url": "https://github.com/libraw/libraw/commit/363e91ea656f4ce46584b4b0af6285030f236b7e"}]}
{"instance_id": "icu.osv-2020-866", "repo": "unicode-org/icu", "base_commit": "f4f74c1f2ee380c20434f224d7fea05fdb4e91d6", "date": "2022-03-31T19:39:13", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout f4f74c1f2ee380c20434f224d7fea05fdb4e91d6\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=15671\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5693360544677888\n\nProject: icu\nFuzzer: libFuzzer_icu_collator_rulebased_fuzzer\nFuzz target binary: collator_rulebased_fuzzer\nJob Type: libfuzzer_msan_icu\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x7f8c94ee4a30\nCrash State:\n  icu_64::UCharsTrie::branchNext\n  icu_64::UCharsTrie::nextImpl\n  icu_64::UCharsTrie::next\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_icu&range=201906250235:201906260234\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5693360544677888\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "4833cc89b2fae2e8863b46bf1dc785964847e882", "url": "https://github.com/unicode-org/icu.git/commit/4833cc89b2fae2e8863b46bf1dc785964847e882"}]}
{"instance_id": "openjpeg.osv-2017-22", "repo": "uclouvain/openjpeg", "base_commit": "33167ddc13fd20313ccfcdc64141000407b68b8f", "date": "2017-09-08T03:53:52", "project_name": "openjpeg", "lang": "c++", "dockerfile": "# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER antonin@gmail.com\nRUN apt-get update && apt-get install -y make cmake g++\nRUN git clone https://github.com/uclouvain/openjpeg openjpeg\nRUN git -C openjpeg checkout 33167ddc13fd20313ccfcdc64141000407b68b8f\n# openjpeg-data is used to create a seed corpus\nRUN git clone --depth 1 https://github.com/uclouvain/openjpeg-data openjpeg/data\nWORKDIR openjpeg\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir build\ncd build\ncmake ..\nmake clean -s\nmake -j$(nproc) -s\ncd ..\n\n./tests/fuzzers/build_google_oss_fuzzers.sh\n./tests/fuzzers/build_seed_corpus.sh\n", "work_dir": "/src/openjpeg", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3331\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5889118611439616\n\nProject: openjpeg\nFuzzer: libFuzzer_openjpeg_opj_decompress_fuzzer\nFuzz target binary: opj_decompress_fuzzer\nJob Type: libfuzzer_asan_openjpeg\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x613000001848\nCrash State:\n  opj_tcd_mct_decode\n  opj_tcd_decode_tile\n  opj_j2k_decode_tile\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_openjpeg&range=201709070414:201709080414\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5889118611439616\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you have questions for the OSS-Fuzz team, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [], "candidate_fixes": [{"sha": "28094e1ebfa420f9a0bdc7a11b8d4ee5f154db35", "url": "https://github.com/uclouvain/openjpeg/commit/28094e1ebfa420f9a0bdc7a11b8d4ee5f154db35"}]}
{"instance_id": "libavc.osv-2023-117", "repo": "ittiam-systems/libavc", "base_commit": "4900778d4c9f01faa81f6f26327b57ae3b60e3c2", "date": "2023-02-25T12:26:25", "project_name": "libavc", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y wget cmake\nRUN git clone https://github.com/ittiam-systems/libavc.git\nRUN git -C libavc checkout 4900778d4c9f01faa81f6f26327b57ae3b60e3c2\nADD https://storage.googleapis.com/android_media/external/libavc/fuzzer/avc_dec_fuzzer_seed_corpus.zip $SRC/\nCOPY build.sh $SRC/\nWORKDIR libavc", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n# Run the OSS-Fuzz script in the project.\n$SRC/libavc/fuzzer/ossfuzz.sh\n", "work_dir": "/src/libavc", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=56386\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4601031721091072\n\nProject: libavc\nFuzzing Engine: libFuzzer\nFuzz Target: svc_dec_fuzzer\nJob Type: libfuzzer_asan_i386_libavc\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 4\nCrash Address: 0xf15fb808\nCrash State:\n  isvcd_nal_byte_swap_emulation\n  isvcd_nal_parse_non_vcl_nal\n  isvcd_pre_parse_refine_au\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_i386_libavc&range=202302250606:202302260617\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4601031721091072\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "c0ca3b2979a6f0999c57549986f99334666e8ef7", "url": "https://github.com/ittiam-systems/libavc.git/commit/c0ca3b2979a6f0999c57549986f99334666e8ef7"}]}
{"instance_id": "c-ares.osv-2020-630", "repo": "c-ares/c-ares", "base_commit": "5dd3629bc93449840c36dd635ea6cce606b8c366", "date": "2019-06-19T22:04:25", "project_name": "c-ares", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool\nRUN git clone https://github.com/c-ares/c-ares.git\nRUN git -C c-ares checkout 5dd3629bc93449840c36dd635ea6cce606b8c366\nWORKDIR c-ares\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Remove -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION from CFLAGS\n# as a workaround for https://github.com/google/oss-fuzz/issues/413.\n# It's unclear why the c-ares configure is that picky;\n# a better fix would probably be in the c-ares build system.\nCFLAGS=$(for f in $CFLAGS; do [ $f != \"-DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\" ] && echo $f; done);\n\n# Build the project.\n./buildconf\n./configure --enable-debug\nmake clean\nmake -j$(nproc) V=1 all\n\n# Build the fuzzers.\n$CC $CFLAGS -I. -c $SRC/c-ares/test/ares-test-fuzz.c -o $WORK/ares-test-fuzz.o\n$CXX $CXXFLAGS -std=c++11 $WORK/ares-test-fuzz.o \\\n    -o $OUT/ares_parse_reply_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/c-ares/.libs/libcares.a\n\n$CC $CFLAGS -I. -c $SRC/c-ares/test/ares-test-fuzz-name.c \\\n    -o $WORK/ares-test-fuzz-name.o\n$CXX $CXXFLAGS -std=c++11 $WORK/ares-test-fuzz-name.o \\\n    -o $OUT/ares_create_query_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/c-ares/.libs/libcares.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nzip -j $OUT/ares_parse_reply_fuzzer_seed_corpus.zip $SRC/c-ares/test/fuzzinput/*\nzip -j $OUT/ares_create_query_fuzzer_seed_corpus.zip \\\n    $SRC/c-ares/test/fuzznames/*\n", "work_dir": "/src/c-ares", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=15379\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5728518081609728\n\nProject: c-ares\nFuzzer: libFuzzer_c-ares_ares_parse_reply_fuzzer\nFuzz target binary: ares_parse_reply_fuzzer\nJob Type: libfuzzer_msan_c-ares\nPlatform Id: linux\n\nCrash Type: Use-of-uninitialized-value\nCrash Address:\nCrash State:\n  ares__parse_into_addrinfo2\n  ares_parse_aaaa_reply\n  ares-test-fuzz.c\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_c-ares&range=201906180157:201906190155\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5728518081609728\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "b949cc3ddfbeb1b3fba571fb53b186b645e66e9c", "url": "https://github.com/c-ares/c-ares.git/commit/b949cc3ddfbeb1b3fba571fb53b186b645e66e9c"}]}
{"instance_id": "libavc.osv-2023-1205", "repo": "ittiam-systems/libavc", "base_commit": "0d29250b990430ca0d7346459c11ca053380bbb5", "date": "2023-12-19T23:45:31", "project_name": "libavc", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y wget cmake\nRUN git clone https://github.com/ittiam-systems/libavc.git\nRUN git -C libavc checkout 0d29250b990430ca0d7346459c11ca053380bbb5\nADD https://storage.googleapis.com/android_media/external/libavc/fuzzer/avc_dec_fuzzer_seed_corpus.zip $SRC/\nCOPY build.sh $SRC/\nWORKDIR libavc", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n# Run the OSS-Fuzz script in the project.\n$SRC/libavc/fuzzer/ossfuzz.sh\n", "work_dir": "/src/libavc", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64431\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4627953069457408\n\nProject: libavc\nFuzzing Engine: libFuzzer\nFuzz Target: svc_dec_fuzzer\nJob Type: libfuzzer_asan_libavc\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 1\nCrash Address: 0x6250000099d4\nCrash State:\n  isvcd_populate_res_prms\n  isvcd_parse_interlayer_resamp_func_init\n  isvcd_mark_err_slice_skip\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libavc&range=202302080604:202302090622\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4627953069457408\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "28727baf58aa7c8983769aff1ceecb3121a26ee6", "url": "https://github.com/ittiam-systems/libavc.git/commit/28727baf58aa7c8983769aff1ceecb3121a26ee6"}]}
{"instance_id": "libbpf.osv-2021-1562", "repo": "libbpf/libbpf", "base_commit": "881a10980b7ded995da5d9cc1919992c36c9d2be", "date": "2022-10-17T16:13:02", "project_name": "libbpf", "lang": "c++", "dockerfile": "# Copyright 2021 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN sed -i -e '/^#\\s*deb-src.*\\smain\\s\\+restricted/s/^#//' /etc/apt/sources.list && \\\n    apt-get update && \\\n    # libelf build dependencies \\\n    apt-get build-dep -y --no-install-recommends libelf-dev && \\\n    apt-get install -y --no-install-recommends pkg-config && \\\n    # libbpf build dependencies \\\n    apt-get install -y --no-install-recommends libz-dev libz-dev:i386\nRUN git clone https://github.com/libbpf/libbpf\nRUN git -C libbpf checkout 881a10980b7ded995da5d9cc1919992c36c9d2be\nWORKDIR libbpf\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -e\n# Copyright 2021 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n./scripts/build-fuzzers.sh\n", "work_dir": "/src/libbpf", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40868\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6268501392752640\n\nProject: libbpf\nFuzzing Engine: libFuzzer\nFuzz Target: bpf-object-fuzzer\nJob Type: libfuzzer_asan_libbpf\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 4\nCrash Address: 0x6020000000c0\nCrash State:\n  __bpf_object__open\n  bpf_object__open_mem\n  bpf-object-fuzzer.c\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libbpf&range=202110230000:202110230605\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6268501392752640\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "741277511035893c72a34df05da3b943afa747a4", "url": "https://github.com/libbpf/libbpf/commit/741277511035893c72a34df05da3b943afa747a4"}]}
{"instance_id": "harfbuzz.osv-2018-119", "repo": "harfbuzz/harfbuzz", "base_commit": "3e284e02c2a5da758526360a45364a330b8ab8e9", "date": "2018-11-11T22:51:34", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 3e284e02c2a5da758526360a45364a330b8ab8e9\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr\"\n\n# Build the library.\n./autogen.sh\n./configure\nmake clean\nmake -j$(nproc) V=1 all\nmake CPPFLAGS=\"-DHB_NO_VISIBILITY\" -C src V=1 fuzzing\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-fuzzing.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset-fuzzing.a ./src/.libs/libharfbuzz-fuzzing.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shaping/data/in-house/fonts \\\n\ttest/shaping/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11367\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5691469793329152\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x7fef5fd7e540\nCrash State:\n  AAT::KerxSubTableFormat1<AAT::KerxSubTableHeader>::driver_context_t::transition\n  void AAT::StateTableDriver<AAT::ExtendedTypes, AAT::Format1Entry<true>::EntryDat\n  AAT::KerxSubTableFormat1<AAT::KerxSubTableHeader>::apply\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201811100245:201811110244\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5691469793329152\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "a549aa14a0b60436a16f7f8924a5b5f82b4d5b7e", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/a549aa14a0b60436a16f7f8924a5b5f82b4d5b7e"}]}
{"instance_id": "php.osv-2021-1759", "repo": "php/php-src", "base_commit": "8b235380347d6dbdfeabf96bbb5f05f446cd5954", "date": "2021-12-24T05:11:09", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 8b235380347d6dbdfeabf96bbb5f05f446cd5954\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=42894\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6650085318983680\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-tracing-jit\nJob Type: libfuzzer_asan_i386_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0xf47098f4\nCrash State:\n  zend_hash_reverse_apply\n  shutdown_destructors\n  zend_call_destructors\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_i386_php&range=202112220605:202112230602\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6650085318983680\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "eee3b1d917591e5106aef9fd4fe93393e95fc13d", "url": "https://github.com/php/php-src.git/commit/eee3b1d917591e5106aef9fd4fe93393e95fc13d"}]}
{"instance_id": "lz4.osv-2022-571", "repo": "lz4/lz4", "base_commit": "9d20cd519ae62c8864ab237068e4c11490cbd0a9", "date": "2022-07-05T19:31:54", "project_name": "lz4", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\n\nRUN git clone https://github.com/lz4/lz4.git /src/lz4\nRUN git -C /src/lz4 checkout 9d20cd519ae62c8864ab237068e4c11490cbd0a9\n\nWORKDIR $SRC/lz4\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Run the OSS-Fuzz script in the project.\n./ossfuzz/ossfuzz.sh\n", "work_dir": "/src/lz4", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=48993\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5810591549227008\n\nProject: lz4\nFuzzing Engine: libFuzzer\nFuzz Target: round_trip_frame_uncompressed_fuzzer\nJob Type: libfuzzer_msan_lz4\nPlatform Id: linux\n\nCrash Type: Use-of-uninitialized-value\nCrash Address:\nCrash State:\n  LZ4_compress_fast_extState_fastReset\n  LZ4F_compressBlock\n  LZ4F_compressUpdateImpl\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_lz4&range=202206120610:202207080608\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5810591549227008\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "910ec80d2856cfa825e2230ff2de8347a4fa4522", "url": "https://github.com/lz4/lz4.git/commit/910ec80d2856cfa825e2230ff2de8347a4fa4522"}]}
{"instance_id": "libraw.osv-2020-1362", "repo": "libraw/libraw", "base_commit": "371161a06d7f98f231a001dad4af2dfb463e270a", "date": "2021-07-27T07:02:08", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout 371161a06d7f98f231a001dad4af2dfb463e270a\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=24016\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4762894621999104\n\nProject: libraw\nFuzzing Engine: libFuzzer\nFuzz Target: libraw_cr2_fuzzer\nJob Type: libfuzzer_msan_libraw\nPlatform Id: linux\n\nCrash Type: Use-of-uninitialized-value\nCrash Address:\nCrash State:\n  LibRaw::init_fuji_block\n  LibRaw::fuji_decode_strip\n  LibRaw::fuji_decode_loop\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_libraw&range=202006121756:202006130238\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4762894621999104\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  LibRaw lib_raw;\n\n  int result = lib_raw.open_buffer(\n      const_cast<char*>(reinterpret_cast<const char*>(data)), size);\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "363e91ea656f4ce46584b4b0af6285030f236b7e", "url": "https://github.com/libraw/libraw/commit/363e91ea656f4ce46584b4b0af6285030f236b7e"}]}
{"instance_id": "php.osv-2021-651", "repo": "php/php-src", "base_commit": "c8a966a9ae0d9d501395c142305d88e558bae357", "date": "2021-04-19T10:18:03", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout c8a966a9ae0d9d501395c142305d88e558bae357\nRUN git clone https://github.com/kkos/oniguruma.git php-src/oniguruma\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build oniguruma and link statically\npushd oniguruma\nautoreconf -vfi\n./configure\nmake -j$(nproc)\npopd\nexport ONIG_CFLAGS=\"-I$PWD/oniguruma/src\"\nexport ONIG_LIBS=\"-L$PWD/oniguruma/src/.libs -l:libonig.a\"\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# build project\n./buildconf\n./configure \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-mbstring \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-mbstring\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=33335\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5470432774979584\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-execute\nJob Type: libfuzzer_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x604000026c90\nCrash State:\n  zend_gc_delref\n  zval_delref_p\n  zval_ptr_dtor_nogc\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_php&range=202104150634:202104160611\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5470432774979584\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "08dafda1232ffb70d878cb9b334982163aa32357", "url": "https://github.com/php/php-src.git/commit/08dafda1232ffb70d878cb9b334982163aa32357"}]}
{"instance_id": "harfbuzz.osv-2023-1272", "repo": "harfbuzz/harfbuzz", "base_commit": "74e897117196629f2f736b8053386cbf2e454e11", "date": "2023-12-11T15:07:27", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y python3-pip ragel pkg-config && \\\n    pip3 install meson==0.56.0 ninja\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 74e897117196629f2f736b8053386cbf2e454e11\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\n\n# setup\nbuild=$WORK/build\n\n# cleanup\nrm -rf $build\nmkdir -p $build\n\n# Build the library.\nmeson --default-library=static --wrap-mode=nodownload \\\n      -Dexperimental_api=true \\\n      -Dfuzzer_ldflags=\"$(echo $LIB_FUZZING_ENGINE)\" \\\n      $build \\\n  || (cat build/meson-logs/meson-log.txt && false)\n\n# Build the fuzzers.\nninja -v -j$(nproc) -C $build test/fuzzing/hb-{shape,draw,repacker,subset,set}-fuzzer\nmv $build/test/fuzzing/hb-{shape,draw,repacker,subset,set}-fuzzer $OUT/\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shape/data/in-house/fonts \\\n\ttest/shape/data/aots/fonts \\\n\ttest/shape/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\tperf/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\n\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-draw-fuzzer_seed_corpus.zip\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\nzip $OUT/hb-set-fuzzer_seed_corpus.zip ./test/fuzzing/sets/*\nzip $OUT/hb-repacker-fuzzer_seed_corpus.zip ./test/fuzzing/graphs/*\n\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64859\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5393832740782080\n\nProject: harfbuzz\nFuzzing Engine: libFuzzer\nFuzz Target: hb-draw-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 2\nCrash Address: 0x60400000008f\nCrash State:\n  OT::cff2::accelerator_templ_t<CFF::cff2_private_dict_opset_t, CFF::cff2_private_\n  hb_ot_draw_glyph\n  hb_font_draw_glyph\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=202312060619:202312070627\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5393832740782080\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "hb-draw-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-repacker-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-set-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "5b325c0ae9cdd7ca03c002d7cae92a6d17f5111b", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/5b325c0ae9cdd7ca03c002d7cae92a6d17f5111b"}]}
{"instance_id": "php.osv-2021-1780", "repo": "php/php-src", "base_commit": "8147fec3727bffd5480a8261f58b048ca6fa98f0", "date": "2021-12-28T07:29:42", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 8147fec3727bffd5480a8261f58b048ca6fa98f0\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43055\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5513940338081792\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-function-jit\nJob Type: libfuzzer_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x606000011c68\nCrash State:\n  zend_jit_fetch_dim_r_helper\n  zero\n  zend_execute\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_php&range=202112140600:202112150607\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5513940338081792\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "9362d6f5f08bf5f86fc30cf12433e1634f746c4d", "url": "https://github.com/php/php-src.git/commit/9362d6f5f08bf5f86fc30cf12433e1634f746c4d"}]}
{"instance_id": "espeak-ng.osv-2022-530", "repo": "espeak-ng/espeak-ng", "base_commit": "0fa9737a002cc9c99330f32b650e8804241e7436", "date": "2022-07-01T20:07:00", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout 0fa9737a002cc9c99330f32b650e8804241e7436\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=48589\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5636498354995200\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x602000000153\nCrash State:\n  string_decoder_getc_utf_8\n  text_decoder_getc\n  ReadClause\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202105130601:202105140612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5636498354995200\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "482ee1da05189252c3dee49514506e1d2271a2c0", "url": "https://github.com/espeak-ng/espeak-ng/commit/482ee1da05189252c3dee49514506e1d2271a2c0"}]}
{"instance_id": "harfbuzz.osv-2023-377", "repo": "harfbuzz/harfbuzz", "base_commit": "5f5660fc5d80a0ce84066206e8e9bad6e20a24d4", "date": "2023-05-05T17:52:17", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y python3-pip ragel pkg-config && \\\n    pip3 install meson==0.56.0 ninja\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 5f5660fc5d80a0ce84066206e8e9bad6e20a24d4\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\n\n# setup\nbuild=$WORK/build\n\n# cleanup\nrm -rf $build\nmkdir -p $build\n\n# Build the library.\nmeson --default-library=static --wrap-mode=nodownload \\\n      -Dexperimental_api=true \\\n      -Dfuzzer_ldflags=\"$(echo $LIB_FUZZING_ENGINE)\" \\\n      $build \\\n  || (cat build/meson-logs/meson-log.txt && false)\n\n# Build the fuzzers.\nninja -v -j$(nproc) -C $build test/fuzzing/hb-{shape,draw,repacker,subset,set}-fuzzer\nmv $build/test/fuzzing/hb-{shape,draw,repacker,subset,set}-fuzzer $OUT/\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shape/data/in-house/fonts \\\n\ttest/shape/data/aots/fonts \\\n\ttest/shape/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\tperf/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\n\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-draw-fuzzer_seed_corpus.zip\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\nzip $OUT/hb-set-fuzzer_seed_corpus.zip ./test/fuzzing/sets/*\nzip $OUT/hb-repacker-fuzzer_seed_corpus.zip ./test/fuzzing/graphs/*\n\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=58671\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4985737289007104\n\nProject: harfbuzz\nFuzzing Engine: libFuzzer\nFuzz Target: hb-subset-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: UNKNOWN WRITE\nCrash Address: 0x73e0043d3839\nCrash State:\n  bool OT::Layout::Common::CoverageFormat2_4<OT::Layout::MediumTypes>::serialize<h\n  bool OT::Layout::Common::Coverage::serialize<hb_sorted_array_t<unsigned int cons\n  OT::Layout::GSUB_impl::AlternateSubstFormat1_2<OT::Layout::SmallTypes>::subset\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=202305040622:202305050612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4985737289007104\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "hb-draw-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-repacker-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-set-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "cda646a598207642721b753ef5abcebb2525f61b", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/cda646a598207642721b753ef5abcebb2525f61b"}]}
{"instance_id": "libexif.osv-2021-1128", "repo": "libexif/libexif", "base_commit": "d0ebd6eac1f67c9a7b970179c0a88ea2b229c300", "date": "2021-08-14T09:25:13", "project_name": "libexif", "lang": "c++", "dockerfile": "# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool gettext autopoint\nRUN git clone https://github.com/libexif/libexif\nRUN git -C libexif checkout d0ebd6eac1f67c9a7b970179c0a88ea2b229c300\nRUN git clone --depth 1 https://github.com/ianare/exif-samples\nWORKDIR libexif\nCOPY exif_loader_fuzzer.cc exif_from_data_fuzzer.cc build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nautoreconf -fiv\n./configure --disable-docs --enable-shared=no --prefix=\"$WORK\"\nmake -j$(nproc)\nmake install\n\npushd $SRC\nmkdir -p exif_corpus\nfind exif-samples -type f -name '*.jpg' -exec mv -n {} exif_corpus/ \\; -o -name '*.tiff' -exec mv -n {} exif_corpus/ \\;\ncp libexif/test/testdata/*.jpg exif_corpus\nzip -r \"$WORK/exif_seed_corpus.zip\" exif_corpus/\npopd\n\nfor fuzzer in $(find $SRC/ -name '*_fuzzer.cc'); do\n  fuzzer_basename=$(basename -s .cc $fuzzer)\n  $CXX $CXXFLAGS \\\n      -std=c++11 \\\n      -I\"$WORK/include\" \\\n      $fuzzer \\\n      -o $OUT/$fuzzer_basename \\\n      $LIB_FUZZING_ENGINE \\\n      \"$WORK/lib/libexif.a\"\n  cp $WORK/exif_seed_corpus.zip \"${OUT}/${fuzzer_basename}_seed_corpus.zip\"\ndone\n", "work_dir": "/src/libexif", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37211\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4532703432146944\n\nProject: libexif\nFuzzing Engine: libFuzzer\nFuzz Target: exif_loader_fuzzer\nJob Type: libfuzzer_asan_libexif\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 3\nCrash Address: 0x6020000000b2\nCrash State:\n  exif_mnote_data_apple_identify\n  interpret_maker_note\n  exif_data_load_data\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libexif&range=202108140610:202108150609\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4532703432146944\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "exif_from_data_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <libexif/exif-data.h>\n#include <libexif/exif-loader.h>\n#include <stddef.h>\n#include <stdlib.h>\n\n/* Extract all MakerNote tags */\nstatic void mnote_dump(ExifData *data) {\n    ExifMnoteData *mn = exif_data_get_mnote_data(data);\n    if (mn) {\n        int num = exif_mnote_data_count(mn);\n\n        /* Loop through all MakerNote tags */\n        for (int i=0; i < num; ++i) {\n            char buf[1024];\n            exif_mnote_data_get_value(mn, i, buf, sizeof(buf));\n        }\n    }\n}\n\nstatic void dump_value(ExifEntry *entry, void *user_data) {\n  char buf[1024];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nstatic void data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, dump_value, NULL);\n}\n\n/* This is like exif_data_dump but without writing to stdout */\nstatic void data_dump(ExifData *data) {\n  exif_data_foreach_content(data, data_func, NULL);\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n\n  // Parse tags using (ultimately) exif_data_load_data()\n  auto image = exif_data_new_from_data(data, size);\n  if (image) {\n    // Exercise the EXIF tag manipulation code\n    exif_data_get_mnote_data(image);\n    data_dump(image);\n    mnote_dump(image);\n    unsigned char *buf;\n    unsigned int sz;\n    exif_data_save_data(image, &buf, &sz);\n    free(buf);\n    exif_data_fix(image);\n    exif_data_unref(image);\n  }\n\n  return 0;\n}\n"}, {"filename": "exif_loader_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stdio.h>\n#include <stdint.h>\n#include <libexif/exif-loader.h>\n\n\nvoid content_func(ExifEntry *entry, void *user_data) {\n  char buf[10000];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nvoid data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, content_func, NULL);\n}\n\nstatic void\ntest_exif_data (ExifData *d) {\n  unsigned int i, c;\n  char v[1024], *p;\n  ExifMnoteData *md;\n\n  md = exif_data_get_mnote_data (d);\n  if (!md) {\n    return;\n  }\n\n  exif_mnote_data_ref (md);\n  exif_mnote_data_unref (md);\n\n  c = exif_mnote_data_count (md);\n  for (i = 0; i < c; i++) {\n    const char *name = exif_mnote_data_get_name (md, i);\n    if (!name) {\n      break;\n    }\n    exif_mnote_data_get_title (md, i);\n    exif_mnote_data_get_description (md, i);\n    exif_mnote_data_get_value (md, i, v, sizeof (v));\n  }\n}\n\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  ExifLoader *loader = exif_loader_new();\n  ExifData *exif_data;\n  if (!loader) {\n    return 0;\n  }\n  exif_loader_write(loader, const_cast<unsigned char*>(data), size);\n  exif_data = exif_loader_get_data(loader);\n  if(!exif_data) {\n    exif_loader_unref(loader);\n    return 0;\n  }\n  exif_data_foreach_content(exif_data, data_func, NULL);\n  test_exif_data (exif_data);\n  exif_loader_unref(loader);\n  exif_data_unref(exif_data);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "22799320cc1187868d9a572661d12f0c3f9939b5", "url": "https://github.com/libexif/libexif/commit/22799320cc1187868d9a572661d12f0c3f9939b5"}]}
{"instance_id": "lwan.osv-2022-320", "repo": "lpereira/lwan", "base_commit": "4272b886241688021ddc5f938d21e4830b447bed", "date": "2022-04-10T00:29:57", "project_name": "lwan", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update\nRUN apt-get install -y build-essential cmake git ninja-build zlib1g-dev\n\nRUN git clone https://github.com/lpereira/lwan.git\nRUN git -C lwan checkout 4272b886241688021ddc5f938d21e4830b447bed\nWORKDIR lwan\n\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -euv\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\nmkdir -p $WORK/lwan\ncd $WORK/lwan\n\ncmake -GNinja \\\n\t-DCMAKE_BUILD_TYPE=Debug \\\n\t-DCMAKE_C_COMPILER=\"${CC}\" \\\n\t-DCMAKE_C_FLAGS=\"${CFLAGS}\" \\\n\t$SRC/lwan/\n\nninja -v liblwan.a\n\ncp $SRC/lwan/fuzz/*.dict $OUT/\n\nfor fuzzer in $SRC/lwan/src/bin/fuzz/*_fuzzer.cc; do\n\texecutable=$(basename $fuzzer .cc)\n\tcorpus_base=$(basename $fuzzer _fuzzer.cc)\n\n\tzip -jr $OUT/${executable}_seed_corpus.zip $SRC/lwan/fuzz/corpus/corpus-${corpus_base}-*\n\t\n\t$CXX $CXXFLAGS -std=c++11 \\\n\t\t-Wl,-whole-archive $WORK/lwan/src/lib/liblwan.a -Wl,-no-whole-archive \\\n\t\t-I$SRC/lwan/src/lib $fuzzer \\\n\t\t$LIB_FUZZING_ENGINE -lpthread -lz \\\n\t\t-o $OUT/$executable\ndone\n", "work_dir": "/src/lwan", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=46506\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4703583657918464\n\nProject: lwan\nFuzzing Engine: libFuzzer\nFuzz Target: h2_huffman_fuzzer\nJob Type: libfuzzer_asan_lwan\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 8\nCrash Address: 0x6020000000ba\nCrash State:\n  lwan_h2_huffman_decode_for_fuzzing\n  h2_huffman_fuzzer.cc\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_lwan&range=202204020612:202204060603\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4703583657918464\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "44283f701359c7b0bcf5e0b5466591c7442d081a", "url": "https://github.com/lpereira/lwan.git/commit/44283f701359c7b0bcf5e0b5466591c7442d081a"}]}
{"instance_id": "serenity.osv-2021-446", "repo": "serenityos/serenity", "base_commit": "9bc3c3c9628926de22fe19f12672472fc9dfe661", "date": "2021-02-24T16:01:37", "project_name": "serenity", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y build-essential cmake curl e2fsprogs libmpfr-dev libmpc-dev libgmp-dev ninja-build\nRUN git clone https://github.com/SerenityOS/serenity\nRUN git -C serenity checkout 9bc3c3c9628926de22fe19f12672472fc9dfe661\nCOPY build.sh $SRC/\nWORKDIR $SRC/serenity/Meta/Lagom", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Now build the content\nmkdir -p build\ncd build\ncmake -GNinja \\\n    -DBUILD_LAGOM=ON \\\n    -DENABLE_OSS_FUZZ=ON \\\n    -DCMAKE_C_COMPILER=$CC \\\n    -DCMAKE_CXX_COMPILER=$CXX \\\n    -DCMAKE_CXX_FLAGS=\"$CXXFLAGS -DOSS_FUZZ=ON\" \\\n    -DLINKER_FLAGS=\"$LIB_FUZZING_ENGINE\" \\\n    ..\nninja\ncp Fuzzers/Fuzz* $OUT/\n\n", "work_dir": "/src/serenity/Meta/Lagom", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=31351\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5630927108702208\n\nProject: serenity\nFuzzing Engine: libFuzzer\nFuzz Target: FuzzMarkdown\nJob Type: libfuzzer_asan_serenity\nPlatform Id: linux\n\nCrash Type: Global-buffer-overflow READ 1\nCrash Address: 0x0000009c9b84\nCrash State:\n  AK::StringView::operator==\n  Markdown::CodeBlock::parse\n  bool Markdown::helper<Markdown::CodeBlock>\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_serenity&range=202102230604:202102240611\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5630927108702208\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [], "candidate_fixes": [{"sha": "42133a196a0bea83705b5947921d5c7e5b9f201d", "url": "https://github.com/SerenityOS/serenity/commit/42133a196a0bea83705b5947921d5c7e5b9f201d"}]}
{"instance_id": "php.osv-2021-1217", "repo": "php/php-src", "base_commit": "b514e550a243586f8d778a89aaaa68f8f9c11535", "date": "2021-09-09T09:09:13", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout b514e550a243586f8d778a89aaaa68f8f9c11535\nRUN git clone https://github.com/kkos/oniguruma.git php-src/oniguruma\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build oniguruma and link statically\npushd oniguruma\nautoreconf -vfi\n./configure\nmake -j$(nproc)\npopd\nexport ONIG_CFLAGS=\"-I$PWD/oniguruma/src\"\nexport ONIG_LIBS=\"-L$PWD/oniguruma/src/.libs -l:libonig.a\"\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-mbstring \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-mbstring\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=38297\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5446821967691776\n\nProject: php\nFuzzing Engine: honggfuzz\nFuzz Target: php-fuzz-execute\nJob Type: honggfuzz_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 8\nCrash Address: 0x606000011078\nCrash State:\n  ZEND_FETCH_OBJ_R_SPEC_CV_CONST_INLINE_HANDLER\n  ZEND_FETCH_OBJ_R_SPEC_CV_CONST_HANDLER\n  fuzzer_execute_ex\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_php&range=202103150621:202103160620\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5446821967691776\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "6381a16f3f1d0ce5d260f90661a7026b8f05d074", "url": "https://github.com/php/php-src.git/commit/6381a16f3f1d0ce5d260f90661a7026b8f05d074"}]}
{"instance_id": "cyclonedds.osv-2023-273", "repo": "eclipse-cyclonedds/cyclonedds", "base_commit": "090b62ee46e8af9c539b2881aa36787e1de08079", "date": "2023-05-31T00:43:51", "project_name": "cyclonedds", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y \\\n    autoconf \\\n    automake \\\n    libssl-dev \\\n    libcunit1 \\\n    libcunit1-dev \\\n    bison \\\n    libbison-dev\n\nRUN git clone https://github.com/eclipse-cyclonedds/cyclonedds\nRUN git -C cyclonedds checkout 090b62ee46e8af9c539b2881aa36787e1de08079\n\nCOPY build.sh $SRC\nWORKDIR $SRC/cyclonedds\n# This is to fix Fuzz Introspector build by using LLVM old pass manager\n# re https://github.com/ossf/fuzz-introspector/issues/305\nENV OLD_LLVMPASS 1", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nsource fuzz/oss-fuzz-build.sh", "work_dir": "/src/cyclonedds", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=57614\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6189139925270528\n\nProject: cyclonedds\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz_type_object\nJob Type: libfuzzer_asan_cyclonedds\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 8\nCrash Address: 0x61d000003bc8\nCrash State:\n  add_complete_typeobj\n  ddsi_xt_type_add_typeobj\n  ddsi_type_add_typeobj\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_cyclonedds&range=202303140613:202303150608\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6189139925270528\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "708b9211ca8aeb3312b358df81d259c3d3c9fc70", "url": "https://github.com/eclipse-cyclonedds/cyclonedds/commit/708b9211ca8aeb3312b358df81d259c3d3c9fc70"}]}
{"instance_id": "libexif.osv-2021-1169", "repo": "libexif/libexif", "base_commit": "a4647a5463102c4b0c5a02461edd4cc085dfc1b6", "date": "2021-08-25T07:14:37", "project_name": "libexif", "lang": "c++", "dockerfile": "# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool gettext autopoint\nRUN git clone https://github.com/libexif/libexif\nRUN git -C libexif checkout a4647a5463102c4b0c5a02461edd4cc085dfc1b6\nRUN git clone --depth 1 https://github.com/ianare/exif-samples\nWORKDIR libexif\nCOPY exif_loader_fuzzer.cc exif_from_data_fuzzer.cc build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nautoreconf -fiv\n./configure --disable-docs --enable-shared=no --prefix=\"$WORK\"\nmake -j$(nproc)\nmake install\n\npushd $SRC\nmkdir -p exif_corpus\nfind exif-samples -type f -name '*.jpg' -exec mv -n {} exif_corpus/ \\; -o -name '*.tiff' -exec mv -n {} exif_corpus/ \\;\ncp libexif/test/testdata/*.jpg exif_corpus\nzip -r \"$WORK/exif_seed_corpus.zip\" exif_corpus/\npopd\n\nfor fuzzer in $(find $SRC/ -name '*_fuzzer.cc'); do\n  fuzzer_basename=$(basename -s .cc $fuzzer)\n  $CXX $CXXFLAGS \\\n      -std=c++11 \\\n      -I\"$WORK/include\" \\\n      $fuzzer \\\n      -o $OUT/$fuzzer_basename \\\n      $LIB_FUZZING_ENGINE \\\n      \"$WORK/lib/libexif.a\"\n  cp $WORK/exif_seed_corpus.zip \"${OUT}/${fuzzer_basename}_seed_corpus.zip\"\ndone\n", "work_dir": "/src/libexif", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37575\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4577720328126464\n\nProject: libexif\nFuzzing Engine: libFuzzer\nFuzz Target: exif_from_data_fuzzer\nJob Type: libfuzzer_asan_libexif\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x61110000009c\nCrash State:\n  exif_mnote_data_apple_load\n  exif_mnote_data_load\n  interpret_maker_note\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libexif&range=202108150609:202108160616\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4577720328126464\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "exif_from_data_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <libexif/exif-data.h>\n#include <libexif/exif-loader.h>\n#include <stddef.h>\n#include <stdlib.h>\n\n/* Extract all MakerNote tags */\nstatic void mnote_dump(ExifData *data) {\n    ExifMnoteData *mn = exif_data_get_mnote_data(data);\n    if (mn) {\n        int num = exif_mnote_data_count(mn);\n\n        /* Loop through all MakerNote tags */\n        for (int i=0; i < num; ++i) {\n            char buf[1024];\n            exif_mnote_data_get_value(mn, i, buf, sizeof(buf));\n        }\n    }\n}\n\nstatic void dump_value(ExifEntry *entry, void *user_data) {\n  char buf[1024];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nstatic void data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, dump_value, NULL);\n}\n\n/* This is like exif_data_dump but without writing to stdout */\nstatic void data_dump(ExifData *data) {\n  exif_data_foreach_content(data, data_func, NULL);\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n\n  // Parse tags using (ultimately) exif_data_load_data()\n  auto image = exif_data_new_from_data(data, size);\n  if (image) {\n    // Exercise the EXIF tag manipulation code\n    exif_data_get_mnote_data(image);\n    data_dump(image);\n    mnote_dump(image);\n    unsigned char *buf;\n    unsigned int sz;\n    exif_data_save_data(image, &buf, &sz);\n    free(buf);\n    exif_data_fix(image);\n    exif_data_unref(image);\n  }\n\n  return 0;\n}\n"}, {"filename": "exif_loader_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stdio.h>\n#include <stdint.h>\n#include <libexif/exif-loader.h>\n\n\nvoid content_func(ExifEntry *entry, void *user_data) {\n  char buf[10000];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nvoid data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, content_func, NULL);\n}\n\nstatic void\ntest_exif_data (ExifData *d) {\n  unsigned int i, c;\n  char v[1024], *p;\n  ExifMnoteData *md;\n\n  md = exif_data_get_mnote_data (d);\n  if (!md) {\n    return;\n  }\n\n  exif_mnote_data_ref (md);\n  exif_mnote_data_unref (md);\n\n  c = exif_mnote_data_count (md);\n  for (i = 0; i < c; i++) {\n    const char *name = exif_mnote_data_get_name (md, i);\n    if (!name) {\n      break;\n    }\n    exif_mnote_data_get_title (md, i);\n    exif_mnote_data_get_description (md, i);\n    exif_mnote_data_get_value (md, i, v, sizeof (v));\n  }\n}\n\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  ExifLoader *loader = exif_loader_new();\n  ExifData *exif_data;\n  if (!loader) {\n    return 0;\n  }\n  exif_loader_write(loader, const_cast<unsigned char*>(data), size);\n  exif_data = exif_loader_get_data(loader);\n  if(!exif_data) {\n    exif_loader_unref(loader);\n    return 0;\n  }\n  exif_data_foreach_content(exif_data, data_func, NULL);\n  test_exif_data (exif_data);\n  exif_loader_unref(loader);\n  exif_data_unref(exif_data);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "b1e292af7d6ff811755026ec551e37e73ae07469", "url": "https://github.com/libexif/libexif/commit/b1e292af7d6ff811755026ec551e37e73ae07469"}]}
{"instance_id": "pcre2.osv-2023-674", "repo": "pcre2project/pcre2", "base_commit": "5f77d022733a5b7e2ff1e3d80b547c0d89811efe", "date": "2023-08-08T10:15:24", "project_name": "pcre2", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool subversion\n\nRUN git clone https://github.com/PCRE2Project/pcre2 pcre2\nRUN git -C pcre2 checkout 5f77d022733a5b7e2ff1e3d80b547c0d89811efe\nWORKDIR pcre2\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build project\n./autogen.sh\n./configure --enable-fuzz-support --enable-never-backslash-C --with-match-limit=1000 --with-match-limit-depth=1000\nmake -j$(nproc) clean\nmake -j$(nproc) all\n\n# build fuzzer\n$CXX $CXXFLAGS -o $OUT/pcre2_fuzzer \\\n    $LIB_FUZZING_ENGINE .libs/libpcre2-fuzzsupport.a .libs/libpcre2-8.a\n\n# set up dictionary and options to use it\ncp pcre2_fuzzer.options pcre2_fuzzer.dict $OUT/\n", "work_dir": "/src/pcre2", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=61269\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5777252993073152\n\nProject: pcre2\nFuzzing Engine: libFuzzer\nFuzz Target: pcre2_fuzzer\nJob Type: libfuzzer_asan_pcre2\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 4\nCrash Address: 0x619000000484\nCrash State:\n  get_grouplength\n  get_branchlength\n  get_grouplength\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_pcre2&range=202308060619:202308070612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5777252993073152\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "fb1c7d27db09a4d0a2b6e1486c4f1a4d332e8b8c", "url": "https://github.com/PCRE2Project/pcre2/commit/fb1c7d27db09a4d0a2b6e1486c4f1a4d332e8b8c"}]}
{"instance_id": "cyclonedds.osv-2023-556", "repo": "eclipse-cyclonedds/cyclonedds", "base_commit": "5ca03776896510f22d6316bb0f237c786ad280b0", "date": "2023-07-07T00:56:18", "project_name": "cyclonedds", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y \\\n    autoconf \\\n    automake \\\n    libssl-dev \\\n    libcunit1 \\\n    libcunit1-dev \\\n    bison \\\n    libbison-dev\n\nRUN git clone https://github.com/eclipse-cyclonedds/cyclonedds\nRUN git -C cyclonedds checkout 5ca03776896510f22d6316bb0f237c786ad280b0\n\nCOPY build.sh $SRC\nWORKDIR $SRC/cyclonedds\n# This is to fix Fuzz Introspector build by using LLVM old pass manager\n# re https://github.com/ossf/fuzz-introspector/issues/305\nENV OLD_LLVMPASS 1", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nsource fuzz/oss-fuzz-build.sh", "work_dir": "/src/cyclonedds", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=60514\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4530077902438400\n\nProject: cyclonedds\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz_type_object\nJob Type: libfuzzer_asan_cyclonedds\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x602000000930\nCrash State:\n  xt_valid_enum_values\n  xt_validate_impl\n  ddsi_xt_type_add_typeobj\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_cyclonedds&range=202302280604:202303010613\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4530077902438400\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "748f19f0c5da7ecec73d350772c784e46c7d9d64", "url": "https://github.com/eclipse-cyclonedds/cyclonedds/commit/748f19f0c5da7ecec73d350772c784e46c7d9d64"}]}
{"instance_id": "harfbuzz.osv-2018-149", "repo": "harfbuzz/harfbuzz", "base_commit": "00fdbca4f6a5c4623b9c4838da502cccce8aaa74", "date": "2018-10-20T15:20:57", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 00fdbca4f6a5c4623b9c4838da502cccce8aaa74\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=function,vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=function,vptr\"\n\n# Build the library.\n./autogen.sh\n./configure\nmake clean\nmake -j$(nproc) V=1 all\nmake CPPFLAGS=\"-DHB_NO_VISIBILITY\" -C src V=1 fuzzing\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-fuzzing.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset-fuzzing.a ./src/.libs/libharfbuzz-fuzzing.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nzip -j -r $OUT/hb-shape-fuzzer_seed_corpus.zip $SRC/harfbuzz/test/shaping/data/in-house/fonts $SRC/harfbuzz/test/shaping/data/text-rendering-tests/fonts $SRC/harfbuzz/test/api/fonts $SRC/harfbuzz/test/fuzzing/fonts\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11033\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5718464350650368\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x60b000000209\nCrash State:\n  BEInt<unsigned int, 4>::operator unsigned int\n  AAT::KerxSubTableFormat2::sanitize\n  hb_sanitize_context_t::return_t AAT::KerxTable::dispatch<hb_sanitize_context_t>\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201810130142:201810140143\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5718464350650368\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "68b705076808d4b0a4ac3bfa945b8f9ae23db1df", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/68b705076808d4b0a4ac3bfa945b8f9ae23db1df"}]}
{"instance_id": "espeak-ng.osv-2021-764", "repo": "espeak-ng/espeak-ng", "base_commit": "cd33c4042a022a3e1dea32da4c5541d6ca568cf0", "date": "2022-03-14T23:08:51", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout cd33c4042a022a3e1dea32da4c5541d6ca568cf0\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=34285\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4849410845573120\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Stack-buffer-overflow READ 1\nCrash Address: 0x7fe03240a1cf\nCrash State:\n  TranslateNumber_1\n  TranslateNumber\n  TranslateWord3\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202105130601:202105140612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4849410845573120\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "7b9c99cec7b0c517049d39cbbee610c3a8407fa4", "url": "https://github.com/espeak-ng/espeak-ng/commit/7b9c99cec7b0c517049d39cbbee610c3a8407fa4"}]}
{"instance_id": "exiv2.osv-2022-794", "repo": "exiv2/exiv2", "base_commit": "7a92e1bd0f8a1435eed7743e3aeadcb73f63182d", "date": "2022-08-29T02:15:55", "project_name": "exiv2", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\nFROM hwiwonlee/secb.base:latest\n\nRUN apt-get update && apt-get install -y cmake make ccache python3 libexpat1-dev zlib1g-dev libssh-dev libcurl4-openssl-dev libxml2-utils\nRUN git clone https://github.com/Exiv2/exiv2 exiv2\nRUN git -C exiv2 checkout 7a92e1bd0f8a1435eed7743e3aeadcb73f63182d\nWORKDIR exiv2\n\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Added to fix a false positive result: https://github.com/google/oss-fuzz/issues/6489\nCXXFLAGS=\"${CXXFLAGS} -fno-sanitize=float-divide-by-zero\"\n\n# Build Exiv2\nmkdir -p build\ncd build\ncmake -DEXIV2_ENABLE_PNG=ON -DEXIV2_ENABLE_WEBREADY=ON -DEXIV2_ENABLE_CURL=OFF -DEXIV2_ENABLE_BMFF=ON -DEXIV2_TEAM_WARNINGS_AS_ERRORS=ON -DBUILD_SHARED_LIBS=OFF -DCMAKE_CXX_COMPILER=\"${CXX}\" -DCMAKE_CXX_FLAGS=\"${CXXFLAGS}\" -DEXIV2_BUILD_FUZZ_TESTS=ON -DEXIV2_TEAM_OSS_FUZZ=ON -DLIB_FUZZING_ENGINE=\"${LIB_FUZZING_ENGINE}\" ..\nmake -j $(nproc)\n\n# Copy binary and dictionary to $OUT\ncp ./bin/fuzz-read-print-write $OUT\ncp ../fuzz/exiv2.dict $OUT/fuzz-read-print-write.dict\n\n# Initialize the corpus, using the files in test/data\nmkdir corpus\nfor f in $(find ../test/data -type f -size -20k); do\n    s=$(sha1sum \"$f\" | awk '{print $1}')\n    cp $f corpus/$s\ndone\n\nzip -j $OUT/fuzz-read-print-write.zip corpus/*\n", "work_dir": "/src/exiv2", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=50629\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6752421547737088\n\nProject: exiv2\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz-read-print-write\nJob Type: libfuzzer_asan_exiv2\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 5\nCrash Address: 0x6020000002b4\nCrash State:\n  std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<ch\n  Exiv2::QuickTimeVideo::previewTagDecoder\n  Exiv2::QuickTimeVideo::tagDecoder\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_exiv2&range=202208240610:202208250610\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6752421547737088\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "337fe1854ff17f169032e993789a24bbb53579c4", "url": "https://github.com/Exiv2/exiv2/commit/337fe1854ff17f169032e993789a24bbb53579c4"}]}
{"instance_id": "zstd.osv-2022-110", "repo": "facebook/zstd", "base_commit": "26c36fafb97e5eb45d73bc7489f2efb144b801a8", "date": "2022-02-01T13:10:32", "project_name": "zstd", "lang": "c++", "dockerfile": "# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make python wget\n# Clone source\nRUN git clone https://github.com/facebook/zstd\nRUN git -C zstd checkout 26c36fafb97e5eb45d73bc7489f2efb144b801a8\nWORKDIR zstd\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\ncd tests/fuzz\n\n# Download the seed corpora\nmake -j seedcorpora\n# Build all of the fuzzers\n./fuzz.py build all\n\nfor target in $(./fuzz.py list); do\n    cp \"$target\" \"$OUT\"\n\n    if [ -f \"$target.dict\" ]; then\n        cp \"$target.dict\" \"$OUT\"\n    fi\n\n    cp \"corpora/${target}_seed_corpus.zip\" \"$OUT\"\ndone\n", "work_dir": "/src/zstd", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=44239\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6749389635321856\n\nProject: zstd\nFuzzing Engine: libFuzzer\nFuzz Target: sequence_compression_api\nJob Type: libfuzzer_asan_zstd\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 1\nCrash Address: 0x62c0000071b3\nCrash State:\n  ZSTD_compressLiterals\n  ZSTD_entropyCompressSeqStore\n  ZSTD_compressSequences\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_zstd&range=202201260602:202201270601\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6749389635321856\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "cad9f8d5f9c451b1cc8ce00a16c125e3d2ffc418", "url": "https://github.com/facebook/zstd/commit/cad9f8d5f9c451b1cc8ce00a16c125e3d2ffc418"}]}
{"instance_id": "php.osv-2023-1243", "repo": "php/php-src", "base_commit": "9a69bb2d582ed127fb2a82273e9f9b9d6d6e4612", "date": "2023-12-01T03:09:17", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# The current clang revision is broken, pin to older one.\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 9a69bb2d582ed127fb2a82273e9f9b9d6d6e4612\nWORKDIR php-src\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64579\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6034106571685888\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-function-jit\nJob Type: libfuzzer_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x60800000cf40\nCrash State:\n  zend_reference_destroy\n  rc_dtor_func\n  zend_leave_helper_SPEC\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_php&range=202311280625:202311290620\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6034106571685888\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [], "candidate_fixes": [{"sha": "1e55c9760178f9d5e1de8b251537b3e8ccf44feb", "url": "https://github.com/php/php-src.git/commit/1e55c9760178f9d5e1de8b251537b3e8ccf44feb"}]}
{"instance_id": "wasm3.osv-2021-660", "repo": "wasm3/wasm3", "base_commit": "715a8d04df0a4b07de08213999037f3a028f2ab2", "date": "2021-04-17T17:10:36", "project_name": "wasm3", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\nRUN git clone https://github.com/wasm3/wasm3\nRUN git -C wasm3 checkout 715a8d04df0a4b07de08213999037f3a028f2ab2\nWORKDIR wasm3\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\nmkdir build && cd build\ncmake -DBUILD_WASI=none ..\nmake -j$(nproc)\n$CC $CFLAGS -c $SRC/wasm3/platforms/app_fuzz/fuzzer.c -o fuzzer.o -I/src/wasm3/source\n$CXX $CXXFLAGS $LIB_FUZZING_ENGINE -o $OUT/fuzzer fuzzer.o /src/wasm3/build/source/libm3.a\n", "work_dir": "/src/wasm3", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=33397\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4990068868644864\n\nProject: wasm3\nFuzzing Engine: honggfuzz\nFuzz Target: fuzzer\nJob Type: honggfuzz_asan_wasm3\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x60d0000401dc\nCrash State:\n  op_BranchIfPrologue_s\n  m3_CallVL\n  m3_CallV\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_wasm3&range=202104150622:202104160620\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4990068868644864\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "12a5277ec0977af493530b704a5a16e28f734788", "url": "https://github.com/wasm3/wasm3/commit/12a5277ec0977af493530b704a5a16e28f734788"}]}
{"instance_id": "libraw.osv-2023-184", "repo": "libraw/libraw", "base_commit": "f6a57cfb81561bb9a3bd884795896a61f65ba29e", "date": "2023-02-21T11:54:02", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config zlib1g-dev\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout f6a57cfb81561bb9a3bd884795896a61f65ba29e\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=57105\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4516421182029824\n\nProject: libraw\nFuzzing Engine: honggfuzz\nFuzz Target: libraw_nef_fuzzer\nJob Type: honggfuzz_asan_libraw\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x7f1343c777fd\nCrash State:\n  LibRaw::sget4\n  LibRaw::parseAdobeRAFMakernote\n  LibRaw::parse_tiff_ifd\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_libraw&range=202101290609:202101300625\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4516421182029824\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n#include <fuzzer/FuzzedDataProvider.h>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\nstatic const InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  FuzzedDataProvider fdp(data, size);\n  LibRaw lib_raw;\n\n  for(int i =0; i < 4; i++)\n    lib_raw.output_params_ptr()->aber[i] = fdp.ConsumeFloatingPoint<double>();\n  for(int i =0; i < 4; i++)\n    lib_raw.output_params_ptr()->user_mul[i] = fdp.ConsumeFloatingPoint<float>();\n  for(int i =0; i < 2; i++)\n    lib_raw.output_params_ptr()->gamm[i] = fdp.ConsumeFloatingPoint<double>();\n  lib_raw.output_params_ptr()->bright = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->threshold = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->use_auto_wb = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->output_color = fdp.ConsumeIntegralInRange<int>(0, 6);\n  lib_raw.output_params_ptr()->user_flip = fdp.ConsumeIntegralInRange<int>(0, 7);\n  lib_raw.output_params_ptr()->user_black = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->user_sat = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->auto_bright_thr = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->adjust_maximum_thr = fdp.ConsumeFloatingPointInRange<float>(0.f, 1.f);\n  lib_raw.output_params_ptr()->fbdd_noiserd = fdp.ConsumeIntegralInRange<int>(0, 5);\n\n  std::vector<char> payload = fdp.ConsumeRemainingBytes<char>();\n  int result = lib_raw.open_buffer(payload.data(), payload.size());\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack_thumb();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.raw2image();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n  lib_raw.free_image();\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "e942a7db6b9abdcbaedc8a21400ffc5edacbd9c3", "url": "https://github.com/libraw/libraw/commit/e942a7db6b9abdcbaedc8a21400ffc5edacbd9c3"}]}
{"instance_id": "selinux.osv-2021-1733", "repo": "selinuxproject/selinux", "base_commit": "b2ba721ebba087123f5a527361e9796b6880ab85", "date": "2022-01-05T13:22:45", "project_name": "selinux", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends bison \\\n\tflex \\\n\tgawk \\\n\tgettext \\\n\tmake \\\n\tlibaudit-dev \\\n\tlibbz2-dev \\\n\tlibcap-dev \\\n\tlibcap-ng-dev \\\n\tlibglib2.0-dev \\\n\tlibpcre3-dev\nRUN git clone https://github.com/SELinuxProject/selinux\nRUN git -C selinux checkout b2ba721ebba087123f5a527361e9796b6880ab85\nWORKDIR selinux\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -e\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n./scripts/oss-fuzz.sh\n", "work_dir": "/src/selinux", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=42729\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4758829554860032\n\nProject: selinux\nFuzzing Engine: libFuzzer\nFuzz Target: binpolicy-fuzzer\nJob Type: libfuzzer_asan_selinux\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x0000003ffff8\nCrash State:\n  mls_semantic_level_expand\n  policydb_user_cache\n  hashtab_map\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_selinux&range=202112171200:202112171800\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4758829554860032\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "b78560fd372e01c11ca4f183f929d99b1f89f314", "url": "https://github.com/SELinuxProject/selinux/commit/b78560fd372e01c11ca4f183f929d99b1f89f314"}]}
{"instance_id": "icu.osv-2024-10", "repo": "unicode-org/icu", "base_commit": "906093f31b44316ba7da24972f95a0510355e61d", "date": "2024-01-10T03:30:32", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout 906093f31b44316ba7da24972f95a0510355e61d\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# need \"-p\" as otherwise centipede fails\nmkdir -p $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n# Pick up additional flags (-std=...) added by runConfigureICU.\nCXXFLAGS=\"$CXXFLAGS $(config/icu-config --noverify --cxxflags)\"\n\n$CXX $CXXFLAGS -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu/icu4c/source/common \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=65632\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6262084203511808\n\nProject: icu\nFuzzing Engine: libFuzzer\nFuzz Target: collator_compare_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 2\nCrash Address: 0x6020000000d4\nCrash State:\n  __string\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=202401050623:202401060621\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6262084203511808\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "23d1fc5989c87d5a0572eed54f7c1000f1e3e71b", "url": "https://github.com/unicode-org/icu.git/commit/23d1fc5989c87d5a0572eed54f7c1000f1e3e71b"}]}
{"instance_id": "openjpeg.osv-2017-5", "repo": "uclouvain/openjpeg", "base_commit": "8f92fc97913bec7ffa2dc10d062c0cdd19da20e4", "date": "2017-08-28T08:57:49", "project_name": "openjpeg", "lang": "c++", "dockerfile": "# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER antonin@gmail.com\nRUN apt-get update && apt-get install -y make cmake g++\nRUN git clone https://github.com/uclouvain/openjpeg openjpeg\nRUN git -C openjpeg checkout 8f92fc97913bec7ffa2dc10d062c0cdd19da20e4\n# openjpeg-data is used to create a seed corpus\nRUN git clone --depth 1 https://github.com/uclouvain/openjpeg-data openjpeg/data\nWORKDIR openjpeg\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir build\ncd build\ncmake ..\nmake clean -s\nmake -j$(nproc) -s\ncd ..\n\n./tests/fuzzers/build_google_oss_fuzzers.sh\n./tests/fuzzers/build_seed_corpus.sh\n", "work_dir": "/src/openjpeg", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3115\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=4717233764827136\n\nProject: openjpeg\nFuzzer: libFuzzer_openjpeg_opj_decompress_fuzzer\nFuzz target binary: opj_decompress_fuzzer\nJob Type: libfuzzer_asan_openjpeg\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x60d000001200\nCrash State:\n  opj_dwt_interleave_partial_v\n  opj_dwt_decode_partial_tile\n  opj_tcd_dwt_decode\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_openjpeg&range=201708210414:201708220124\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4717233764827136\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you have questions for the OSS-Fuzz team, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [], "candidate_fixes": [{"sha": "a55c024fc6b917a409b85aeafd7326421c4aea34", "url": "https://github.com/uclouvain/openjpeg/commit/a55c024fc6b917a409b85aeafd7326421c4aea34"}]}
{"instance_id": "mruby.osv-2023-366", "repo": "mruby/mruby", "base_commit": "0bb08718b8cab3d6c63d5762ab2dca5417ddf17c", "date": "2023-06-05T10:31:36", "project_name": "mruby", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y build-essential ruby bison ninja-build \\\n    cmake zlib1g-dev libbz2-dev liblzma-dev\nRUN git clone https://github.com/mruby/mruby mruby\nRUN git -C mruby checkout 0bb08718b8cab3d6c63d5762ab2dca5417ddf17c\nRUN git clone --depth 1 https://github.com/bshastry/mruby_seeds.git mruby_seeds\nRUN git clone --depth 1 https://github.com/google/libprotobuf-mutator.git\nRUN mkdir LPM; \\\n  cd LPM; \\\n  cmake $SRC/libprotobuf-mutator -GNinja -DLIB_PROTO_MUTATOR_DOWNLOAD_PROTOBUF=ON -DLIB_PROTO_MUTATOR_TESTING=OFF -DCMAKE_BUILD_TYPE=Release; \\\n  ninja;\n\nCOPY build.sh $SRC", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Instrument mruby\n(\ncd $SRC/mruby\nexport LD=$CC\nexport LDFLAGS=\"$CFLAGS\"\nrake -m\n\n# build fuzzers\nFUZZ_TARGET=$SRC/mruby/oss-fuzz/mruby_fuzzer.c\nname=$(basename $FUZZ_TARGET .c)\n$CC -c $CFLAGS -Iinclude \\\n     ${FUZZ_TARGET} -o $OUT/${name}.o\n$CXX $CXXFLAGS $OUT/${name}.o $LIB_FUZZING_ENGINE -lm \\\n    $SRC/mruby/build/host/lib/libmruby.a -o $OUT/${name}\nrm -f $OUT/${name}.o\n)\n\n# Construct options files\ncat > $SRC/mruby/oss-fuzz/config/mruby_fuzzer.options <<EOF\n[libfuzzer]\ndict = mruby.dict\nonly_ascii = 1\nEOF\ncp $SRC/mruby/oss-fuzz/config/mruby_fuzzer.options $SRC/mruby/oss-fuzz/config/mruby_proto_fuzzer.options\n\n# Build proto fuzzer: ASan and UBSan\nif [[ $CFLAGS != *sanitize=memory* ]]; then\n    PROTO_FUZZ_TARGET=$SRC/mruby/oss-fuzz/mruby_proto_fuzzer.cpp\n    PROTO_CONVERTER=$SRC/mruby/oss-fuzz/proto_to_ruby.cpp\n    rm -rf $SRC/mruby/genfiles\n    mkdir $SRC/mruby/genfiles\n    $SRC/LPM/external.protobuf/bin/protoc --proto_path=$SRC/mruby/oss-fuzz ruby.proto --cpp_out=$SRC/mruby/genfiles\n    $CXX -c $CXXFLAGS $SRC/mruby/genfiles/ruby.pb.cc -DNDEBUG -o $SRC/mruby/genfiles/ruby.pb.o -I $SRC/LPM/external.protobuf/include\n    $CXX -I $SRC/mruby/include -I $SRC/LPM/external.protobuf/include $CXXFLAGS $PROTO_FUZZ_TARGET $SRC/mruby/genfiles/ruby.pb.o $PROTO_CONVERTER \\\n      -I $SRC/mruby/genfiles \\\n      -I $SRC/libprotobuf-mutator \\\n      -I $SRC/mruby/include -lz -lm \\\n      $SRC/LPM/src/libfuzzer/libprotobuf-mutator-libfuzzer.a \\\n      $SRC/LPM/src/libprotobuf-mutator.a \\\n      -Wl,--start-group $SRC/LPM/external.protobuf/lib/lib*.a -Wl,--end-group \\\n      $SRC/mruby/build/host/lib/libmruby.a \\\n      $LIB_FUZZING_ENGINE \\\n      -o $OUT/mruby_proto_fuzzer\n\n    # Copy config\n    cp $SRC/mruby/oss-fuzz/config/mruby_proto_fuzzer.options $OUT\nfi\n\n# dict and config\ncp $SRC/mruby/oss-fuzz/config/mruby.dict $OUT\ncp $SRC/mruby/oss-fuzz/config/mruby_fuzzer.options $OUT\n\n# seeds\nzip -rq $OUT/mruby_fuzzer_seed_corpus $SRC/mruby_seeds\n", "work_dir": "/src/mruby", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=58577\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6042731473666048\n\nProject: mruby\nFuzzing Engine: libFuzzer\nFuzz Target: mruby_fuzzer\nJob Type: libfuzzer_asan_mruby\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x62f000043c60\nCrash State:\n  gc_mark_children\n  incremental_gc\n  mrb_full_gc\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_mruby&range=202212060611:202212070606\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6042731473666048\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "b47c8b738ae3e400ec02269fae9857222218e9d5", "url": "https://github.com/mruby/mruby/commit/b47c8b738ae3e400ec02269fae9857222218e9d5"}]}
{"instance_id": "exiv2.osv-2022-223", "repo": "exiv2/exiv2", "base_commit": "6e9eca445aa6fffa308e30fcf0168cb28c106a70", "date": "2022-04-06T08:53:33", "project_name": "exiv2", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\nFROM hwiwonlee/secb.base:latest\n\nRUN apt-get update && apt-get install -y cmake make ccache python3 libexpat1-dev zlib1g-dev libssh-dev libcurl4-openssl-dev libxml2-utils\nRUN git clone https://github.com/Exiv2/exiv2 exiv2\nRUN git -C exiv2 checkout 6e9eca445aa6fffa308e30fcf0168cb28c106a70\nWORKDIR exiv2\n\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Added to fix a false positive result: https://github.com/google/oss-fuzz/issues/6489\nCXXFLAGS=\"${CXXFLAGS} -fno-sanitize=float-divide-by-zero\"\n\n# Build Exiv2\nmkdir -p build\ncd build\ncmake -DEXIV2_ENABLE_PNG=ON -DEXIV2_ENABLE_WEBREADY=ON -DEXIV2_ENABLE_CURL=OFF -DEXIV2_ENABLE_BMFF=ON -DEXIV2_TEAM_WARNINGS_AS_ERRORS=ON -DBUILD_SHARED_LIBS=OFF -DCMAKE_CXX_COMPILER=\"${CXX}\" -DCMAKE_CXX_FLAGS=\"${CXXFLAGS}\" -DEXIV2_BUILD_FUZZ_TESTS=ON -DEXIV2_TEAM_OSS_FUZZ=ON -DLIB_FUZZING_ENGINE=\"${LIB_FUZZING_ENGINE}\" ..\nmake -j $(nproc)\n\n# Copy binary and dictionary to $OUT\ncp ./bin/fuzz-read-print-write $OUT\ncp ../fuzz/exiv2.dict $OUT/fuzz-read-print-write.dict\n\n# Initialize the corpus, using the files in test/data\nmkdir corpus\nfor f in $(find ../test/data -type f -size -20k); do\n    s=$(sha1sum \"$f\" | awk '{print $1}')\n    cp $f corpus/$s\ndone\n\nzip -j $OUT/fuzz-read-print-write.zip corpus/*\n", "work_dir": "/src/exiv2", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45302\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4560990975426560\n\nProject: exiv2\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz-read-print-write\nJob Type: libfuzzer_asan_exiv2\nPlatform Id: linux\n\nCrash Type: Container-overflow READ 4\nCrash Address: 0x63100003c88e\nCrash State:\n  Exiv2::Photoshop::locateIrb\n  Exiv2::Photoshop::setIptcIrb\n  Exiv2::JpegBase::doWriteMetadata\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_exiv2&range=202203040604:202203050613\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4560990975426560\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "e715243aa51fa38a89d35ea377d267600217e192", "url": "https://github.com/Exiv2/exiv2/commit/e715243aa51fa38a89d35ea377d267600217e192"}]}
{"instance_id": "libdwarf.osv-2022-389", "repo": "davea42/libdwarf-code", "base_commit": "436ea0d3fd7bef82679be01af8ce69e3f84e1c62", "date": "2022-07-23T10:40:32", "project_name": "libdwarf-code", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool\nRUN git clone https://github.com/davea42/libdwarf-code libdwarf\nRUN git -C libdwarf checkout 436ea0d3fd7bef82679be01af8ce69e3f84e1c62\nRUN git clone --depth=1 https://github.com/DavidKorczynski/binary-samples $SRC/binary-samples\nWORKDIR libdwarf\nCOPY build.sh $SRC/\nCOPY fuzz*.c $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nexport CFLAGS=\"${CFLAGS} -g -Werror\"\nexport CXXFLAGS=\"${CXXFLAGS} -g -Werror\"\n\nmkdir build\ncd build\ncmake ../\nmake\n\n# Build corpus for fuzzing\nmkdir $SRC/corp\ncp $SRC/binary-samples/elf* $SRC/corp\ncp $SRC/binary-samples/Mach* $SRC/corp\ncp $SRC/binary-samples/pe* $SRC/corp\ncp $SRC/binary-samples/lib* $SRC/corp\n\nzip -r -j $OUT/fuzz_init_path_seed_corpus.zip $SRC/corp\ncp $OUT/fuzz_init_path_seed_corpus.zip $OUT/fuzz_init_binary_seed_corpus.zip\n\nfor fuzzName in init_path init_binary; do\n  $CC $CFLAGS $LIB_FUZZING_ENGINE -I../src/lib/libdwarf/ \\\n    $SRC/fuzz_${fuzzName}.c -o $OUT/fuzz_${fuzzName} ./src/lib/libdwarf/libdwarf.a\ndone\n", "work_dir": "/src/libdwarf", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=47150\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6727387238236160\n\nProject: libdwarf\nFuzzing Engine: honggfuzz\nFuzz Target: fuzz_init_path\nJob Type: honggfuzz_asan_libdwarf\nPlatform Id: linux\n\nCrash Type: Global-buffer-overflow READ 1\nCrash Address: 0x00000064d0c1\nCrash State:\n  _dwarf_pathjoinl\n  _dwarf_construct_linkedto_path\n  dwarf_gnu_debuglink\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_libdwarf&range=202204290611:202204300608\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6727387238236160\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "fuzz_init_binary.c", "content": "/* Copyright 2021 Google LLC\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n      http://www.apache.org/licenses/LICENSE-2.0\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n#include <stdint.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n\n/*\n * Libdwarf library callers can only use these headers.\n */\n#include \"dwarf.h\"\n#include \"libdwarf.h\"\n\n/*\n * A fuzzer that simulates a small part of the simplereader.c example.\n * This fuzzer targets dwarf_init_b.\n */\nint LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  char filename[256];\n  sprintf(filename, \"/tmp/libfuzzer.%d\", getpid());\n\n  FILE *fp = fopen(filename, \"wb\");\n  if (!fp) {\n    return 0;\n  }\n  fwrite(data, size, 1, fp);\n  fclose(fp);\n\n  int my_init_fd = 0;\n  Dwarf_Ptr errarg = 0;\n  Dwarf_Handler errhand = 0;\n  Dwarf_Error *errp = NULL;\n  Dwarf_Debug dbg = 0;\n\n  my_init_fd = open(filename, O_RDONLY);\n  if (my_init_fd != -1) {\n    dwarf_init_b(my_init_fd,DW_GROUPNUMBER_ANY,errhand,errarg,&dbg,errp);\n    dwarf_finish(dbg);\n    close(my_init_fd);\n  }\n\n  unlink(filename);\n  return 0;\n}\n"}, {"filename": "fuzz_init_path.c", "content": "/* Copyright 2021 Google LLC\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n      http://www.apache.org/licenses/LICENSE-2.0\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n#include <stdint.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n\n/*\n * Libdwarf library callers can only use these headers.\n */\n#include \"dwarf.h\"\n#include \"libdwarf.h\"\n\n/*\n * A fuzzer that simulates a small part of the simplereader.c example.\n */\nint LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  char filename[256];\n  sprintf(filename, \"/tmp/libfuzzer.%d\", getpid());\n\n  FILE *fp = fopen(filename, \"wb\");\n  if (!fp) {\n    return 0;\n  }\n  fwrite(data, size, 1, fp);\n  fclose(fp);\n  Dwarf_Ptr errarg = 0;\n  Dwarf_Handler errhand = 0;\n  Dwarf_Debug dbg = 0;\n  Dwarf_Error *errp = NULL;\n#define MACHO_PATH_LEN 2000\n  char macho_real_path[2000];\n  dwarf_init_path(filename, macho_real_path, MACHO_PATH_LEN,\n                  DW_GROUPNUMBER_ANY, errhand, errarg, &dbg, errp);\n\n  dwarf_finish(dbg);\n\n  unlink(filename);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "24dff940cc4c71a9c3cb5475aee231b19163a12c", "url": "https://github.com/davea42/libdwarf-code/commit/24dff940cc4c71a9c3cb5475aee231b19163a12c"}]}
{"instance_id": "pcre2.osv-2023-673", "repo": "pcre2project/pcre2", "base_commit": "b0b3fc4c4bc4bd8ada9ada3292a28a44570794f1", "date": "2023-08-06T12:21:17", "project_name": "pcre2", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool subversion\n\nRUN git clone https://github.com/PCRE2Project/pcre2 pcre2\nRUN git -C pcre2 checkout b0b3fc4c4bc4bd8ada9ada3292a28a44570794f1\nWORKDIR pcre2\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build project\n./autogen.sh\n./configure --enable-fuzz-support --enable-never-backslash-C --with-match-limit=1000 --with-match-limit-depth=1000\nmake -j$(nproc) clean\nmake -j$(nproc) all\n\n# build fuzzer\n$CXX $CXXFLAGS -o $OUT/pcre2_fuzzer \\\n    $LIB_FUZZING_ENGINE .libs/libpcre2-fuzzsupport.a .libs/libpcre2-8.a\n\n# set up dictionary and options to use it\ncp pcre2_fuzzer.options pcre2_fuzzer.dict $OUT/\n", "work_dir": "/src/pcre2", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=61268\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5439866803191808\n\nProject: pcre2\nFuzzing Engine: libFuzzer\nFuzz Target: pcre2_fuzzer\nJob Type: libfuzzer_asan_pcre2\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x6020000000ba\nCrash State:\n  match\n  pcre2_match_8\n  pcre2_fuzzsupport.c\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_pcre2&range=202308060619:202308070612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5439866803191808\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "5f77d022733a5b7e2ff1e3d80b547c0d89811efe", "url": "https://github.com/PCRE2Project/pcre2/commit/5f77d022733a5b7e2ff1e3d80b547c0d89811efe"}]}
{"instance_id": "espeak-ng.osv-2021-787", "repo": "espeak-ng/espeak-ng", "base_commit": "9de65fcb96f7150e899a882460ab8caa57c6efac", "date": "2022-06-30T02:44:15", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout 9de65fcb96f7150e899a882460ab8caa57c6efac\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=34533\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5632950604529664\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x602000000153\nCrash State:\n  string_decoder_getc_utf_8\n  text_decoder_getc\n  GetC\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202105130601:202105140612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5632950604529664\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "9decedb8c229e1a4219baceaab7a3d656e889e31", "url": "https://github.com/espeak-ng/espeak-ng/commit/9decedb8c229e1a4219baceaab7a3d656e889e31"}]}
{"instance_id": "icu.osv-2021-1206", "repo": "unicode-org/icu", "base_commit": "29443b8be710640ded073116b768da35f00cf0dd", "date": "2021-09-15T13:43:15", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout 29443b8be710640ded073116b768da35f00cf0dd\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=38156\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4509226890821632\n\nProject: icu\nFuzzing Engine: libFuzzer\nFuzz Target: uloc_canonicalize_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: Stack-use-after-scope READ 1\nCrash Address: 0x7fff22d2f2dd\nCrash State:\n  uprv_stricmp_70\n  ulocimp_getLanguage_70\n  _canonicalize\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=202109030601:202109050610\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4509226890821632\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "adb109f440f5dc9c7bb9f2b1df3a9d63109aa585", "url": "https://github.com/unicode-org/icu.git/commit/adb109f440f5dc9c7bb9f2b1df3a9d63109aa585"}]}
{"instance_id": "php.osv-2022-235", "repo": "php/php-src", "base_commit": "6e8f2ba6b87e65069895bc7839c9e9416865e807", "date": "2022-10-24T06:42:41", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# The current clang revision is broken, pin to older one.\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 6e8f2ba6b87e65069895bc7839c9e9416865e807\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45369\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6096176166862848\n\nProject: php\nFuzzing Engine: honggfuzz\nFuzz Target: php-fuzz-execute\nJob Type: honggfuzz_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x7fd1cbbfb810\nCrash State:\n  zend_gc_collect_cycles\n  fuzzer_request_shutdown\n  fuzzer_do_request_from_buffer\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_php&range=202202110604:202202120607\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6096176166862848\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "c4ecd82f9399850a36bf2466d0a54a045b6dfa15", "url": "https://github.com/php/php-src.git/commit/c4ecd82f9399850a36bf2466d0a54a045b6dfa15"}]}
{"instance_id": "sleuthkit.osv-2021-1380", "repo": "sleuthkit/sleuthkit", "base_commit": "ce1c9c61c8168d0292842fcdd53275fc4459f02d", "date": "2022-01-05T11:02:20", "project_name": "sleuthkit", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool\nRUN git clone https://github.com/sleuthkit/sleuthkit sleuthkit\nRUN git -C sleuthkit checkout ce1c9c61c8168d0292842fcdd53275fc4459f02d\nWORKDIR sleuthkit\nCOPY build.sh buildcorpus.sh sleuthkit_mem_img.h *_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nexport CFLAGS=\"$CFLAGS -Wno-error=non-c-typedef-for-linkage\"\nexport CXXFLAGS=\"$CXXFLAGS -Wno-error=non-c-typedef-for-linkage\"\n\n# Dont fail if some of the seed downloads fail.\n${SRC}/buildcorpus.sh || true\n\n./bootstrap\n./configure --enable-static --disable-shared --disable-java --without-afflib --without-libewf --without-libvhdi --without-libvmdk\nmake -j$(nproc)\n\ndeclare -A TSK_FS_TYPES=(\n  [\"ext\"]=\"TSK_FS_TYPE_EXT_DETECT\"\n  [\"fat\"]=\"TSK_FS_TYPE_FAT_DETECT\"\n  [\"hfs\"]=\"TSK_FS_TYPE_HFS\"\n  [\"ntfs\"]=\"TSK_FS_TYPE_NTFS\"\n  [\"iso9660\"]=\"TSK_FS_TYPE_ISO9660\"\n)\n\ndeclare -A TSK_VS_TYPES=(\n  [\"dos\"]=\"TSK_VS_TYPE_DOS\"\n  [\"gpt\"]=\"TSK_VS_TYPE_GPT\"\n  [\"mac\"]=\"TSK_VS_TYPE_MAC\"\n  [\"sun\"]=\"TSK_VS_TYPE_SUN\"\n)\n\n# The fls APFS fuzz target has a seperate source file since it uses the libtsk\n# pool layer.\n$CXX $CXXFLAGS -std=c++14 -I.. -I. -Itsk \\\n    $SRC/sleuthkit_fls_apfs_fuzzer.cc -o $OUT/sleuthkit_fls_apfs_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/sleuthkit/tsk/.libs/libtsk.a\n\nfor type in ${!TSK_FS_TYPES[@]}; do\n  $CXX $CXXFLAGS -std=c++14 -I.. -I. -Itsk -DFSTYPE=${TSK_FS_TYPES[$type]} \\\n      $SRC/sleuthkit_fls_fuzzer.cc -o $OUT/sleuthkit_fls_${type}_fuzzer \\\n      $LIB_FUZZING_ENGINE $SRC/sleuthkit/tsk/.libs/libtsk.a\ndone\n\nfor type in ${!TSK_VS_TYPES[@]}; do\n  $CXX $CXXFLAGS -std=c++14 -I.. -I. -Itsk -DVSTYPE=${TSK_VS_TYPES[$type]} \\\n      $SRC/sleuthkit_mmls_fuzzer.cc -o $OUT/sleuthkit_mmls_${type}_fuzzer \\\n      $LIB_FUZZING_ENGINE $SRC/sleuthkit/tsk/.libs/libtsk.a\ndone\n", "work_dir": "/src/sleuthkit", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39317\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5756145092919296\n\nProject: sleuthkit\nFuzzing Engine: libFuzzer\nFuzz Target: sleuthkit_fls_ntfs_fuzzer\nJob Type: libfuzzer_asan_sleuthkit\nPlatform Id: linux\n\nCrash Type: Negative-size-param\nCrash Address:\nCrash State:\n  ntfs_attr_walk_special\n  tsk_fs_attr_walk\n  ntfs_proc_attrseq\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_sleuthkit&range=202109240601:202109260610\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5756145092919296\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "buildcorpus.sh", "content": "#!/bin/bash -eu\n#\n# Script to downloads test data and build the corpus\n#\n# Copyright 2021 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Test data provided by:\n#\n# The Fuzzing Project: https://fuzzing-project.org/resources.html\n#   As CC0 1.0 Universal (CC0 1.0) Public Domain Dedication\n#   https://creativecommons.org/publicdomain/zero/1.0/\n#\n# The dfVFS project: https://github.com/log2timeline/dfvfs\n#   As Apache 2 https://github.com/log2timeline/dfvfs/blob/main/LICENSE\n\n# Files to use for fls fuzz targets\ndeclare -A FLS_TEST_FILES=(\n  [\"apfs\"]=\"https://github.com/log2timeline/dfvfs/blob/main/test_data/apfs.raw?raw=true\"\n  [\"ext\"]=\"https://files.fuzzing-project.org/filesystems/ext2.img\"\n  [\"fat\"]=\"https://files.fuzzing-project.org/filesystems/exfat.img https://files.fuzzing-project.org/filesystems/fat12.img https://files.fuzzing-project.org/filesystems/fat16.img https://files.fuzzing-project.org/filesystems/fat32.img\"\n  [\"hfs\"]=\"https://files.fuzzing-project.org/filesystems/hfsplus.img\"\n  [\"iso9660\"]=\"https://files.fuzzing-project.org/discimages/iso9660.iso\"\n  [\"ntfs\"]=\"https://files.fuzzing-project.org/filesystems/ntfs.img\"\n)\n\n# Files to use for mmls fuzz targets\ndeclare -A MMLS_TEST_FILES=(\n  [\"dos\"]=\"https://files.fuzzing-project.org/discimages/partition-dos\"\n  [\"gpt\"]=\"https://files.fuzzing-project.org/discimages/partition-gpt\"\n  [\"mac\"]=\"https://files.fuzzing-project.org/discimages/partition-mac\"\n)\n\n\nfor type in ${!FLS_TEST_FILES[@]}; do\n  fuzz_target=\"sleuthkit_fls_${type}_fuzzer\"\n\n  mkdir -p \"test_data/${fuzz_target}\"\n\n  IFS=\" \"; for url in ${FLS_TEST_FILES[$type]}; do\n    filename=$( echo ${url} | sed 's/?[^?]*$//' )\n    filename=$( basename ${filename} )\n\n    curl -L -o \"test_data/${fuzz_target}/${filename}\" \"${url}\"\n  done\n\n  (cd \"test_data/${fuzz_target}\" && zip ${OUT}/${fuzz_target}_seed_corpus.zip *)\ndone\n\n\nfor type in ${!MMLS_TEST_FILES[@]}; do\n  fuzz_target=\"sleuthkit_mmls_${type}_fuzzer\"\n\n  mkdir -p \"test_data/${fuzz_target}\"\n\n  IFS=\" \"; for url in ${MMLS_TEST_FILES[$type]}; do\n    filename=$( echo ${url} | sed 's/?[^?]*$//' )\n    filename=$( basename ${filename} )\n\n    curl -L -o \"test_data/${fuzz_target}/${filename}\" \"${url}\"\n  done\n\n  (cd \"test_data/${fuzz_target}\" && zip ${OUT}/${fuzz_target}_seed_corpus.zip *)\ndone\n"}, {"filename": "sleuthkit_fls_apfs_fuzzer.cc", "content": "// Copyright 2021 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n#include \"sleuthkit/tsk/fs/tsk_fs.h\"\n#include \"sleuthkit/tsk/pool/tsk_pool.h\"\n#include \"sleuthkit_mem_img.h\"\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  TSK_IMG_INFO* img;\n  TSK_IMG_INFO* pool_img;\n  TSK_FS_INFO* fs;\n  const TSK_POOL_INFO* pool;\n\n  img = mem_open(data, size);\n  if (img == nullptr) {\n    return 0;\n  }\n  pool = tsk_pool_open_img_sing(img, 0, TSK_POOL_TYPE_APFS);\n\n  if (pool == nullptr) {\n    goto out_img;\n  }\n  // Pool start block is APFS container specific and is hard coded for now\n  pool_img = pool->get_img_info(pool, (TSK_DADDR_T) 106);\n\n  if (pool_img == nullptr) {\n    goto out_pool;\n  }\n  fs = tsk_fs_open_img_decrypt(pool_img, 0, TSK_FS_TYPE_APFS_DETECT, \"\");\n\n  if (fs != nullptr) {\n    tsk_fs_fls(fs, TSK_FS_FLS_FULL, fs->root_inum, TSK_FS_DIR_WALK_FLAG_RECURSE, nullptr, 0);\n\n    fs->close(fs);\n  }\n  tsk_img_close(pool_img);\n\nout_pool:\n  tsk_pool_close(pool);\n\nout_img:\n  tsk_img_close(img);\n\n  return 0;\n}\n"}, {"filename": "sleuthkit_fls_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n#include \"sleuthkit_mem_img.h\"\n\n#ifndef FSTYPE\n#error Define FSTYPE as a valid value of TSK_FS_TYPE_ENUM.\n#endif\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  TSK_IMG_INFO *img;\n  TSK_FS_INFO *fs;\n\n  img = mem_open(data, size);\n  if (img == nullptr)\n    return 0;\n\n  fs = tsk_fs_open_img(img, 0, FSTYPE);\n  if (fs != nullptr) {\n    tsk_fs_fls(fs, TSK_FS_FLS_FULL, fs->root_inum, TSK_FS_DIR_WALK_FLAG_RECURSE,\n               nullptr, 0);\n\n    fs->close(fs);\n  }\n\n  img->close(img);\n  return 0;\n}\n"}, {"filename": "sleuthkit_mem_img.h", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#ifndef MEM_IMG_H\n#define MEM_IMG_H\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n\ntypedef struct {\n  TSK_IMG_INFO img_info;\n  const uint8_t *data;\n  size_t size;\n} IMG_MEM_INFO;\n\nstatic ssize_t mem_read(TSK_IMG_INFO *img_info, TSK_OFF_T offset, char *buf,\n                        size_t len) {\n  IMG_MEM_INFO *mem_info = reinterpret_cast<IMG_MEM_INFO *>(img_info);\n  // Bounds-checking exists in the real drivers.\n  if (offset > mem_info->size) {\n    return -1;\n  }\n  ssize_t read_len = len;\n  if (offset + len > mem_info->size) {\n    read_len = mem_info->size - offset;\n  }\n  if (memcpy(buf, mem_info->data + offset, read_len) == nullptr) {\n    return -1;\n  } else {\n    return read_len;\n  }\n}\n\nstatic void mem_close(TSK_IMG_INFO *img_info) {\n  IMG_MEM_INFO *mem_info = reinterpret_cast<IMG_MEM_INFO *>(img_info);\n  tsk_deinit_lock(&(img_info->cache_lock));\n  free(mem_info);\n}\n\nstatic void mem_imgstat(TSK_IMG_INFO *img_info, FILE *hFile) {}\n\nTSK_IMG_INFO *mem_open(const uint8_t *data, size_t size) {\n  IMG_MEM_INFO *inmemory_img =\n      reinterpret_cast<IMG_MEM_INFO *>(malloc(sizeof(IMG_MEM_INFO)));\n  TSK_IMG_INFO *img;\n  if (inmemory_img == nullptr) {\n    return nullptr;\n  }\n  img = reinterpret_cast<TSK_IMG_INFO *>(inmemory_img);\n  img->itype = TSK_IMG_TYPE_RAW;\n  img->read = mem_read;\n  img->close = mem_close;\n  img->imgstat = mem_imgstat;\n  img->size = size;\n  img->sector_size = 512;\n  tsk_init_lock(&(img->cache_lock));\n  inmemory_img->data = data;\n  inmemory_img->size = size;\n  return img;\n}\n\n#endif // # MEM_IMG_H\n"}, {"filename": "sleuthkit_mmls_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n#include \"sleuthkit_mem_img.h\"\n\n#ifndef VSTYPE\n#error Define VSTYPE as a valid value of TSK_VS_TYPE_ENUM.\n#endif\n\nstatic TSK_WALK_RET_ENUM part_act(TSK_VS_INFO *vs, const TSK_VS_PART_INFO *part,\n                                  void *ptr) {\n  return TSK_WALK_CONT;\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  TSK_IMG_INFO *img;\n  TSK_VS_INFO *vs;\n\n  img = mem_open(data, size);\n  if (img == nullptr)\n    return 0;\n\n  vs = tsk_vs_open(img, 0, VSTYPE);\n  if (vs != nullptr) {\n    tsk_vs_part_walk(vs, 0, vs->part_count - 1, TSK_VS_PART_FLAG_ALL, part_act,\n                     nullptr);\n\n    tsk_vs_close(vs);\n  }\n\n  img->close(img);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "0c25e58d667a9c605dfc250671cb9dc7796e5a22", "url": "https://github.com/sleuthkit/sleuthkit/commit/0c25e58d667a9c605dfc250671cb9dc7796e5a22"}]}
{"instance_id": "harfbuzz.osv-2018-61", "repo": "harfbuzz/harfbuzz", "base_commit": "a3fa7d33360a58df5333dbbd121328e580f08849", "date": "2019-01-14T14:37:36", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout a3fa7d33360a58df5333dbbd121328e580f08849\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr\"\n\n# Build the library.\n./autogen.sh\n./configure --enable-static --disable-shared\nmake clean\nmake -j$(nproc) CPPFLAGS=\"-DHB_NO_VISIBILITY\" V=1 all\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset.a ./src/.libs/libharfbuzz.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shaping/data/in-house/fonts \\\n\ttest/shaping/data/aots/fonts \\\n\ttest/shaping/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=12312\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5631444412530688\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 2\nCrash Address: 0x613000000350\nCrash State:\n  BEInt<unsigned short, 2>::operator unsigned short\n  OT::IntType<unsigned short, 2u>::operator unsigned int\n  OT::OffsetTo<OT::UnsizedOffsetListOf<AAT::Lookup<OT::IntType<unsigned short, 2u>\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201812010220:201812020220\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5631444412530688\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "7a6686a589ed6bf17a5af0b8012501e4d4ee2ded", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/7a6686a589ed6bf17a5af0b8012501e4d4ee2ded"}]}
{"instance_id": "c-ares.osv-2020-569", "repo": "c-ares/c-ares", "base_commit": "c5bfbe0dc3086b39218a4d9a8ef2ce4f538673da", "date": "2019-06-19T08:22:39", "project_name": "c-ares", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool\nRUN git clone https://github.com/c-ares/c-ares.git\nRUN git -C c-ares checkout c5bfbe0dc3086b39218a4d9a8ef2ce4f538673da\nWORKDIR c-ares\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Remove -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION from CFLAGS\n# as a workaround for https://github.com/google/oss-fuzz/issues/413.\n# It's unclear why the c-ares configure is that picky;\n# a better fix would probably be in the c-ares build system.\nCFLAGS=$(for f in $CFLAGS; do [ $f != \"-DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\" ] && echo $f; done);\n\n# Build the project.\n./buildconf\n./configure --enable-debug\nmake clean\nmake -j$(nproc) V=1 all\n\n# Build the fuzzers.\n$CC $CFLAGS -I. -c $SRC/c-ares/test/ares-test-fuzz.c -o $WORK/ares-test-fuzz.o\n$CXX $CXXFLAGS -std=c++11 $WORK/ares-test-fuzz.o \\\n    -o $OUT/ares_parse_reply_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/c-ares/.libs/libcares.a\n\n$CC $CFLAGS -I. -c $SRC/c-ares/test/ares-test-fuzz-name.c \\\n    -o $WORK/ares-test-fuzz-name.o\n$CXX $CXXFLAGS -std=c++11 $WORK/ares-test-fuzz-name.o \\\n    -o $OUT/ares_create_query_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/c-ares/.libs/libcares.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nzip -j $OUT/ares_parse_reply_fuzzer_seed_corpus.zip $SRC/c-ares/test/fuzzinput/*\nzip -j $OUT/ares_create_query_fuzzer_seed_corpus.zip \\\n    $SRC/c-ares/test/fuzznames/*\n", "work_dir": "/src/c-ares", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=15388\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5697835103682560\n\nProject: c-ares\nFuzzer: libFuzzer_c-ares_ares_parse_reply_fuzzer\nFuzz target binary: ares_parse_reply_fuzzer\nJob Type: libfuzzer_ubsan_c-ares\nPlatform Id: linux\n\nCrash Type: Null-dereference READ\nCrash Address: 0x000000000000\nCrash State:\n  NULL\nSanitizer: undefined (UBSAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_ubsan_c-ares&range=201906180157:201906190155\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5697835103682560\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "5dd3629bc93449840c36dd635ea6cce606b8c366", "url": "https://github.com/c-ares/c-ares.git/commit/5dd3629bc93449840c36dd635ea6cce606b8c366"}]}
{"instance_id": "php.osv-2020-1735", "repo": "php/php-src", "base_commit": "a009d370e93fdc5928b2de9321d433ca39e7c6e6", "date": "2020-09-15T09:27:17", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout a009d370e93fdc5928b2de9321d433ca39e7c6e6\nRUN git clone https://github.com/kkos/oniguruma.git php-src/oniguruma\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build oniguruma and link statically\npushd oniguruma\nautoreconf -vfi\n./configure\nmake -j$(nproc)\npopd\nexport ONIG_CFLAGS=\"-I$PWD/oniguruma/src\"\nexport ONIG_LIBS=\"-L$PWD/oniguruma/src/.libs -l:libonig.a\"\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# build project\n./buildconf\n./configure \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-mbstring \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-mbstring\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=25526\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5725932898484224\n\nProject: php\nFuzzing Engine: honggfuzz\nFuzz Target: php-fuzz-execute\nJob Type: honggfuzz_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x6120000145c0\nCrash State:\n  zend_gc_delref\n  i_zval_ptr_dtor\n  zval_ptr_dtor\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_php&range=202008280605:202008290628\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5725932898484224\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "3c53732332c4b9d3904eec0d1c42f0d4d4bf65c6", "url": "https://github.com/php/php-src.git/commit/3c53732332c4b9d3904eec0d1c42f0d4d4bf65c6"}]}
{"instance_id": "liblouis.osv-2023-599", "repo": "liblouis/liblouis", "base_commit": "2e9409c1b4f32e2c752bf22686c8e752ffd868e2", "date": "2023-12-04T09:36:00", "project_name": "liblouis", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool \\\n  pkg-config zlib1g-dev libpci-dev\nRUN git clone https://github.com/liblouis/liblouis\nRUN git -C liblouis checkout 2e9409c1b4f32e2c752bf22686c8e752ffd868e2\nWORKDIR liblouis\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n$SRC/liblouis/tests/fuzzing/build.sh\n", "work_dir": "/src/liblouis", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=60723\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6608976274653184\n\nProject: liblouis\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz_translate_generic\nJob Type: libfuzzer_asan_liblouis\nPlatform Id: linux\n\nCrash Type: Negative-size-param\nCrash Address:\nCrash State:\n  passDoAction\n  translateString\n  _lou_translate\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_liblouis&range=202304240604:202304250611\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6608976274653184\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "878ef436e6cf401e5134899d70d5a8c0815cd549", "url": "https://github.com/liblouis/liblouis/commit/878ef436e6cf401e5134899d70d5a8c0815cd549"}]}
{"instance_id": "icu.osv-2023-873", "repo": "unicode-org/icu", "base_commit": "2ca7c49662cfa0455c211f310998302a2e0d64d9", "date": "2023-09-20T16:46:00", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout 2ca7c49662cfa0455c211f310998302a2e0d64d9\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62425\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4871952818634752\n\nProject: icu\nFuzzing Engine: libFuzzer\nFuzz Target: calendar_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: UNKNOWN WRITE\nCrash Address: 0x616400000c68\nCrash State:\n  icu_74::Calendar::set\n  calendar_fuzzer.cpp\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=202309140626:202309160609\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4871952818634752\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "6a42197331c23ed7e09d040f6deaa7c352c02cca", "url": "https://github.com/unicode-org/icu.git/commit/6a42197331c23ed7e09d040f6deaa7c352c02cca"}]}
{"instance_id": "serenity.osv-2021-315", "repo": "serenityos/serenity", "base_commit": "9aa91e6c6f267c843b92cf57eeae289ccae82799", "date": "2021-02-27T00:20:52", "project_name": "serenity", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y build-essential cmake curl e2fsprogs libmpfr-dev libmpc-dev libgmp-dev ninja-build\nRUN git clone https://github.com/SerenityOS/serenity\nRUN git -C serenity checkout 9aa91e6c6f267c843b92cf57eeae289ccae82799\nCOPY build.sh $SRC/\nWORKDIR $SRC/serenity/Meta/Lagom", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Now build the content\nmkdir -p build\ncd build\ncmake -GNinja \\\n    -DBUILD_LAGOM=ON \\\n    -DENABLE_OSS_FUZZ=ON \\\n    -DCMAKE_C_COMPILER=$CC \\\n    -DCMAKE_CXX_COMPILER=$CXX \\\n    -DCMAKE_CXX_FLAGS=\"$CXXFLAGS -DOSS_FUZZ=ON\" \\\n    -DLINKER_FLAGS=\"$LIB_FUZZING_ENGINE\" \\\n    ..\nninja\ncp Fuzzers/Fuzz* $OUT/\n\n", "work_dir": "/src/serenity/Meta/Lagom", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=30507\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5911674068533248\n\nProject: serenity\nFuzzing Engine: honggfuzz\nFuzz Target: FuzzGIFLoader\nJob Type: honggfuzz_asan_serenity\nPlatform Id: linux\n\nCrash Type: Global-buffer-overflow READ 4\nCrash Address: 0x0000006ab150\nCrash State:\n  Gfx::decode_frame\n  Gfx::GIFImageDecoderPlugin::frame\n  Gfx::GIFImageDecoderPlugin::bitmap\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_serenity&range=202102060612:202102070602\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5911674068533248\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [], "candidate_fixes": [{"sha": "ce5fe2a6e807b819866b4f429ca6f7a2d74445b7", "url": "https://github.com/SerenityOS/serenity/commit/ce5fe2a6e807b819866b4f429ca6f7a2d74445b7"}]}
{"instance_id": "php.osv-2023-598", "repo": "php/php-src", "base_commit": "6ae9cf40d11eb31562246fbcac7cc73cdc8a2278", "date": "2023-08-01T11:40:25", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# The current clang revision is broken, pin to older one.\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 6ae9cf40d11eb31562246fbcac7cc73cdc8a2278\nWORKDIR php-src\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=60734\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5995844627988480\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-tracing-jit\nJob Type: libfuzzer_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x604000026b50\nCrash State:\n  zval_call_destructor\n  zend_hash_reverse_apply\n  shutdown_destructors\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_php&range=202307170619:202307180605\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5995844627988480\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [], "candidate_fixes": [{"sha": "2fbec0974fd6ec89555f37356a8376f680b9bf49", "url": "https://github.com/php/php-src.git/commit/2fbec0974fd6ec89555f37356a8376f680b9bf49"}]}
{"instance_id": "harfbuzz.osv-2021-1381", "repo": "harfbuzz/harfbuzz", "base_commit": "a52c6df38a38c4e36ff991dfb4b7d92e48a44553", "date": "2021-09-27T16:18:36", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y python3-pip ragel pkg-config && \\\n    pip3 install meson==0.53.0 ninja\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout a52c6df38a38c4e36ff991dfb4b7d92e48a44553\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\n\n# setup\nbuild=$WORK/build\n\n# cleanup\nrm -rf $build\nmkdir -p $build\n\n# Build the library.\nmeson --default-library=static --wrap-mode=nodownload \\\n      -Dexperimental_api=true \\\n      -Dfuzzer_ldflags=\"$(echo $LIB_FUZZING_ENGINE)\" \\\n      $build \\\n  || (cat build/meson-logs/meson-log.txt && false)\n\n# Build the fuzzers.\nninja -v -j$(nproc) -C $build test/fuzzing/hb-{shape,draw,subset,set}-fuzzer\nmv $build/test/fuzzing/hb-{shape,draw,subset,set}-fuzzer $OUT/\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shape/data/in-house/fonts \\\n\ttest/shape/data/aots/fonts \\\n\ttest/shape/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\tperf/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-draw-fuzzer_seed_corpus.zip\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\nzip $OUT/hb-set-fuzzer_seed_corpus.zip ./test/fuzzing/sets/*\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39225\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5891183595880448\n\nProject: harfbuzz\nFuzzing Engine: libFuzzer\nFuzz Target: hb-subset-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x6190000043ec\nCrash State:\n  OT::MathValueRecord::copy\n  OT::MathGlyphAssembly::subset\n  OT::MathGlyphConstruction::subset\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=202109220610:202109230614\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5891183595880448\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "hb-draw-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-set-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "794b00db4b63e8314aee96c23a20ecb878452eef", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/794b00db4b63e8314aee96c23a20ecb878452eef"}]}
{"instance_id": "libraw.osv-2020-1519", "repo": "libraw/libraw", "base_commit": "371161a06d7f98f231a001dad4af2dfb463e270a", "date": "2021-07-27T07:02:08", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout 371161a06d7f98f231a001dad4af2dfb463e270a\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=23837\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6229491834945536\n\nProject: libraw\nFuzzing Engine: libFuzzer\nFuzz Target: libraw_raf_fuzzer\nJob Type: libfuzzer_ubsan_libraw\nPlatform Id: linux\n\nCrash Type: Index-out-of-bounds\nCrash Address:\nCrash State:\n  DHT::hide_hots\n  LibRaw::dht_interpolate\n  LibRaw::dcraw_process\n \nSanitizer: undefined (UBSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_ubsan_libraw&range=202006121756:202006130238\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6229491834945536\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  LibRaw lib_raw;\n\n  int result = lib_raw.open_buffer(\n      const_cast<char*>(reinterpret_cast<const char*>(data)), size);\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "363e91ea656f4ce46584b4b0af6285030f236b7e", "url": "https://github.com/libraw/libraw/commit/363e91ea656f4ce46584b4b0af6285030f236b7e"}]}
{"instance_id": "harfbuzz.osv-2018-129", "repo": "harfbuzz/harfbuzz", "base_commit": "cf4b7db6b1e01c11d7a8a26d95cf947935a234a7", "date": "2018-12-05T04:53:23", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout cf4b7db6b1e01c11d7a8a26d95cf947935a234a7\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr\"\n\n# Build the library.\n./autogen.sh\n./configure --enable-static --disable-shared\nmake clean\nmake -j$(nproc) CPPFLAGS=\"-DHB_NO_VISIBILITY\" V=1 all\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset.a ./src/.libs/libharfbuzz.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shaping/data/in-house/fonts \\\n\ttest/shaping/data/aots/fonts \\\n\ttest/shaping/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11657\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5700264032468992\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 2\nCrash Address: 0x617000000688\nCrash State:\n  BEInt<unsigned short, 2>::operator unsigned short\n  OT::IntType<unsigned short, 2u>::operator unsigned int\n  CFF::Charset1_2<OT::IntType<unsigned char, 1u> >::get_glyph\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201812010220:201812020220\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5700264032468992\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "79e7e3445efef2dc57f8a10c7e355e802af08868", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/79e7e3445efef2dc57f8a10c7e355e802af08868"}]}
{"instance_id": "serenity.osv-2021-397", "repo": "serenityos/serenity", "base_commit": "4d40864b9dc3837c00b1d02b567d6a648e0048f2", "date": "2021-02-14T07:30:10", "project_name": "serenity", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y build-essential cmake curl e2fsprogs libmpfr-dev libmpc-dev libgmp-dev ninja-build\nRUN git clone https://github.com/SerenityOS/serenity\nRUN git -C serenity checkout 4d40864b9dc3837c00b1d02b567d6a648e0048f2\nCOPY build.sh $SRC/\nWORKDIR $SRC/serenity/Meta/Lagom", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Now build the content\nmkdir -p build\ncd build\ncmake -GNinja \\\n    -DBUILD_LAGOM=ON \\\n    -DENABLE_OSS_FUZZ=ON \\\n    -DCMAKE_C_COMPILER=$CC \\\n    -DCMAKE_CXX_COMPILER=$CXX \\\n    -DCMAKE_CXX_FLAGS=\"$CXXFLAGS -DOSS_FUZZ=ON\" \\\n    -DLINKER_FLAGS=\"$LIB_FUZZING_ENGINE\" \\\n    ..\nninja\ncp Fuzzers/Fuzz* $OUT/\n\n", "work_dir": "/src/serenity/Meta/Lagom", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=30920\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5566060432588800\n\nProject: serenity\nFuzzing Engine: libFuzzer\nFuzz Target: FuzzRSAKeyParsing\nJob Type: libfuzzer_asan_serenity\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x60a000000520\nCrash State:\n  Crypto::UnsignedBigInteger::UnsignedBigInteger\n  Crypto::UnsignedBigInteger::import_data\n  Crypto::der_decode_integer\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_serenity&range=202102080622:202102130619\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5566060432588800\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [], "candidate_fixes": [{"sha": "3fe7ac0924ada70faaf27636b6e0f40bcde24f77", "url": "https://github.com/SerenityOS/serenity/commit/3fe7ac0924ada70faaf27636b6e0f40bcde24f77"}]}
{"instance_id": "systemd.osv-2020-682", "repo": "systemd/systemd", "base_commit": "16b4623620acdccb232392901074a61e360aa2a4", "date": "2019-03-22T16:07:47", "project_name": "systemd", "lang": "c++", "dockerfile": "# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER jonathan@titanous.com\nRUN apt-get update &&\\\n    apt-get install -y gperf m4 gettext python3-pip \\\n        libcap-dev libmount-dev libkmod-dev \\\n        pkg-config wget &&\\\n    pip3 install meson ninja\nRUN git clone https://github.com/systemd/systemd systemd\nRUN git -C systemd checkout 16b4623620acdccb232392901074a61e360aa2a4\nWORKDIR systemd\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\ntools/oss-fuzz.sh\n", "work_dir": "/src/systemd", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=13878\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5751069692395520\n\nProject: systemd\nFuzzer: libFuzzer_systemd_fuzz-link-parser\nFuzz target binary: fuzz-link-parser\nJob Type: libfuzzer_asan_systemd\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 8\nCrash Address: 0x603000000170\nCrash State:\n  condition_free_list_type\n  link_config_free\n  link_load_one\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_systemd&range=201903210209:201903230207\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5751069692395520\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [], "candidate_fixes": [{"sha": "7bb55ed099f611ec7077db69684a6cb93d42dc70", "url": "https://github.com/systemd/systemd/commit/7bb55ed099f611ec7077db69684a6cb93d42dc70"}]}
{"instance_id": "icu.osv-2023-849", "repo": "unicode-org/icu", "base_commit": "832997c57e7ad4a128447d8c90ee338d90a0faf3", "date": "2023-09-15T12:46:23", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout 832997c57e7ad4a128447d8c90ee338d90a0faf3\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62348\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4822681071255552\n\nProject: icu\nFuzzing Engine: libFuzzer\nFuzz Target: locale_morph_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: Stack-buffer-overflow WRITE 1\nCrash Address: 0x7ffc60b2cc54\nCrash State:\n  ulocimp_toLanguageTag_74\n  icu_74::Locale::toLanguageTag\n  locale_morph_fuzzer.cpp\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=202309050627:202309060613\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4822681071255552\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "386e9a10db28af620658ca0c635e1d98915f6306", "url": "https://github.com/unicode-org/icu.git/commit/386e9a10db28af620658ca0c635e1d98915f6306"}]}
{"instance_id": "espeak-ng.osv-2021-1354", "repo": "espeak-ng/espeak-ng", "base_commit": "ccb1c31ba3cfa785d27c5974f3be65df2967e7a0", "date": "2021-11-07T07:55:57", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout ccb1c31ba3cfa785d27c5974f3be65df2967e7a0\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39042\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6480243527909376\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Stack-buffer-underflow READ 8\nCrash Address: 0x7f0f709db000\nCrash State:\n  InterpretPhoneme\n  InterpretPhoneme2\n  CalcLengths\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202109090610:202109100607\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6480243527909376\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "be962b067b889852da6194342b26e1759e1d7952", "url": "https://github.com/espeak-ng/espeak-ng/commit/be962b067b889852da6194342b26e1759e1d7952"}]}
{"instance_id": "libexif.osv-2021-1138", "repo": "libexif/libexif", "base_commit": "790fb01e1c33c5c83e7f3e051fe6c6d5c3396ade", "date": "2021-08-16T05:10:12", "project_name": "libexif", "lang": "c++", "dockerfile": "# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool gettext autopoint\nRUN git clone https://github.com/libexif/libexif\nRUN git -C libexif checkout 790fb01e1c33c5c83e7f3e051fe6c6d5c3396ade\nRUN git clone --depth 1 https://github.com/ianare/exif-samples\nWORKDIR libexif\nCOPY exif_loader_fuzzer.cc exif_from_data_fuzzer.cc build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nautoreconf -fiv\n./configure --disable-docs --enable-shared=no --prefix=\"$WORK\"\nmake -j$(nproc)\nmake install\n\npushd $SRC\nmkdir -p exif_corpus\nfind exif-samples -type f -name '*.jpg' -exec mv -n {} exif_corpus/ \\; -o -name '*.tiff' -exec mv -n {} exif_corpus/ \\;\ncp libexif/test/testdata/*.jpg exif_corpus\nzip -r \"$WORK/exif_seed_corpus.zip\" exif_corpus/\npopd\n\nfor fuzzer in $(find $SRC/ -name '*_fuzzer.cc'); do\n  fuzzer_basename=$(basename -s .cc $fuzzer)\n  $CXX $CXXFLAGS \\\n      -std=c++11 \\\n      -I\"$WORK/include\" \\\n      $fuzzer \\\n      -o $OUT/$fuzzer_basename \\\n      $LIB_FUZZING_ENGINE \\\n      \"$WORK/lib/libexif.a\"\n  cp $WORK/exif_seed_corpus.zip \"${OUT}/${fuzzer_basename}_seed_corpus.zip\"\ndone\n", "work_dir": "/src/libexif", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37226\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5021203147390976\n\nProject: libexif\nFuzzing Engine: libFuzzer\nFuzz Target: exif_from_data_fuzzer\nJob Type: libfuzzer_asan_libexif\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x615000000505\nCrash State:\n  exif_get_sshort\n  exif_get_short\n  exif_mnote_data_apple_load\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libexif&range=202108140610:202108150609\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5021203147390976\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "exif_from_data_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <libexif/exif-data.h>\n#include <libexif/exif-loader.h>\n#include <stddef.h>\n#include <stdlib.h>\n\n/* Extract all MakerNote tags */\nstatic void mnote_dump(ExifData *data) {\n    ExifMnoteData *mn = exif_data_get_mnote_data(data);\n    if (mn) {\n        int num = exif_mnote_data_count(mn);\n\n        /* Loop through all MakerNote tags */\n        for (int i=0; i < num; ++i) {\n            char buf[1024];\n            exif_mnote_data_get_value(mn, i, buf, sizeof(buf));\n        }\n    }\n}\n\nstatic void dump_value(ExifEntry *entry, void *user_data) {\n  char buf[1024];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nstatic void data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, dump_value, NULL);\n}\n\n/* This is like exif_data_dump but without writing to stdout */\nstatic void data_dump(ExifData *data) {\n  exif_data_foreach_content(data, data_func, NULL);\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n\n  // Parse tags using (ultimately) exif_data_load_data()\n  auto image = exif_data_new_from_data(data, size);\n  if (image) {\n    // Exercise the EXIF tag manipulation code\n    exif_data_get_mnote_data(image);\n    data_dump(image);\n    mnote_dump(image);\n    unsigned char *buf;\n    unsigned int sz;\n    exif_data_save_data(image, &buf, &sz);\n    free(buf);\n    exif_data_fix(image);\n    exif_data_unref(image);\n  }\n\n  return 0;\n}\n"}, {"filename": "exif_loader_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stdio.h>\n#include <stdint.h>\n#include <libexif/exif-loader.h>\n\n\nvoid content_func(ExifEntry *entry, void *user_data) {\n  char buf[10000];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nvoid data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, content_func, NULL);\n}\n\nstatic void\ntest_exif_data (ExifData *d) {\n  unsigned int i, c;\n  char v[1024], *p;\n  ExifMnoteData *md;\n\n  md = exif_data_get_mnote_data (d);\n  if (!md) {\n    return;\n  }\n\n  exif_mnote_data_ref (md);\n  exif_mnote_data_unref (md);\n\n  c = exif_mnote_data_count (md);\n  for (i = 0; i < c; i++) {\n    const char *name = exif_mnote_data_get_name (md, i);\n    if (!name) {\n      break;\n    }\n    exif_mnote_data_get_title (md, i);\n    exif_mnote_data_get_description (md, i);\n    exif_mnote_data_get_value (md, i, v, sizeof (v));\n  }\n}\n\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  ExifLoader *loader = exif_loader_new();\n  ExifData *exif_data;\n  if (!loader) {\n    return 0;\n  }\n  exif_loader_write(loader, const_cast<unsigned char*>(data), size);\n  exif_data = exif_loader_get_data(loader);\n  if(!exif_data) {\n    exif_loader_unref(loader);\n    return 0;\n  }\n  exif_data_foreach_content(exif_data, data_func, NULL);\n  test_exif_data (exif_data);\n  exif_loader_unref(loader);\n  exif_data_unref(exif_data);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "eb452f533b2d906130a557ced3d6e38d7b064ff9", "url": "https://github.com/libexif/libexif/commit/eb452f533b2d906130a557ced3d6e38d7b064ff9"}]}
{"instance_id": "espeak-ng.osv-2021-769", "repo": "espeak-ng/espeak-ng", "base_commit": "43d07abec4abf07cc536e4fcf13088508231da76", "date": "2022-03-11T11:31:53", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout 43d07abec4abf07cc536e4fcf13088508231da76\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=34332\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6060397091225600\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Stack-buffer-overflow READ 16\nCrash Address: 0x7f78eb3a6120\nCrash State:\n  TranslateClause\n  SpeakNextClause\n  Synthesize\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202105130601:202105140612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6060397091225600\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "7f1222c6ad6a3652be35afbbc980a382076ff0a9", "url": "https://github.com/espeak-ng/espeak-ng/commit/7f1222c6ad6a3652be35afbbc980a382076ff0a9"}]}
{"instance_id": "libexif.osv-2021-1168", "repo": "libexif/libexif", "base_commit": "ce946b93dfd34b2187d9f9fb01603943fbb32137", "date": "2021-08-24T03:26:19", "project_name": "libexif", "lang": "c++", "dockerfile": "# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool gettext autopoint\nRUN git clone https://github.com/libexif/libexif\nRUN git -C libexif checkout ce946b93dfd34b2187d9f9fb01603943fbb32137\nRUN git clone --depth 1 https://github.com/ianare/exif-samples\nWORKDIR libexif\nCOPY exif_loader_fuzzer.cc exif_from_data_fuzzer.cc build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nautoreconf -fiv\n./configure --disable-docs --enable-shared=no --prefix=\"$WORK\"\nmake -j$(nproc)\nmake install\n\npushd $SRC\nmkdir -p exif_corpus\nfind exif-samples -type f -name '*.jpg' -exec mv -n {} exif_corpus/ \\; -o -name '*.tiff' -exec mv -n {} exif_corpus/ \\;\ncp libexif/test/testdata/*.jpg exif_corpus\nzip -r \"$WORK/exif_seed_corpus.zip\" exif_corpus/\npopd\n\nfor fuzzer in $(find $SRC/ -name '*_fuzzer.cc'); do\n  fuzzer_basename=$(basename -s .cc $fuzzer)\n  $CXX $CXXFLAGS \\\n      -std=c++11 \\\n      -I\"$WORK/include\" \\\n      $fuzzer \\\n      -o $OUT/$fuzzer_basename \\\n      $LIB_FUZZING_ENGINE \\\n      \"$WORK/lib/libexif.a\"\n  cp $WORK/exif_seed_corpus.zip \"${OUT}/${fuzzer_basename}_seed_corpus.zip\"\ndone\n", "work_dir": "/src/libexif", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37570\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6227140945772544\n\nProject: libexif\nFuzzing Engine: libFuzzer\nFuzz Target: exif_from_data_fuzzer\nJob Type: libfuzzer_asan_libexif\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x602000000133\nCrash State:\n  exif_get_slong\n  exif_get_long\n  exif_get_rational\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libexif&range=202108230603:202108240613\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6227140945772544\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "exif_from_data_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <libexif/exif-data.h>\n#include <libexif/exif-loader.h>\n#include <stddef.h>\n#include <stdlib.h>\n\n/* Extract all MakerNote tags */\nstatic void mnote_dump(ExifData *data) {\n    ExifMnoteData *mn = exif_data_get_mnote_data(data);\n    if (mn) {\n        int num = exif_mnote_data_count(mn);\n\n        /* Loop through all MakerNote tags */\n        for (int i=0; i < num; ++i) {\n            char buf[1024];\n            exif_mnote_data_get_value(mn, i, buf, sizeof(buf));\n        }\n    }\n}\n\nstatic void dump_value(ExifEntry *entry, void *user_data) {\n  char buf[1024];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nstatic void data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, dump_value, NULL);\n}\n\n/* This is like exif_data_dump but without writing to stdout */\nstatic void data_dump(ExifData *data) {\n  exif_data_foreach_content(data, data_func, NULL);\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n\n  // Parse tags using (ultimately) exif_data_load_data()\n  auto image = exif_data_new_from_data(data, size);\n  if (image) {\n    // Exercise the EXIF tag manipulation code\n    exif_data_get_mnote_data(image);\n    data_dump(image);\n    mnote_dump(image);\n    unsigned char *buf;\n    unsigned int sz;\n    exif_data_save_data(image, &buf, &sz);\n    free(buf);\n    exif_data_fix(image);\n    exif_data_unref(image);\n  }\n\n  return 0;\n}\n"}, {"filename": "exif_loader_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stdio.h>\n#include <stdint.h>\n#include <libexif/exif-loader.h>\n\n\nvoid content_func(ExifEntry *entry, void *user_data) {\n  char buf[10000];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nvoid data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, content_func, NULL);\n}\n\nstatic void\ntest_exif_data (ExifData *d) {\n  unsigned int i, c;\n  char v[1024], *p;\n  ExifMnoteData *md;\n\n  md = exif_data_get_mnote_data (d);\n  if (!md) {\n    return;\n  }\n\n  exif_mnote_data_ref (md);\n  exif_mnote_data_unref (md);\n\n  c = exif_mnote_data_count (md);\n  for (i = 0; i < c; i++) {\n    const char *name = exif_mnote_data_get_name (md, i);\n    if (!name) {\n      break;\n    }\n    exif_mnote_data_get_title (md, i);\n    exif_mnote_data_get_description (md, i);\n    exif_mnote_data_get_value (md, i, v, sizeof (v));\n  }\n}\n\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  ExifLoader *loader = exif_loader_new();\n  ExifData *exif_data;\n  if (!loader) {\n    return 0;\n  }\n  exif_loader_write(loader, const_cast<unsigned char*>(data), size);\n  exif_data = exif_loader_get_data(loader);\n  if(!exif_data) {\n    exif_loader_unref(loader);\n    return 0;\n  }\n  exif_data_foreach_content(exif_data, data_func, NULL);\n  test_exif_data (exif_data);\n  exif_loader_unref(loader);\n  exif_data_unref(exif_data);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "a4647a5463102c4b0c5a02461edd4cc085dfc1b6", "url": "https://github.com/libexif/libexif/commit/a4647a5463102c4b0c5a02461edd4cc085dfc1b6"}]}
{"instance_id": "simdutf.osv-2024-1034", "repo": "simdutf/simdutf", "base_commit": "14fd9df73721d0d69c7f487c967b0f407ef31614", "date": "2024-08-16T18:21:10", "project_name": "simdutf", "lang": "c++", "dockerfile": "# Copyright 2023 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make cmake\nRUN git clone https://github.com/simdutf/simdutf simdutf\nRUN git -C simdutf checkout 14fd9df73721d0d69c7f487c967b0f407ef31614\nWORKDIR simdutf\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2024 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nfuzz/build.sh\n", "work_dir": "/src/simdutf", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=71218\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5299931974270976\n\nProject: simdutf\nFuzzing Engine: libFuzzer\nFuzz Target: conversion\nJob Type: libfuzzer_asan_simdutf\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE {*}\nCrash Address: 0x51d0000008b3\nCrash State:\n  simdutf::haswell::implementation::convert_utf8_to_utf16be\n  Conversion<\n  Conversion<\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_simdutf&range=202408120618:202408130625\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5299931974270976\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "17804069551439ef292c6044920f446e97eb7004", "url": "https://github.com/simdutf/simdutf/commit/17804069551439ef292c6044920f446e97eb7004"}]}
{"instance_id": "mruby.osv-2020-739", "repo": "mruby/mruby", "base_commit": "c10e191ac70a78f99a1255dfa1bd9d7ffa803eb7", "date": "2019-11-06T07:10:21", "project_name": "mruby", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y build-essential ruby bison ninja-build \\\n    cmake zlib1g-dev libbz2-dev\nRUN git clone https://github.com/mruby/mruby mruby\nRUN git -C mruby checkout c10e191ac70a78f99a1255dfa1bd9d7ffa803eb7\nRUN git clone --depth 1 https://github.com/bshastry/mruby_seeds.git mruby_seeds\nRUN git clone --depth 1 https://github.com/google/libprotobuf-mutator.git\nRUN mkdir LPM; \\\n  cd LPM; \\\n  cmake $SRC/libprotobuf-mutator -GNinja -DLIB_PROTO_MUTATOR_DOWNLOAD_PROTOBUF=ON -DLIB_PROTO_MUTATOR_TESTING=OFF -DCMAKE_BUILD_TYPE=Release; \\\n  ninja;\n\nCOPY build.sh $SRC", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Instrument mruby\n(\ncd $SRC/mruby\nexport LD=clang\nexport LDFLAGS=\"$CFLAGS\"\n./minirake clean && ./minirake -j$(nproc) all\n\n# build fuzzers\nFUZZ_TARGET=$SRC/mruby/oss-fuzz/mruby_fuzzer.c\nname=$(basename $FUZZ_TARGET .c)\n$CC -c $CFLAGS -Iinclude \\\n     ${FUZZ_TARGET} -o $OUT/${name}.o\n$CXX $CXXFLAGS $OUT/${name}.o $LIB_FUZZING_ENGINE -lm \\\n    $SRC/mruby/build/host/lib/libmruby.a -o $OUT/${name}\nrm -f $OUT/${name}.o\n)\n\n# Build proto fuzzer: ASan and UBSan\nif [[ $CFLAGS != *sanitize=memory* ]]; then\n    PROTO_FUZZ_TARGET=$SRC/mruby/oss-fuzz/mruby_proto_fuzzer.cpp\n    PROTO_CONVERTER=$SRC/mruby/oss-fuzz/proto_to_ruby.cpp\n    rm -rf genfiles\n    mkdir genfiles\n    LPM/external.protobuf/bin/protoc --proto_path=mruby/oss-fuzz ruby.proto --cpp_out=genfiles\n    $CXX $CXXFLAGS $PROTO_FUZZ_TARGET genfiles/ruby.pb.cc $PROTO_CONVERTER \\\n      -I genfiles -I mruby/oss-fuzz  -I libprotobuf-mutator/ -I .  \\\n      -I LPM/external.protobuf/include \\\n      -I mruby/include -lz -lm \\\n      LPM/src/libfuzzer/libprotobuf-mutator-libfuzzer.a \\\n      LPM/src/libprotobuf-mutator.a \\\n      LPM/external.protobuf/lib/libprotobuf.a \\\n      mruby/build/host/lib/libmruby.a \\\n      $LIB_FUZZING_ENGINE \\\n      -o $OUT/mruby_proto_fuzzer\n\n    # Copy config\n    cp $SRC/mruby/oss-fuzz/config/mruby_proto_fuzzer.options $OUT\nfi\n\n# dict and config\ncp $SRC/mruby/oss-fuzz/config/mruby.dict $OUT\ncp $SRC/mruby/oss-fuzz/config/mruby_fuzzer.options $OUT\n\n# seeds\nzip -rq $OUT/mruby_fuzzer_seed_corpus $SRC/mruby_seeds\n", "work_dir": "/src/mruby", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=18756\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6321459584827392\n\nProject: mruby\nFuzzing Engine: libFuzzer\nFuzz Target: mruby_fuzzer\nJob Type: libfuzzer_msan_mruby\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x000000002a86\nCrash State:\n  str_decref\n  obj_free\n  mrb_gc_destroy\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_mruby&range=201908170330:201908180341\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6321459584827392\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "45aa5081e418423b47a32a06e0515406f63b64d2", "url": "https://github.com/mruby/mruby/commit/45aa5081e418423b47a32a06e0515406f63b64d2"}]}
{"instance_id": "libraw.osv-2022-1078", "repo": "libraw/libraw", "base_commit": "a5376701e4965cae652a5460269b79d769cf2343", "date": "2022-10-27T07:25:52", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config zlib1g-dev\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout a5376701e4965cae652a5460269b79d769cf2343\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=52579\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6381559087497216\n\nProject: libraw\nFuzzing Engine: libFuzzer\nFuzz Target: libraw_cr2_fuzzer\nJob Type: libfuzzer_asan_libraw\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 6\nCrash Address: 0x62d000009e00\nCrash State:\n  LibRaw_buffer_datastream::read\n  LibRaw::read_shorts\n  LibRaw::kodak_thumb_load_raw\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libraw&range=202210190610:202210200607\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6381559087497216\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n#include <fuzzer/FuzzedDataProvider.h>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\nstatic const InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  FuzzedDataProvider fdp(data, size);\n  LibRaw lib_raw;\n\n  for(int i =0; i < 4; i++)\n    lib_raw.output_params_ptr()->aber[i] = fdp.ConsumeFloatingPoint<double>();\n  for(int i =0; i < 4; i++)\n    lib_raw.output_params_ptr()->user_mul[i] = fdp.ConsumeFloatingPoint<float>();\n  for(int i =0; i < 2; i++)\n    lib_raw.output_params_ptr()->gamm[i] = fdp.ConsumeFloatingPoint<double>();\n  lib_raw.output_params_ptr()->bright = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->threshold = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->use_auto_wb = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->output_color = fdp.ConsumeIntegralInRange<int>(0, 6);\n  lib_raw.output_params_ptr()->user_flip = fdp.ConsumeIntegralInRange<int>(0, 7);\n  lib_raw.output_params_ptr()->user_black = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->user_sat = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->auto_bright_thr = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->adjust_maximum_thr = fdp.ConsumeFloatingPointInRange<float>(0.f, 1.f);\n  lib_raw.output_params_ptr()->fbdd_noiserd = fdp.ConsumeIntegralInRange<int>(0, 5);\n\n  std::vector<char> payload = fdp.ConsumeRemainingBytes<char>();\n  int result = lib_raw.open_buffer(payload.data(), payload.size());\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack_thumb();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.raw2image();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n  lib_raw.free_image();\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "63794a2471b426ff4268de6982e8a6f711163e2e", "url": "https://github.com/libraw/libraw/commit/63794a2471b426ff4268de6982e8a6f711163e2e"}]}
{"instance_id": "libavc.osv-2023-1208", "repo": "ittiam-systems/libavc", "base_commit": "82f4e69094b7d6e4200d14ba64ac9937f337710d", "date": "2023-11-24T10:19:34", "project_name": "libavc", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y wget cmake\nRUN git clone https://github.com/ittiam-systems/libavc.git\nRUN git -C libavc checkout 82f4e69094b7d6e4200d14ba64ac9937f337710d\nADD https://storage.googleapis.com/android_media/external/libavc/fuzzer/avc_dec_fuzzer_seed_corpus.zip $SRC/\nCOPY build.sh $SRC/\nWORKDIR libavc", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n# Run the OSS-Fuzz script in the project.\n$SRC/libavc/fuzzer/ossfuzz.sh\n", "work_dir": "/src/libavc", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64438\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5290832835772416\n\nProject: libavc\nFuzzing Engine: honggfuzz\nFuzz Target: svc_dec_fuzzer\nJob Type: honggfuzz_asan_libavc\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE {*}\nCrash Address: 0x61b0000045b0\nCrash State:\n  ih264d_format_convert\n  ih264d_decode_picture_thread\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_libavc&range=202302080604:202302090622\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5290832835772416\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "e49a9150a3b1cfc3fb9097ca02dd042e35226129", "url": "https://github.com/ittiam-systems/libavc.git/commit/e49a9150a3b1cfc3fb9097ca02dd042e35226129"}]}
{"instance_id": "selinux.osv-2021-902", "repo": "selinuxproject/selinux", "base_commit": "e293718f0edf553593b2f0687ea9c1294199f764", "date": "2021-07-06T11:08:11", "project_name": "selinux", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y bison \\\n\tflex \\\n\tgawk \\\n\tgettext \\\n\tmake \\\n\tlibaudit-dev \\\n\tlibbz2-dev \\\n\tlibcap-dev \\\n\tlibcap-ng-dev \\\n\tlibglib2.0-dev \\\n\tlibpcre3-dev \\\n\txmlto\nRUN git clone https://github.com/SELinuxProject/selinux\nRUN git -C selinux checkout e293718f0edf553593b2f0687ea9c1294199f764\nWORKDIR selinux\nCOPY build.sh *.c $SRC/", "build_sh": "#!/bin/bash -e\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nexport DESTDIR=$(pwd)/DESTDIR\nexport LDFLAGS=\"${LDFLAGS:-} $CFLAGS\"\n\nfind -name Makefile | xargs sed -i 's/,-z,defs//'\nmake V=1 -j$(nproc) install\n\n$CC $CFLAGS -I$DESTDIR/usr/include -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64 -c -o secilc-fuzzer.o $SRC/secilc-fuzzer.c\n$CXX $CXXFLAGS $LIB_FUZZING_ENGINE secilc-fuzzer.o $DESTDIR/usr/lib/libsepol.a -o $OUT/secilc-fuzzer\nzip -r $OUT/secilc-fuzzer_seed_corpus.zip secilc/test\n", "work_dir": "/src/selinux", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=35553\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6034092813582336\n\nProject: selinux\nFuzzing Engine: libFuzzer\nFuzz Target: secilc-fuzzer\nJob Type: libfuzzer_asan_selinux\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 8\nCrash Address: 0x7f22f2fda7f0\nCrash State:\n  ebitmap_match_any\n  avtab_map\n  cil_check_neverallow\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_selinux&range=202106241200:202106241800\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6034092813582336\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "secilc-fuzzer.c", "content": "/*\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n*/\n\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <string.h>\n#include <getopt.h>\n#include <sys/stat.h>\n\n#include <sepol/cil/cil.h>\n#include <sepol/policydb.h>\n\nint LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n\tenum cil_log_level log_level = CIL_ERR;\n\tstruct sepol_policy_file *pf = NULL;\n\tFILE *dev_null = NULL;\n\tint target = SEPOL_TARGET_SELINUX;\n\tint disable_dontaudit = 0;\n\tint multiple_decls = 0;\n\tint disable_neverallow = 0;\n\tint preserve_tunables = 0;\n\tint policyvers = POLICYDB_VERSION_MAX;\n\tint mls = -1;\n\tint attrs_expand_generated = 0;\n\tstruct cil_db *db = NULL;\n\tsepol_policydb_t *pdb = NULL;\n\n\tcil_set_log_level(log_level);\n\n\tcil_db_init(&db);\n\tcil_set_disable_dontaudit(db, disable_dontaudit);\n\tcil_set_multiple_decls(db, multiple_decls);\n\tcil_set_disable_neverallow(db, disable_neverallow);\n\tcil_set_preserve_tunables(db, preserve_tunables);\n\tcil_set_mls(db, mls);\n\tcil_set_target_platform(db, target);\n\tcil_set_policy_version(db, policyvers);\n\tcil_set_attrs_expand_generated(db, attrs_expand_generated);\n\n\tif (cil_add_file(db, \"fuzz\", data, size) != SEPOL_OK)\n\t\tgoto exit;\n\n\tif (cil_compile(db) != SEPOL_OK)\n\t\tgoto exit;\n\n\tif (cil_build_policydb(db, &pdb) != SEPOL_OK)\n\t\tgoto exit;\n\n\tif (sepol_policydb_optimize(pdb) != SEPOL_OK)\n\t\tgoto exit;\n\n\tdev_null = fopen(\"/dev/null\", \"w\");\n\tif (dev_null == NULL)\n\t\tgoto exit;\n\n\tif (sepol_policy_file_create(&pf) != 0)\n\t\tgoto exit;\n\n\tsepol_policy_file_set_fp(pf, dev_null);\n\n\tif (sepol_policydb_write(pdb, pf) != 0)\n\t\tgoto exit;\nexit:\n\tif (dev_null != NULL)\n\t\tfclose(dev_null);\n\n\tcil_db_destroy(&db);\n\tsepol_policydb_free(pdb);\n\tsepol_policy_file_free(pf);\n\treturn 0;\n}\n"}], "candidate_fixes": [{"sha": "9af91692416d01814f4b2ac22e39d3b57993af4f", "url": "https://github.com/SELinuxProject/selinux/commit/9af91692416d01814f4b2ac22e39d3b57993af4f"}]}
{"instance_id": "harfbuzz.osv-2023-458", "repo": "harfbuzz/harfbuzz", "base_commit": "3dd1de46d637f36bc30bbd7dd8be3a058d1f1864", "date": "2023-06-04T11:15:14", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y python3-pip ragel pkg-config && \\\n    pip3 install meson==0.56.0 ninja\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 3dd1de46d637f36bc30bbd7dd8be3a058d1f1864\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\n\n# setup\nbuild=$WORK/build\n\n# cleanup\nrm -rf $build\nmkdir -p $build\n\n# Build the library.\nmeson --default-library=static --wrap-mode=nodownload \\\n      -Dexperimental_api=true \\\n      -Dfuzzer_ldflags=\"$(echo $LIB_FUZZING_ENGINE)\" \\\n      $build \\\n  || (cat build/meson-logs/meson-log.txt && false)\n\n# Build the fuzzers.\nninja -v -j$(nproc) -C $build test/fuzzing/hb-{shape,draw,repacker,subset,set}-fuzzer\nmv $build/test/fuzzing/hb-{shape,draw,repacker,subset,set}-fuzzer $OUT/\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shape/data/in-house/fonts \\\n\ttest/shape/data/aots/fonts \\\n\ttest/shape/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\tperf/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\n\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-draw-fuzzer_seed_corpus.zip\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\nzip $OUT/hb-set-fuzzer_seed_corpus.zip ./test/fuzzing/sets/*\nzip $OUT/hb-repacker-fuzzer_seed_corpus.zip ./test/fuzzing/graphs/*\n\n", "work_dir": "/src/harfbuzz", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=59592\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5855710991482880\n\nProject: harfbuzz\nFuzzing Engine: honggfuzz\nFuzz Target: hb-subset-fuzzer\nJob Type: honggfuzz_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Invalid-free\nCrash Address: 0x619000000814\nCrash State:\n  hb_free_impl\n  OT::glyf::_free_compiled_subset_glyphs\n  OT::glyf::subset\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_harfbuzz&range=202306030623:202306040615\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5855710991482880\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "hb-draw-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-repacker-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-set-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "af3fdf1f9e09fb7e47d4528d81fd510730b80745", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/af3fdf1f9e09fb7e47d4528d81fd510730b80745"}]}
{"instance_id": "espeak-ng.osv-2021-810", "repo": "espeak-ng/espeak-ng", "base_commit": "43d07abec4abf07cc536e4fcf13088508231da76", "date": "2022-03-11T11:31:53", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout 43d07abec4abf07cc536e4fcf13088508231da76\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=34747\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4646816825081856\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Global-buffer-overflow READ 2\nCrash Address: 0x00000125b464\nCrash State:\n  SubstitutePhonemes\n  MakePhonemeList\n  TranslateClause\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202105130601:202105140612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4646816825081856\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "7f1222c6ad6a3652be35afbbc980a382076ff0a9", "url": "https://github.com/espeak-ng/espeak-ng/commit/7f1222c6ad6a3652be35afbbc980a382076ff0a9"}]}
{"instance_id": "jsoncons.osv-2021-703", "repo": "danielaparker/jsoncons", "base_commit": "b453dc0b9204685c9058f0000639c2764961aba6", "date": "2021-04-28T05:59:52", "project_name": "jsoncons", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make cmake\nRUN git clone https://github.com/danielaparker/jsoncons\nRUN git -C jsoncons checkout b453dc0b9204685c9058f0000639c2764961aba6\n\nWORKDIR $SRC\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\ncd jsoncons/fuzzers\n\n# Ensure script is executable\nchmod +x ./build_fuzzers.sh\n./build_fuzzers.sh\n", "work_dir": "/src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=33781\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5639543840702464\n\nProject: jsoncons\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz_json_encoder\nJob Type: libfuzzer_asan_jsoncons\nPlatform Id: linux\n\nCrash Type: Container-overflow READ 1\nCrash Address: 0x62900000021d\nCrash State:\n  unsigned long jsoncons::detail::escape_string<char, jsoncons::string_sink<std::_\n  jsoncons::basic_json_encoder<char, jsoncons::string_sink<std::__1::basic_string<\n  jsoncons::basic_json_visitor<char>::key\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_jsoncons&range=202104270619:202104280604\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5639543840702464\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "e0ee905e3e2f2997606f146370af6a5d448aafe5", "url": "https://github.com/danielaparker/jsoncons/commit/e0ee905e3e2f2997606f146370af6a5d448aafe5"}]}
{"instance_id": "libraw.osv-2022-1107", "repo": "libraw/libraw", "base_commit": "a5376701e4965cae652a5460269b79d769cf2343", "date": "2022-10-27T07:25:52", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config zlib1g-dev\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout a5376701e4965cae652a5460269b79d769cf2343\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=52802\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4732608429031424\n\nProject: libraw\nFuzzing Engine: libFuzzer\nFuzz Target: libraw_nef_fuzzer\nJob Type: libfuzzer_asan_libraw\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 2\nCrash Address: 0x63300001b780\nCrash State:\n  LibRaw::kodak_rgb_load_raw\n  LibRaw::kodak_thumb_loader\n  LibRaw::unpack_thumb\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libraw&range=202210190610:202210200607\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4732608429031424\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n#include <fuzzer/FuzzedDataProvider.h>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\nstatic const InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  FuzzedDataProvider fdp(data, size);\n  LibRaw lib_raw;\n\n  for(int i =0; i < 4; i++)\n    lib_raw.output_params_ptr()->aber[i] = fdp.ConsumeFloatingPoint<double>();\n  for(int i =0; i < 4; i++)\n    lib_raw.output_params_ptr()->user_mul[i] = fdp.ConsumeFloatingPoint<float>();\n  for(int i =0; i < 2; i++)\n    lib_raw.output_params_ptr()->gamm[i] = fdp.ConsumeFloatingPoint<double>();\n  lib_raw.output_params_ptr()->bright = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->threshold = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->use_auto_wb = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->output_color = fdp.ConsumeIntegralInRange<int>(0, 6);\n  lib_raw.output_params_ptr()->user_flip = fdp.ConsumeIntegralInRange<int>(0, 7);\n  lib_raw.output_params_ptr()->user_black = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->user_sat = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->auto_bright_thr = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->adjust_maximum_thr = fdp.ConsumeFloatingPointInRange<float>(0.f, 1.f);\n  lib_raw.output_params_ptr()->fbdd_noiserd = fdp.ConsumeIntegralInRange<int>(0, 5);\n\n  std::vector<char> payload = fdp.ConsumeRemainingBytes<char>();\n  int result = lib_raw.open_buffer(payload.data(), payload.size());\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack_thumb();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.raw2image();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n  lib_raw.free_image();\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "63794a2471b426ff4268de6982e8a6f711163e2e", "url": "https://github.com/libraw/libraw/commit/63794a2471b426ff4268de6982e8a6f711163e2e"}]}
{"instance_id": "libexif.osv-2021-1152", "repo": "libexif/libexif", "base_commit": "ead49aedb49015b4095c0d43f1f9ce913791eb52", "date": "2021-08-17T09:54:33", "project_name": "libexif", "lang": "c++", "dockerfile": "# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool gettext autopoint\nRUN git clone https://github.com/libexif/libexif\nRUN git -C libexif checkout ead49aedb49015b4095c0d43f1f9ce913791eb52\nRUN git clone --depth 1 https://github.com/ianare/exif-samples\nWORKDIR libexif\nCOPY exif_loader_fuzzer.cc exif_from_data_fuzzer.cc build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nautoreconf -fiv\n./configure --disable-docs --enable-shared=no --prefix=\"$WORK\"\nmake -j$(nproc)\nmake install\n\npushd $SRC\nmkdir -p exif_corpus\nfind exif-samples -type f -name '*.jpg' -exec mv -n {} exif_corpus/ \\; -o -name '*.tiff' -exec mv -n {} exif_corpus/ \\;\ncp libexif/test/testdata/*.jpg exif_corpus\nzip -r \"$WORK/exif_seed_corpus.zip\" exif_corpus/\npopd\n\nfor fuzzer in $(find $SRC/ -name '*_fuzzer.cc'); do\n  fuzzer_basename=$(basename -s .cc $fuzzer)\n  $CXX $CXXFLAGS \\\n      -std=c++11 \\\n      -I\"$WORK/include\" \\\n      $fuzzer \\\n      -o $OUT/$fuzzer_basename \\\n      $LIB_FUZZING_ENGINE \\\n      \"$WORK/lib/libexif.a\"\n  cp $WORK/exif_seed_corpus.zip \"${OUT}/${fuzzer_basename}_seed_corpus.zip\"\ndone\n", "work_dir": "/src/libexif", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37334\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4900628550778880\n\nProject: libexif\nFuzzing Engine: libFuzzer\nFuzz Target: exif_loader_fuzzer\nJob Type: libfuzzer_asan_libexif\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x6311000007ff\nCrash State:\n  exif_mnote_data_apple_load\n  exif_mnote_data_load\n  interpret_maker_note\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libexif&range=202108150609:202108160616\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4900628550778880\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "exif_from_data_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <libexif/exif-data.h>\n#include <libexif/exif-loader.h>\n#include <stddef.h>\n#include <stdlib.h>\n\n/* Extract all MakerNote tags */\nstatic void mnote_dump(ExifData *data) {\n    ExifMnoteData *mn = exif_data_get_mnote_data(data);\n    if (mn) {\n        int num = exif_mnote_data_count(mn);\n\n        /* Loop through all MakerNote tags */\n        for (int i=0; i < num; ++i) {\n            char buf[1024];\n            exif_mnote_data_get_value(mn, i, buf, sizeof(buf));\n        }\n    }\n}\n\nstatic void dump_value(ExifEntry *entry, void *user_data) {\n  char buf[1024];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nstatic void data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, dump_value, NULL);\n}\n\n/* This is like exif_data_dump but without writing to stdout */\nstatic void data_dump(ExifData *data) {\n  exif_data_foreach_content(data, data_func, NULL);\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n\n  // Parse tags using (ultimately) exif_data_load_data()\n  auto image = exif_data_new_from_data(data, size);\n  if (image) {\n    // Exercise the EXIF tag manipulation code\n    exif_data_get_mnote_data(image);\n    data_dump(image);\n    mnote_dump(image);\n    unsigned char *buf;\n    unsigned int sz;\n    exif_data_save_data(image, &buf, &sz);\n    free(buf);\n    exif_data_fix(image);\n    exif_data_unref(image);\n  }\n\n  return 0;\n}\n"}, {"filename": "exif_loader_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stdio.h>\n#include <stdint.h>\n#include <libexif/exif-loader.h>\n\n\nvoid content_func(ExifEntry *entry, void *user_data) {\n  char buf[10000];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nvoid data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, content_func, NULL);\n}\n\nstatic void\ntest_exif_data (ExifData *d) {\n  unsigned int i, c;\n  char v[1024], *p;\n  ExifMnoteData *md;\n\n  md = exif_data_get_mnote_data (d);\n  if (!md) {\n    return;\n  }\n\n  exif_mnote_data_ref (md);\n  exif_mnote_data_unref (md);\n\n  c = exif_mnote_data_count (md);\n  for (i = 0; i < c; i++) {\n    const char *name = exif_mnote_data_get_name (md, i);\n    if (!name) {\n      break;\n    }\n    exif_mnote_data_get_title (md, i);\n    exif_mnote_data_get_description (md, i);\n    exif_mnote_data_get_value (md, i, v, sizeof (v));\n  }\n}\n\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  ExifLoader *loader = exif_loader_new();\n  ExifData *exif_data;\n  if (!loader) {\n    return 0;\n  }\n  exif_loader_write(loader, const_cast<unsigned char*>(data), size);\n  exif_data = exif_loader_get_data(loader);\n  if(!exif_data) {\n    exif_loader_unref(loader);\n    return 0;\n  }\n  exif_data_foreach_content(exif_data, data_func, NULL);\n  test_exif_data (exif_data);\n  exif_loader_unref(loader);\n  exif_data_unref(exif_data);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "d61e9aaddf4f8af5aecea4935f8feb59f42141c1", "url": "https://github.com/libexif/libexif/commit/d61e9aaddf4f8af5aecea4935f8feb59f42141c1"}]}
{"instance_id": "harfbuzz.osv-2020-484", "repo": "harfbuzz/harfbuzz", "base_commit": "6879efc2c1596d11a6a6ad296f80063b558d5e0f", "date": "2019-01-17T14:08:02", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 6879efc2c1596d11a6a6ad296f80063b558d5e0f\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr\"\n\n# Build the library.\n./autogen.sh\n./configure --enable-static --disable-shared\nmake clean\nmake -j$(nproc) CPPFLAGS=\"-DHB_NO_VISIBILITY\" V=1 all\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset.a ./src/.libs/libharfbuzz.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shaping/data/in-house/fonts \\\n\ttest/shaping/data/aots/fonts \\\n\ttest/shaping/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=12532\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5667182741028864\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x614000000fc7\nCrash State:\n  AAT::KerxSubTableFormat4<AAT::KerxSubTableHeader>::driver_context_t::transition\n  void AAT::StateTableDriver<AAT::ExtendedTypes, AAT::KerxSubTableFormat4<AAT::Ker\n  AAT::KerxSubTableFormat4<AAT::KerxSubTableHeader>::apply\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201811250219:201811260219\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5667182741028864\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "cc8e9a436fa408a1c63f4b9afb7643cea76a079c", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/cc8e9a436fa408a1c63f4b9afb7643cea76a079c"}]}
{"instance_id": "openjpeg.osv-2017-35", "repo": "uclouvain/openjpeg", "base_commit": "8f92fc97913bec7ffa2dc10d062c0cdd19da20e4", "date": "2017-08-28T08:57:49", "project_name": "openjpeg", "lang": "c++", "dockerfile": "# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER antonin@gmail.com\nRUN apt-get update && apt-get install -y make cmake g++\nRUN git clone https://github.com/uclouvain/openjpeg openjpeg\nRUN git -C openjpeg checkout 8f92fc97913bec7ffa2dc10d062c0cdd19da20e4\n# openjpeg-data is used to create a seed corpus\nRUN git clone --depth 1 https://github.com/uclouvain/openjpeg-data openjpeg/data\nWORKDIR openjpeg\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir build\ncd build\ncmake ..\nmake clean -s\nmake -j$(nproc) -s\ncd ..\n\n./tests/fuzzers/build_google_oss_fuzzers.sh\n./tests/fuzzers/build_seed_corpus.sh\n", "work_dir": "/src/openjpeg", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3125\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=4591818438082560\n\nProject: openjpeg\nFuzzer: libFuzzer_openjpeg_opj_decompress_fuzzer\nFuzz target binary: opj_decompress_fuzzer\nJob Type: libfuzzer_asan_openjpeg\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ {*}\nCrash Address: 0x6100000005e0\nCrash State:\n  opj_dwt_decode_partial_tile\n  opj_tcd_dwt_decode\n  opj_tcd_decode_tile\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_openjpeg&range=201708210414:201708220124\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4591818438082560\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you have questions for the OSS-Fuzz team, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [], "candidate_fixes": [{"sha": "a55c024fc6b917a409b85aeafd7326421c4aea34", "url": "https://github.com/uclouvain/openjpeg/commit/a55c024fc6b917a409b85aeafd7326421c4aea34"}]}
{"instance_id": "libraw.osv-2023-90", "repo": "libraw/libraw", "base_commit": "3e62ed30427672e043c4480fe540545191f4b916", "date": "2023-02-17T01:11:02", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config zlib1g-dev\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout 3e62ed30427672e043c4480fe540545191f4b916\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=56160\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5081846951313408\n\nProject: libraw\nFuzzing Engine: honggfuzz\nFuzz Target: libraw_cr2_fuzzer\nJob Type: honggfuzz_asan_libraw\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x6070000000d7\nCrash State:\n  LibRaw_buffer_datastream::scanf_one\n  LibRaw::parse_mos\n  LibRaw::parse_tiff_ifd\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_libraw&range=202203300603:202203310600\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5081846951313408\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n#include <fuzzer/FuzzedDataProvider.h>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\nstatic const InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  FuzzedDataProvider fdp(data, size);\n  LibRaw lib_raw;\n\n  for(int i =0; i < 4; i++)\n    lib_raw.output_params_ptr()->aber[i] = fdp.ConsumeFloatingPoint<double>();\n  for(int i =0; i < 4; i++)\n    lib_raw.output_params_ptr()->user_mul[i] = fdp.ConsumeFloatingPoint<float>();\n  for(int i =0; i < 2; i++)\n    lib_raw.output_params_ptr()->gamm[i] = fdp.ConsumeFloatingPoint<double>();\n  lib_raw.output_params_ptr()->bright = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->threshold = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->use_auto_wb = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->output_color = fdp.ConsumeIntegralInRange<int>(0, 6);\n  lib_raw.output_params_ptr()->user_flip = fdp.ConsumeIntegralInRange<int>(0, 7);\n  lib_raw.output_params_ptr()->user_black = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->user_sat = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->auto_bright_thr = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->adjust_maximum_thr = fdp.ConsumeFloatingPointInRange<float>(0.f, 1.f);\n  lib_raw.output_params_ptr()->fbdd_noiserd = fdp.ConsumeIntegralInRange<int>(0, 5);\n\n  std::vector<char> payload = fdp.ConsumeRemainingBytes<char>();\n  int result = lib_raw.open_buffer(payload.data(), payload.size());\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack_thumb();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.raw2image();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n  lib_raw.free_image();\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "f6a57cfb81561bb9a3bd884795896a61f65ba29e", "url": "https://github.com/libraw/libraw/commit/f6a57cfb81561bb9a3bd884795896a61f65ba29e"}]}
{"instance_id": "harfbuzz.osv-2018-159", "repo": "harfbuzz/harfbuzz", "base_commit": "55d5ea666c25f75e9b1bc2eb43cfb104a16ebe04", "date": "2018-10-15T14:05:10", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 55d5ea666c25f75e9b1bc2eb43cfb104a16ebe04\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=function,vptr\"\n\n# Build the library.\n./autogen.sh\n./configure\nmake clean\nmake -j$(nproc) V=1 all\nmake CPPFLAGS=\"-DHB_NO_VISIBILITY\" -C src V=1 fuzzing\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-fuzzing.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset-fuzzing.a ./src/.libs/libharfbuzz-fuzzing.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nzip -j -r $OUT/hb-shape-fuzzer_seed_corpus.zip $SRC/harfbuzz/test/shaping/data/in-house/fonts $SRC/harfbuzz/test/shaping/data/text-rendering-tests/fonts $SRC/harfbuzz/test/api/fonts\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=10953\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5725129603022848\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_msan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Use-of-uninitialized-value\nCrash Address:\nCrash State:\n  AAT::LookupFormat8<OT::IntType<unsigned short, 2u> >::get_value\n  AAT::Lookup<OT::IntType<unsigned short, 2u> >::get_value\n  AAT::StateTable<AAT::InsertionSubtable::EntryData>::get_class\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_harfbuzz&range=201810040141:201810050142\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5725129603022848\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "0f85edb7781f4d5ec2de676979be75a0f6559d80", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/0f85edb7781f4d5ec2de676979be75a0f6559d80"}]}
{"instance_id": "libavc.osv-2023-86", "repo": "ittiam-systems/libavc", "base_commit": "992407f6c3e77c9ff84684c77072b913eaa3152b", "date": "2023-02-16T13:07:46", "project_name": "libavc", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y wget cmake\nRUN git clone https://github.com/ittiam-systems/libavc.git\nRUN git -C libavc checkout 992407f6c3e77c9ff84684c77072b913eaa3152b\nADD https://storage.googleapis.com/android_media/external/libavc/fuzzer/avc_dec_fuzzer_seed_corpus.zip $SRC/\nCOPY build.sh $SRC/\nWORKDIR libavc", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n# Run the OSS-Fuzz script in the project.\n$SRC/libavc/fuzzer/ossfuzz.sh\n", "work_dir": "/src/libavc", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=56137\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4919084669337600\n\nProject: libavc\nFuzzing Engine: libFuzzer\nFuzz Target: svc_enc_fuzzer\nJob Type: libfuzzer_asan_libavc\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x61d10000647f\nCrash State:\n  isvce_cabac_flush\n  isvce_cabac_encode_terminate\n  isvce_entropy\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libavc&range=202302010608:202302020603\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4919084669337600\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "c38af025abf0040f6693d15f4ce2e878a728cfee", "url": "https://github.com/ittiam-systems/libavc.git/commit/c38af025abf0040f6693d15f4ce2e878a728cfee"}]}
{"instance_id": "php.osv-2021-1670", "repo": "php/php-src", "base_commit": "9c6b843ff0f4b7af926a69ef89d7f9ec1db31866", "date": "2021-12-07T14:26:19", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 9c6b843ff0f4b7af926a69ef89d7f9ec1db31866\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=42156\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4681290541039616\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-parser\nJob Type: libfuzzer_asan_i386_php\nPlatform Id: linux\n\nCrash Type: Dynamic-stack-buffer-overflow READ 4\nCrash Address: 0xffdcb0e8\nCrash State:\n  zend_calc_live_ranges\n  pass_two\n  zend_compile_func_decl\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_i386_php&range=202112020608:202112090606\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4681290541039616\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "91734fc5795bc07dc718f9d884a014a90097e56f", "url": "https://github.com/php/php-src.git/commit/91734fc5795bc07dc718f9d884a014a90097e56f"}]}
{"instance_id": "icu.osv-2020-867", "repo": "unicode-org/icu", "base_commit": "f4f74c1f2ee380c20434f224d7fea05fdb4e91d6", "date": "2022-03-31T19:39:13", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout f4f74c1f2ee380c20434f224d7fea05fdb4e91d6\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=15613\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5695958395912192\n\nProject: icu\nFuzzer: libFuzzer_icu_collator_rulebased_fuzzer\nFuzz target binary: collator_rulebased_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x614000010698\nCrash State:\n  icu_64::CollationIterator::appendCEsFromCE32\n  icu_64::DataBuilderCollationIterator::fetchCEs\n  icu_64::CollationDataBuilder::getCEs\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=201906250235:201906260234\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5695958395912192\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "4833cc89b2fae2e8863b46bf1dc785964847e882", "url": "https://github.com/unicode-org/icu.git/commit/4833cc89b2fae2e8863b46bf1dc785964847e882"}]}
{"instance_id": "libxaac.osv-2023-839", "repo": "ittiam-systems/libxaac", "base_commit": "f48c9bea6406028f4599306e609f60bb8a022374", "date": "2023-09-29T08:38:43", "project_name": "libxaac", "lang": "c++", "dockerfile": "# Copyright 2023 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y wget cmake\nRUN git clone https://github.com/ittiam-systems/libxaac.git\nRUN git -C libxaac checkout f48c9bea6406028f4599306e609f60bb8a022374\nADD https://storage.googleapis.com/android_media/external/libxaac/fuzzer/xaac_dec_fuzzer_seed_corpus.zip $SRC/\nCOPY build.sh $SRC/\nWORKDIR libxaac", "build_sh": "#!/bin/bash -eu\n# Copyright 2023 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n# Run the OSS-Fuzz script in the project.\n$SRC/libxaac/fuzzer/ossfuzz.sh\n", "work_dir": "/src/libxaac", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62261\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5693649469702144\n\nProject: libxaac\nFuzzing Engine: libFuzzer\nFuzz Target: xaac_enc_fuzzer\nJob Type: libfuzzer_asan_i386_libxaac\nPlatform Id: linux\n\nCrash Type: Global-buffer-overflow READ 4\nCrash Address: 0x0860f544\nCrash State:\n  iusace_quantize_lines\n  iusace_quantize_spec\n  iusace_fd_encode\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_i386_libxaac&range=202309010608:202309020611\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5693649469702144\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "56716426e2087e604ee6267129857b409e53ab09", "url": "https://github.com/ittiam-systems/libxaac.git/commit/56716426e2087e604ee6267129857b409e53ab09"}]}
{"instance_id": "php.osv-2022-87", "repo": "php/php-src", "base_commit": "2af33234b27ebc6430397ab45be952208c02b466", "date": "2022-01-28T04:18:57", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 2af33234b27ebc6430397ab45be952208c02b466\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43988\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6518655133810688\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-function-jit\nJob Type: libfuzzer_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 8\nCrash Address: 0x6040000284b0\nCrash State:\n  zend_std_get_property_ptr_ptr\n  zend_fetch_property_address\n  ZEND_FETCH_OBJ_W_SPEC_CV_CONST_HANDLER\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_php&range=202111260600:202111270607\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6518655133810688\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "f1ae13509f23a639bd47b4035e6bf74c68cef752", "url": "https://github.com/php/php-src.git/commit/f1ae13509f23a639bd47b4035e6bf74c68cef752"}]}
{"instance_id": "php.osv-2020-1683", "repo": "php/php-src", "base_commit": "397a692735b295566aab947d979013247385f6db", "date": "2020-09-03T05:19:11", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 397a692735b295566aab947d979013247385f6db\nRUN git clone https://github.com/kkos/oniguruma.git php-src/oniguruma\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build oniguruma and link statically\npushd oniguruma\nautoreconf -vfi\n./configure\nmake -j$(nproc)\npopd\nexport ONIG_CFLAGS=\"-I$PWD/oniguruma/src\"\nexport ONIG_LIBS=\"-L$PWD/oniguruma/src/.libs -l:libonig.a\"\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# build project\n./buildconf\n./configure \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-mbstring \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-mbstring\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=25321\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5758025133195264\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-execute\nJob Type: libfuzzer_asan_i386_php\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0xbebebebe\nCrash State:\n  zend_gc_delref\n  zval_delref_p\n  zval_ptr_dtor_nogc\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_i386_php&range=202008280605:202008290628\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5758025133195264\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "c4016ecd446ef26bb3dc77735b6e441e151ea985", "url": "https://github.com/php/php-src.git/commit/c4016ecd446ef26bb3dc77735b6e441e151ea985"}]}
{"instance_id": "flatbuffers.osv-2021-349", "repo": "google/flatbuffers", "base_commit": "6f3e45eca1fde7a68cb72fd4499a3647f719c9db", "date": "2021-02-07T16:51:33", "project_name": "flatbuffers", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make cmake ninja\nRUN git clone https://github.com/google/flatbuffers\nRUN git -C flatbuffers checkout 6f3e45eca1fde7a68cb72fd4499a3647f719c9db\n\nWORKDIR $SRC/\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n  \ncd $SRC/flatbuffers\nmkdir build\ncd build\ncmake -DOSS_FUZZ:BOOL=ON -G \"Unix Makefiles\" ../tests/fuzzer\nmake\n\ncp ../tests/fuzzer/*.dict $OUT/\ncp *.bfbs $OUT/\ncp *_fuzzer $OUT/\n", "work_dir": "/src/", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=30684\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5700135017381888\n\nProject: flatbuffers\nFuzzing Engine: libFuzzer\nFuzz Target: parser_fuzzer\nJob Type: libfuzzer_asan_flatbuffers\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 1\nCrash Address: 0x602000000194\nCrash State:\n  flatbuffers::vector_downward::fill\n  flatbuffers::FlatBufferBuilder::PreAlign\n  flatbuffers::FlatBufferBuilder::ForceVectorAlignment\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_flatbuffers&range=202102070618:202102080601\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5700135017381888\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "fee095410b0969765b5c2545c10e585f69e961b0", "url": "https://github.com/google/flatbuffers/commit/fee095410b0969765b5c2545c10e585f69e961b0"}]}
{"instance_id": "harfbuzz.osv-2021-1518", "repo": "harfbuzz/harfbuzz", "base_commit": "364b6b3989e9df6335711e282e3250534d88299a", "date": "2021-11-02T18:15:02", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y python3-pip ragel pkg-config && \\\n    pip3 install meson==0.53.0 ninja\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 364b6b3989e9df6335711e282e3250534d88299a\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\n\n# setup\nbuild=$WORK/build\n\n# cleanup\nrm -rf $build\nmkdir -p $build\n\n# Build the library.\nmeson --default-library=static --wrap-mode=nodownload \\\n      -Dexperimental_api=true \\\n      -Dfuzzer_ldflags=\"$(echo $LIB_FUZZING_ENGINE)\" \\\n      $build \\\n  || (cat build/meson-logs/meson-log.txt && false)\n\n# Build the fuzzers.\nninja -v -j$(nproc) -C $build test/fuzzing/hb-{shape,draw,subset,set}-fuzzer\nmv $build/test/fuzzing/hb-{shape,draw,subset,set}-fuzzer $OUT/\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shape/data/in-house/fonts \\\n\ttest/shape/data/aots/fonts \\\n\ttest/shape/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\tperf/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-draw-fuzzer_seed_corpus.zip\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\nzip $OUT/hb-set-fuzzer_seed_corpus.zip ./test/fuzzing/sets/*\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40540\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6254792024915968\n\nProject: harfbuzz\nFuzzing Engine: libFuzzer\nFuzz Target: hb-subset-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x62a00101714b\nCrash State:\n  bool OT::OffsetTo<OT::ClipBox, OT::IntType<unsigned int, 3u>, true>::serialize_c\n  OT::ClipList::serialize_clip_records\n  OT::ClipList::subset\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=202110230613:202110240605\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6254792024915968\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "hb-draw-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-set-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "0a7563a53ffedd735cb41c03f697269ef48f0ec2", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/0a7563a53ffedd735cb41c03f697269ef48f0ec2"}]}
{"instance_id": "icu.osv-2021-1236", "repo": "unicode-org/icu", "base_commit": "f4f74c1f2ee380c20434f224d7fea05fdb4e91d6", "date": "2022-03-31T19:39:13", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout f4f74c1f2ee380c20434f224d7fea05fdb4e91d6\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=38390\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5448661421654016\n\nProject: icu\nFuzzing Engine: libFuzzer\nFuzz Target: collator_rulebased_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x7f26c3fa77e0\nCrash State:\n  icu_70::UCharsTrie::branchNext\n  icu_70::UCharsTrie::firstForCodePoint\n  icu_70::CollationIterator::nextCE32FromContraction\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=202109090608:202109100613\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5448661421654016\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "4833cc89b2fae2e8863b46bf1dc785964847e882", "url": "https://github.com/unicode-org/icu.git/commit/4833cc89b2fae2e8863b46bf1dc785964847e882"}]}
{"instance_id": "bloaty.osv-2018-134", "repo": "google/bloaty", "base_commit": "a950a61921c3aaaf31e27fad1727a1ddf528df1e", "date": "2018-02-19T16:29:23", "project_name": "bloaty", "lang": "c++", "dockerfile": "# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER jhaberman@gmail.com\nRUN apt-get update && apt-get install -y cmake ninja-build g++\nRUN git clone https://github.com/google/bloaty.git bloaty\nRUN git -C bloaty checkout a950a61921c3aaaf31e27fad1727a1ddf528df1e\nWORKDIR bloaty\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\ncd $WORK\ncmake -G Ninja -DBUILD_TESTING=false $SRC/bloaty\nninja -j$(nproc)\ncp fuzz_target $OUT\nzip -j $OUT/fuzz_target_seed_corpus.zip $SRC/bloaty/tests/testdata/fuzz_corpus/*\n", "work_dir": "/src/bloaty", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=5873\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5703202205859840\n\nProject: bloaty\nFuzzer: libFuzzer_bloaty_fuzz_target\nFuzz target binary: fuzz_target\nJob Type: libfuzzer_asan_bloaty\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x61b000000d80\nCrash State:\n  bloaty::DisassembleFindReferences\n  bloaty::ReadELFSymbols\n  bloaty::ReadELFSymbols\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_bloaty&range=201801250543:201801260542\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5703202205859840\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you have questions for the OSS-Fuzz team, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [], "candidate_fixes": [{"sha": "18384d6c6cbb666d08d08c0dabc4a0d1b7623f6f", "url": "https://github.com/google/bloaty.git/commit/18384d6c6cbb666d08d08c0dabc4a0d1b7623f6f"}]}
{"instance_id": "simdutf.osv-2024-1043", "repo": "simdutf/simdutf", "base_commit": "c87a4a14591703f92f7c48c987bd9322a1e27737", "date": "2024-08-19T15:38:27", "project_name": "simdutf", "lang": "c++", "dockerfile": "# Copyright 2023 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make cmake\nRUN git clone https://github.com/simdutf/simdutf simdutf\nRUN git -C simdutf checkout c87a4a14591703f92f7c48c987bd9322a1e27737\nWORKDIR simdutf\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2024 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nfuzz/build.sh\n", "work_dir": "/src/simdutf", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=71307\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6249684870430720\n\nProject: simdutf\nFuzzing Engine: libFuzzer\nFuzz Target: conversion\nJob Type: libfuzzer_asan_simdutf\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE {*}\nCrash Address: 0x5190000018a1\nCrash State:\n  simdutf::haswell::implementation::convert_utf8_to_latin1\n  Conversion<\n  Conversion<\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_simdutf&range=202408120618:202408130625\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6249684870430720\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "522758e534b731acf43daa91dbaaea91b875acf3", "url": "https://github.com/simdutf/simdutf/commit/522758e534b731acf43daa91dbaaea91b875acf3"}]}
{"instance_id": "php.osv-2020-1787", "repo": "php/php-src", "base_commit": "3b2410ebf6216733410b3d12566ffba3a99519c7", "date": "2020-09-16T04:06:19", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 3b2410ebf6216733410b3d12566ffba3a99519c7\nRUN git clone https://github.com/kkos/oniguruma.git php-src/oniguruma\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build oniguruma and link statically\npushd oniguruma\nautoreconf -vfi\n./configure\nmake -j$(nproc)\npopd\nexport ONIG_CFLAGS=\"-I$PWD/oniguruma/src\"\nexport ONIG_LIBS=\"-L$PWD/oniguruma/src/.libs -l:libonig.a\"\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# build project\n./buildconf\n./configure \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-mbstring \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-mbstring\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=25678\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5146486399303680\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-execute\nJob Type: libfuzzer_msan_php\nPlatform Id: linux\n\nCrash Type: Use-of-uninitialized-value\nCrash Address:\nCrash State:\n  zend_generator_search_multi_children_node\n  zend_generator_add_child\n  zend_generator_yield_from\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_php&range=202008280605:202008290628\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5146486399303680\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "392f0abf687c7519ba02d7d41b9622f0b3d1a8e2", "url": "https://github.com/php/php-src.git/commit/392f0abf687c7519ba02d7d41b9622f0b3d1a8e2"}]}
{"instance_id": "libraw.osv-2020-1417", "repo": "libraw/libraw", "base_commit": "371161a06d7f98f231a001dad4af2dfb463e270a", "date": "2021-07-27T07:02:08", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout 371161a06d7f98f231a001dad4af2dfb463e270a\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=23870\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5647329419067392\n\nProject: libraw\nFuzzing Engine: libFuzzer\nFuzz Target: libraw_cr2_fuzzer\nJob Type: libfuzzer_ubsan_libraw\nPlatform Id: linux\n\nCrash Type: Index-out-of-bounds\nCrash Address:\nCrash State:\n  DHT::get_hv_rbg\n  DHT::make_hv_dline\n  DHT::make_hv_dirs\n \nSanitizer: undefined (UBSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_ubsan_libraw&range=202006121756:202006130238\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5647329419067392\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  LibRaw lib_raw;\n\n  int result = lib_raw.open_buffer(\n      const_cast<char*>(reinterpret_cast<const char*>(data)), size);\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "363e91ea656f4ce46584b4b0af6285030f236b7e", "url": "https://github.com/libraw/libraw/commit/363e91ea656f4ce46584b4b0af6285030f236b7e"}]}
{"instance_id": "sleuthkit.osv-2021-1775", "repo": "sleuthkit/sleuthkit", "base_commit": "c86bb0b7aa2d86dc6286d1840420491d83c9094c", "date": "2022-01-05T10:06:06", "project_name": "sleuthkit", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool\nRUN git clone https://github.com/sleuthkit/sleuthkit sleuthkit\nRUN git -C sleuthkit checkout c86bb0b7aa2d86dc6286d1840420491d83c9094c\nWORKDIR sleuthkit\nCOPY build.sh buildcorpus.sh sleuthkit_mem_img.h *_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nexport CFLAGS=\"$CFLAGS -Wno-error=non-c-typedef-for-linkage\"\nexport CXXFLAGS=\"$CXXFLAGS -Wno-error=non-c-typedef-for-linkage\"\n\n# Dont fail if some of the seed downloads fail.\n${SRC}/buildcorpus.sh || true\n\n./bootstrap\n./configure --enable-static --disable-shared --disable-java --without-afflib --without-libewf --without-libvhdi --without-libvmdk\nmake -j$(nproc)\n\ndeclare -A TSK_FS_TYPES=(\n  [\"ext\"]=\"TSK_FS_TYPE_EXT_DETECT\"\n  [\"fat\"]=\"TSK_FS_TYPE_FAT_DETECT\"\n  [\"hfs\"]=\"TSK_FS_TYPE_HFS\"\n  [\"ntfs\"]=\"TSK_FS_TYPE_NTFS\"\n  [\"iso9660\"]=\"TSK_FS_TYPE_ISO9660\"\n)\n\ndeclare -A TSK_VS_TYPES=(\n  [\"dos\"]=\"TSK_VS_TYPE_DOS\"\n  [\"gpt\"]=\"TSK_VS_TYPE_GPT\"\n  [\"mac\"]=\"TSK_VS_TYPE_MAC\"\n  [\"sun\"]=\"TSK_VS_TYPE_SUN\"\n)\n\n# The fls APFS fuzz target has a seperate source file since it uses the libtsk\n# pool layer.\n$CXX $CXXFLAGS -std=c++14 -I.. -I. -Itsk \\\n    $SRC/sleuthkit_fls_apfs_fuzzer.cc -o $OUT/sleuthkit_fls_apfs_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/sleuthkit/tsk/.libs/libtsk.a\n\nfor type in ${!TSK_FS_TYPES[@]}; do\n  $CXX $CXXFLAGS -std=c++14 -I.. -I. -Itsk -DFSTYPE=${TSK_FS_TYPES[$type]} \\\n      $SRC/sleuthkit_fls_fuzzer.cc -o $OUT/sleuthkit_fls_${type}_fuzzer \\\n      $LIB_FUZZING_ENGINE $SRC/sleuthkit/tsk/.libs/libtsk.a\ndone\n\nfor type in ${!TSK_VS_TYPES[@]}; do\n  $CXX $CXXFLAGS -std=c++14 -I.. -I. -Itsk -DVSTYPE=${TSK_VS_TYPES[$type]} \\\n      $SRC/sleuthkit_mmls_fuzzer.cc -o $OUT/sleuthkit_mmls_${type}_fuzzer \\\n      $LIB_FUZZING_ENGINE $SRC/sleuthkit/tsk/.libs/libtsk.a\ndone\n", "work_dir": "/src/sleuthkit", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43040\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4872546799976448\n\nProject: sleuthkit\nFuzzing Engine: libFuzzer\nFuzz Target: sleuthkit_fls_hfs_fuzzer\nJob Type: libfuzzer_asan_sleuthkit\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x60d000000b5a\nCrash State:\n  hfs_dir_open_meta_cb\n  hfs_cat_traverse\n  hfs_dir_open_meta\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_sleuthkit&range=202106230634:202106240621\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4872546799976448\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "buildcorpus.sh", "content": "#!/bin/bash -eu\n#\n# Script to downloads test data and build the corpus\n#\n# Copyright 2021 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Test data provided by:\n#\n# The Fuzzing Project: https://fuzzing-project.org/resources.html\n#   As CC0 1.0 Universal (CC0 1.0) Public Domain Dedication\n#   https://creativecommons.org/publicdomain/zero/1.0/\n#\n# The dfVFS project: https://github.com/log2timeline/dfvfs\n#   As Apache 2 https://github.com/log2timeline/dfvfs/blob/main/LICENSE\n\n# Files to use for fls fuzz targets\ndeclare -A FLS_TEST_FILES=(\n  [\"apfs\"]=\"https://github.com/log2timeline/dfvfs/blob/main/test_data/apfs.raw?raw=true\"\n  [\"ext\"]=\"https://files.fuzzing-project.org/filesystems/ext2.img\"\n  [\"fat\"]=\"https://files.fuzzing-project.org/filesystems/exfat.img https://files.fuzzing-project.org/filesystems/fat12.img https://files.fuzzing-project.org/filesystems/fat16.img https://files.fuzzing-project.org/filesystems/fat32.img\"\n  [\"hfs\"]=\"https://files.fuzzing-project.org/filesystems/hfsplus.img\"\n  [\"iso9660\"]=\"https://files.fuzzing-project.org/discimages/iso9660.iso\"\n  [\"ntfs\"]=\"https://files.fuzzing-project.org/filesystems/ntfs.img\"\n)\n\n# Files to use for mmls fuzz targets\ndeclare -A MMLS_TEST_FILES=(\n  [\"dos\"]=\"https://files.fuzzing-project.org/discimages/partition-dos\"\n  [\"gpt\"]=\"https://files.fuzzing-project.org/discimages/partition-gpt\"\n  [\"mac\"]=\"https://files.fuzzing-project.org/discimages/partition-mac\"\n)\n\n\nfor type in ${!FLS_TEST_FILES[@]}; do\n  fuzz_target=\"sleuthkit_fls_${type}_fuzzer\"\n\n  mkdir -p \"test_data/${fuzz_target}\"\n\n  IFS=\" \"; for url in ${FLS_TEST_FILES[$type]}; do\n    filename=$( echo ${url} | sed 's/?[^?]*$//' )\n    filename=$( basename ${filename} )\n\n    curl -L -o \"test_data/${fuzz_target}/${filename}\" \"${url}\"\n  done\n\n  (cd \"test_data/${fuzz_target}\" && zip ${OUT}/${fuzz_target}_seed_corpus.zip *)\ndone\n\n\nfor type in ${!MMLS_TEST_FILES[@]}; do\n  fuzz_target=\"sleuthkit_mmls_${type}_fuzzer\"\n\n  mkdir -p \"test_data/${fuzz_target}\"\n\n  IFS=\" \"; for url in ${MMLS_TEST_FILES[$type]}; do\n    filename=$( echo ${url} | sed 's/?[^?]*$//' )\n    filename=$( basename ${filename} )\n\n    curl -L -o \"test_data/${fuzz_target}/${filename}\" \"${url}\"\n  done\n\n  (cd \"test_data/${fuzz_target}\" && zip ${OUT}/${fuzz_target}_seed_corpus.zip *)\ndone\n"}, {"filename": "sleuthkit_fls_apfs_fuzzer.cc", "content": "// Copyright 2021 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n#include \"sleuthkit/tsk/fs/tsk_fs.h\"\n#include \"sleuthkit/tsk/pool/tsk_pool.h\"\n#include \"sleuthkit_mem_img.h\"\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  TSK_IMG_INFO* img;\n  TSK_IMG_INFO* pool_img;\n  TSK_FS_INFO* fs;\n  const TSK_POOL_INFO* pool;\n\n  img = mem_open(data, size);\n  if (img == nullptr) {\n    return 0;\n  }\n  pool = tsk_pool_open_img_sing(img, 0, TSK_POOL_TYPE_APFS);\n\n  if (pool == nullptr) {\n    goto out_img;\n  }\n  // Pool start block is APFS container specific and is hard coded for now\n  pool_img = pool->get_img_info(pool, (TSK_DADDR_T) 106);\n\n  if (pool_img == nullptr) {\n    goto out_pool;\n  }\n  fs = tsk_fs_open_img_decrypt(pool_img, 0, TSK_FS_TYPE_APFS_DETECT, \"\");\n\n  if (fs != nullptr) {\n    tsk_fs_fls(fs, TSK_FS_FLS_FULL, fs->root_inum, TSK_FS_DIR_WALK_FLAG_RECURSE, nullptr, 0);\n\n    fs->close(fs);\n  }\n  tsk_img_close(pool_img);\n\nout_pool:\n  tsk_pool_close(pool);\n\nout_img:\n  tsk_img_close(img);\n\n  return 0;\n}\n"}, {"filename": "sleuthkit_fls_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n#include \"sleuthkit_mem_img.h\"\n\n#ifndef FSTYPE\n#error Define FSTYPE as a valid value of TSK_FS_TYPE_ENUM.\n#endif\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  TSK_IMG_INFO *img;\n  TSK_FS_INFO *fs;\n\n  img = mem_open(data, size);\n  if (img == nullptr)\n    return 0;\n\n  fs = tsk_fs_open_img(img, 0, FSTYPE);\n  if (fs != nullptr) {\n    tsk_fs_fls(fs, TSK_FS_FLS_FULL, fs->root_inum, TSK_FS_DIR_WALK_FLAG_RECURSE,\n               nullptr, 0);\n\n    fs->close(fs);\n  }\n\n  img->close(img);\n  return 0;\n}\n"}, {"filename": "sleuthkit_mem_img.h", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#ifndef MEM_IMG_H\n#define MEM_IMG_H\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n\ntypedef struct {\n  TSK_IMG_INFO img_info;\n  const uint8_t *data;\n  size_t size;\n} IMG_MEM_INFO;\n\nstatic ssize_t mem_read(TSK_IMG_INFO *img_info, TSK_OFF_T offset, char *buf,\n                        size_t len) {\n  IMG_MEM_INFO *mem_info = reinterpret_cast<IMG_MEM_INFO *>(img_info);\n  // Bounds-checking exists in the real drivers.\n  if (offset > mem_info->size) {\n    return -1;\n  }\n  ssize_t read_len = len;\n  if (offset + len > mem_info->size) {\n    read_len = mem_info->size - offset;\n  }\n  if (memcpy(buf, mem_info->data + offset, read_len) == nullptr) {\n    return -1;\n  } else {\n    return read_len;\n  }\n}\n\nstatic void mem_close(TSK_IMG_INFO *img_info) {\n  IMG_MEM_INFO *mem_info = reinterpret_cast<IMG_MEM_INFO *>(img_info);\n  tsk_deinit_lock(&(img_info->cache_lock));\n  free(mem_info);\n}\n\nstatic void mem_imgstat(TSK_IMG_INFO *img_info, FILE *hFile) {}\n\nTSK_IMG_INFO *mem_open(const uint8_t *data, size_t size) {\n  IMG_MEM_INFO *inmemory_img =\n      reinterpret_cast<IMG_MEM_INFO *>(malloc(sizeof(IMG_MEM_INFO)));\n  TSK_IMG_INFO *img;\n  if (inmemory_img == nullptr) {\n    return nullptr;\n  }\n  img = reinterpret_cast<TSK_IMG_INFO *>(inmemory_img);\n  img->itype = TSK_IMG_TYPE_RAW;\n  img->read = mem_read;\n  img->close = mem_close;\n  img->imgstat = mem_imgstat;\n  img->size = size;\n  img->sector_size = 512;\n  tsk_init_lock(&(img->cache_lock));\n  inmemory_img->data = data;\n  inmemory_img->size = size;\n  return img;\n}\n\n#endif // # MEM_IMG_H\n"}, {"filename": "sleuthkit_mmls_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n#include \"sleuthkit_mem_img.h\"\n\n#ifndef VSTYPE\n#error Define VSTYPE as a valid value of TSK_VS_TYPE_ENUM.\n#endif\n\nstatic TSK_WALK_RET_ENUM part_act(TSK_VS_INFO *vs, const TSK_VS_PART_INFO *part,\n                                  void *ptr) {\n  return TSK_WALK_CONT;\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  TSK_IMG_INFO *img;\n  TSK_VS_INFO *vs;\n\n  img = mem_open(data, size);\n  if (img == nullptr)\n    return 0;\n\n  vs = tsk_vs_open(img, 0, VSTYPE);\n  if (vs != nullptr) {\n    tsk_vs_part_walk(vs, 0, vs->part_count - 1, TSK_VS_PART_FLAG_ALL, part_act,\n                     nullptr);\n\n    tsk_vs_close(vs);\n  }\n\n  img->close(img);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "890b7ede03ed065237566930c0e95737b6df0bbd", "url": "https://github.com/sleuthkit/sleuthkit/commit/890b7ede03ed065237566930c0e95737b6df0bbd"}]}
{"instance_id": "harfbuzz.osv-2018-162", "repo": "harfbuzz/harfbuzz", "base_commit": "44af1f93ee32e236a5c14085c72d3fa102a14f5e", "date": "2018-10-14T17:52:17", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 44af1f93ee32e236a5c14085c72d3fa102a14f5e\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=function,vptr\"\n\n# Build the library.\n./autogen.sh\n./configure\nmake clean\nmake -j$(nproc) V=1 all\nmake CPPFLAGS=\"-DHB_NO_VISIBILITY\" -C src V=1 fuzzing\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-fuzzing.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset-fuzzing.a ./src/.libs/libharfbuzz-fuzzing.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nzip -j -r $OUT/hb-shape-fuzzer_seed_corpus.zip $SRC/harfbuzz/test/shaping/data/in-house/fonts $SRC/harfbuzz/test/shaping/data/text-rendering-tests/fonts $SRC/harfbuzz/test/api/fonts\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=10948\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5726089628876800\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x60700000045c\nCrash State:\n  BEInt<unsigned int, 4>::operator unsigned int\n  OT::OffsetTo<OT::UnsizedArrayOf<OT::IntType<short, 2u> >, OT::IntType<unsigned i\n  AAT::KerxSubTableFormat1::driver_context_t::driver_context_t\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201810110141:201810130142\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5726089628876800\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "40f2b9355cf827c7b82ea5e55b112ce0032a9abf", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/40f2b9355cf827c7b82ea5e55b112ce0032a9abf"}]}
{"instance_id": "harfbuzz.osv-2018-174", "repo": "harfbuzz/harfbuzz", "base_commit": "f074da8c2b6a7061c71d12213a6c494c119eb20e", "date": "2018-11-03T15:07:39", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout f074da8c2b6a7061c71d12213a6c494c119eb20e\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr\"\n\n# Build the library.\n./autogen.sh\n./configure\nmake clean\nmake -j$(nproc) V=1 all\nmake CPPFLAGS=\"-DHB_NO_VISIBILITY\" -C src V=1 fuzzing\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-fuzzing.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset-fuzzing.a ./src/.libs/libharfbuzz-fuzzing.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shaping/data/in-house/fonts \\\n\ttest/shaping/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11245\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5735679418433536\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x60700000033e\nCrash State:\n  BEInt<unsigned char, 1>::operator unsigned char\n  OT::KernSubTableFormat3::get_kerning\n  hb_kern_machine_t<OT::KernSubTableFormat3>::kern\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201811020143:201811030141\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5735679418433536\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "8d98c51d133b058a845ed7a84bfe8a43083bbb03", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/8d98c51d133b058a845ed7a84bfe8a43083bbb03"}]}
{"instance_id": "libraw.osv-2021-427", "repo": "libraw/libraw", "base_commit": "371161a06d7f98f231a001dad4af2dfb463e270a", "date": "2021-07-27T07:02:08", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout 371161a06d7f98f231a001dad4af2dfb463e270a\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=31181\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5078026003021824\n\nProject: libraw\nFuzzing Engine: libFuzzer\nFuzz Target: libraw_fuzzer\nJob Type: libfuzzer_asan_libraw\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x61900000047f\nCrash State:\n  LibRaw::kodak_c330_load_raw\n  LibRaw::unpack\n  libraw_fuzzer.cc\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libraw&range=202101290609:202101300625\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5078026003021824\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  LibRaw lib_raw;\n\n  int result = lib_raw.open_buffer(\n      const_cast<char*>(reinterpret_cast<const char*>(data)), size);\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "363e91ea656f4ce46584b4b0af6285030f236b7e", "url": "https://github.com/libraw/libraw/commit/363e91ea656f4ce46584b4b0af6285030f236b7e"}]}
{"instance_id": "icu.osv-2020-866", "repo": "unicode-org/icu", "base_commit": "f4f74c1f2ee380c20434f224d7fea05fdb4e91d6", "date": "2022-03-31T19:39:13", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout f4f74c1f2ee380c20434f224d7fea05fdb4e91d6\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=15671\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5693360544677888\n\nProject: icu\nFuzzer: libFuzzer_icu_collator_rulebased_fuzzer\nFuzz target binary: collator_rulebased_fuzzer\nJob Type: libfuzzer_msan_icu\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x7f8c94ee4a30\nCrash State:\n  icu_64::UCharsTrie::branchNext\n  icu_64::UCharsTrie::nextImpl\n  icu_64::UCharsTrie::next\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_icu&range=201906250235:201906260234\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5693360544677888\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "4833cc89b2fae2e8863b46bf1dc785964847e882", "url": "https://github.com/unicode-org/icu.git/commit/4833cc89b2fae2e8863b46bf1dc785964847e882"}]}
{"instance_id": "openjpeg.osv-2017-22", "repo": "uclouvain/openjpeg", "base_commit": "33167ddc13fd20313ccfcdc64141000407b68b8f", "date": "2017-09-08T03:53:52", "project_name": "openjpeg", "lang": "c++", "dockerfile": "# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER antonin@gmail.com\nRUN apt-get update && apt-get install -y make cmake g++\nRUN git clone https://github.com/uclouvain/openjpeg openjpeg\nRUN git -C openjpeg checkout 33167ddc13fd20313ccfcdc64141000407b68b8f\n# openjpeg-data is used to create a seed corpus\nRUN git clone --depth 1 https://github.com/uclouvain/openjpeg-data openjpeg/data\nWORKDIR openjpeg\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir build\ncd build\ncmake ..\nmake clean -s\nmake -j$(nproc) -s\ncd ..\n\n./tests/fuzzers/build_google_oss_fuzzers.sh\n./tests/fuzzers/build_seed_corpus.sh\n", "work_dir": "/src/openjpeg", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3331\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5889118611439616\n\nProject: openjpeg\nFuzzer: libFuzzer_openjpeg_opj_decompress_fuzzer\nFuzz target binary: opj_decompress_fuzzer\nJob Type: libfuzzer_asan_openjpeg\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x613000001848\nCrash State:\n  opj_tcd_mct_decode\n  opj_tcd_decode_tile\n  opj_j2k_decode_tile\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_openjpeg&range=201709070414:201709080414\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5889118611439616\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you have questions for the OSS-Fuzz team, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [], "candidate_fixes": [{"sha": "28094e1ebfa420f9a0bdc7a11b8d4ee5f154db35", "url": "https://github.com/uclouvain/openjpeg/commit/28094e1ebfa420f9a0bdc7a11b8d4ee5f154db35"}]}
{"instance_id": "libavc.osv-2023-117", "repo": "ittiam-systems/libavc", "base_commit": "4900778d4c9f01faa81f6f26327b57ae3b60e3c2", "date": "2023-02-25T12:26:25", "project_name": "libavc", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y wget cmake\nRUN git clone https://github.com/ittiam-systems/libavc.git\nRUN git -C libavc checkout 4900778d4c9f01faa81f6f26327b57ae3b60e3c2\nADD https://storage.googleapis.com/android_media/external/libavc/fuzzer/avc_dec_fuzzer_seed_corpus.zip $SRC/\nCOPY build.sh $SRC/\nWORKDIR libavc", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n# Run the OSS-Fuzz script in the project.\n$SRC/libavc/fuzzer/ossfuzz.sh\n", "work_dir": "/src/libavc", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=56386\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4601031721091072\n\nProject: libavc\nFuzzing Engine: libFuzzer\nFuzz Target: svc_dec_fuzzer\nJob Type: libfuzzer_asan_i386_libavc\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 4\nCrash Address: 0xf15fb808\nCrash State:\n  isvcd_nal_byte_swap_emulation\n  isvcd_nal_parse_non_vcl_nal\n  isvcd_pre_parse_refine_au\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_i386_libavc&range=202302250606:202302260617\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4601031721091072\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "c0ca3b2979a6f0999c57549986f99334666e8ef7", "url": "https://github.com/ittiam-systems/libavc.git/commit/c0ca3b2979a6f0999c57549986f99334666e8ef7"}]}
{"instance_id": "c-ares.osv-2020-630", "repo": "c-ares/c-ares", "base_commit": "5dd3629bc93449840c36dd635ea6cce606b8c366", "date": "2019-06-19T22:04:25", "project_name": "c-ares", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool\nRUN git clone https://github.com/c-ares/c-ares.git\nRUN git -C c-ares checkout 5dd3629bc93449840c36dd635ea6cce606b8c366\nWORKDIR c-ares\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Remove -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION from CFLAGS\n# as a workaround for https://github.com/google/oss-fuzz/issues/413.\n# It's unclear why the c-ares configure is that picky;\n# a better fix would probably be in the c-ares build system.\nCFLAGS=$(for f in $CFLAGS; do [ $f != \"-DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\" ] && echo $f; done);\n\n# Build the project.\n./buildconf\n./configure --enable-debug\nmake clean\nmake -j$(nproc) V=1 all\n\n# Build the fuzzers.\n$CC $CFLAGS -I. -c $SRC/c-ares/test/ares-test-fuzz.c -o $WORK/ares-test-fuzz.o\n$CXX $CXXFLAGS -std=c++11 $WORK/ares-test-fuzz.o \\\n    -o $OUT/ares_parse_reply_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/c-ares/.libs/libcares.a\n\n$CC $CFLAGS -I. -c $SRC/c-ares/test/ares-test-fuzz-name.c \\\n    -o $WORK/ares-test-fuzz-name.o\n$CXX $CXXFLAGS -std=c++11 $WORK/ares-test-fuzz-name.o \\\n    -o $OUT/ares_create_query_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/c-ares/.libs/libcares.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nzip -j $OUT/ares_parse_reply_fuzzer_seed_corpus.zip $SRC/c-ares/test/fuzzinput/*\nzip -j $OUT/ares_create_query_fuzzer_seed_corpus.zip \\\n    $SRC/c-ares/test/fuzznames/*\n", "work_dir": "/src/c-ares", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=15379\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5728518081609728\n\nProject: c-ares\nFuzzer: libFuzzer_c-ares_ares_parse_reply_fuzzer\nFuzz target binary: ares_parse_reply_fuzzer\nJob Type: libfuzzer_msan_c-ares\nPlatform Id: linux\n\nCrash Type: Use-of-uninitialized-value\nCrash Address:\nCrash State:\n  ares__parse_into_addrinfo2\n  ares_parse_aaaa_reply\n  ares-test-fuzz.c\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_c-ares&range=201906180157:201906190155\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5728518081609728\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "b949cc3ddfbeb1b3fba571fb53b186b645e66e9c", "url": "https://github.com/c-ares/c-ares.git/commit/b949cc3ddfbeb1b3fba571fb53b186b645e66e9c"}]}
{"instance_id": "libavc.osv-2023-1205", "repo": "ittiam-systems/libavc", "base_commit": "0d29250b990430ca0d7346459c11ca053380bbb5", "date": "2023-12-19T23:45:31", "project_name": "libavc", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y wget cmake\nRUN git clone https://github.com/ittiam-systems/libavc.git\nRUN git -C libavc checkout 0d29250b990430ca0d7346459c11ca053380bbb5\nADD https://storage.googleapis.com/android_media/external/libavc/fuzzer/avc_dec_fuzzer_seed_corpus.zip $SRC/\nCOPY build.sh $SRC/\nWORKDIR libavc", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n# Run the OSS-Fuzz script in the project.\n$SRC/libavc/fuzzer/ossfuzz.sh\n", "work_dir": "/src/libavc", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64431\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4627953069457408\n\nProject: libavc\nFuzzing Engine: libFuzzer\nFuzz Target: svc_dec_fuzzer\nJob Type: libfuzzer_asan_libavc\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 1\nCrash Address: 0x6250000099d4\nCrash State:\n  isvcd_populate_res_prms\n  isvcd_parse_interlayer_resamp_func_init\n  isvcd_mark_err_slice_skip\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libavc&range=202302080604:202302090622\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4627953069457408\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "28727baf58aa7c8983769aff1ceecb3121a26ee6", "url": "https://github.com/ittiam-systems/libavc.git/commit/28727baf58aa7c8983769aff1ceecb3121a26ee6"}]}
{"instance_id": "libbpf.osv-2021-1562", "repo": "libbpf/libbpf", "base_commit": "881a10980b7ded995da5d9cc1919992c36c9d2be", "date": "2022-10-17T16:13:02", "project_name": "libbpf", "lang": "c++", "dockerfile": "# Copyright 2021 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN sed -i -e '/^#\\s*deb-src.*\\smain\\s\\+restricted/s/^#//' /etc/apt/sources.list && \\\n    apt-get update && \\\n    # libelf build dependencies \\\n    apt-get build-dep -y --no-install-recommends libelf-dev && \\\n    apt-get install -y --no-install-recommends pkg-config && \\\n    # libbpf build dependencies \\\n    apt-get install -y --no-install-recommends libz-dev libz-dev:i386\nRUN git clone https://github.com/libbpf/libbpf\nRUN git -C libbpf checkout 881a10980b7ded995da5d9cc1919992c36c9d2be\nWORKDIR libbpf\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -e\n# Copyright 2021 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n./scripts/build-fuzzers.sh\n", "work_dir": "/src/libbpf", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=40868\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6268501392752640\n\nProject: libbpf\nFuzzing Engine: libFuzzer\nFuzz Target: bpf-object-fuzzer\nJob Type: libfuzzer_asan_libbpf\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 4\nCrash Address: 0x6020000000c0\nCrash State:\n  __bpf_object__open\n  bpf_object__open_mem\n  bpf-object-fuzzer.c\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libbpf&range=202110230000:202110230605\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6268501392752640\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "741277511035893c72a34df05da3b943afa747a4", "url": "https://github.com/libbpf/libbpf/commit/741277511035893c72a34df05da3b943afa747a4"}]}
{"instance_id": "harfbuzz.osv-2018-119", "repo": "harfbuzz/harfbuzz", "base_commit": "3e284e02c2a5da758526360a45364a330b8ab8e9", "date": "2018-11-11T22:51:34", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 3e284e02c2a5da758526360a45364a330b8ab8e9\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr\"\n\n# Build the library.\n./autogen.sh\n./configure\nmake clean\nmake -j$(nproc) V=1 all\nmake CPPFLAGS=\"-DHB_NO_VISIBILITY\" -C src V=1 fuzzing\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-fuzzing.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset-fuzzing.a ./src/.libs/libharfbuzz-fuzzing.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shaping/data/in-house/fonts \\\n\ttest/shaping/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11367\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5691469793329152\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x7fef5fd7e540\nCrash State:\n  AAT::KerxSubTableFormat1<AAT::KerxSubTableHeader>::driver_context_t::transition\n  void AAT::StateTableDriver<AAT::ExtendedTypes, AAT::Format1Entry<true>::EntryDat\n  AAT::KerxSubTableFormat1<AAT::KerxSubTableHeader>::apply\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201811100245:201811110244\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5691469793329152\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "a549aa14a0b60436a16f7f8924a5b5f82b4d5b7e", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/a549aa14a0b60436a16f7f8924a5b5f82b4d5b7e"}]}
{"instance_id": "php.osv-2021-1759", "repo": "php/php-src", "base_commit": "8b235380347d6dbdfeabf96bbb5f05f446cd5954", "date": "2021-12-24T05:11:09", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 8b235380347d6dbdfeabf96bbb5f05f446cd5954\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=42894\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6650085318983680\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-tracing-jit\nJob Type: libfuzzer_asan_i386_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0xf47098f4\nCrash State:\n  zend_hash_reverse_apply\n  shutdown_destructors\n  zend_call_destructors\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_i386_php&range=202112220605:202112230602\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6650085318983680\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "eee3b1d917591e5106aef9fd4fe93393e95fc13d", "url": "https://github.com/php/php-src.git/commit/eee3b1d917591e5106aef9fd4fe93393e95fc13d"}]}
{"instance_id": "lz4.osv-2022-571", "repo": "lz4/lz4", "base_commit": "9d20cd519ae62c8864ab237068e4c11490cbd0a9", "date": "2022-07-05T19:31:54", "project_name": "lz4", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\n\nRUN git clone https://github.com/lz4/lz4.git /src/lz4\nRUN git -C /src/lz4 checkout 9d20cd519ae62c8864ab237068e4c11490cbd0a9\n\nWORKDIR $SRC/lz4\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Run the OSS-Fuzz script in the project.\n./ossfuzz/ossfuzz.sh\n", "work_dir": "/src/lz4", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=48993\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5810591549227008\n\nProject: lz4\nFuzzing Engine: libFuzzer\nFuzz Target: round_trip_frame_uncompressed_fuzzer\nJob Type: libfuzzer_msan_lz4\nPlatform Id: linux\n\nCrash Type: Use-of-uninitialized-value\nCrash Address:\nCrash State:\n  LZ4_compress_fast_extState_fastReset\n  LZ4F_compressBlock\n  LZ4F_compressUpdateImpl\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_lz4&range=202206120610:202207080608\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5810591549227008\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "910ec80d2856cfa825e2230ff2de8347a4fa4522", "url": "https://github.com/lz4/lz4.git/commit/910ec80d2856cfa825e2230ff2de8347a4fa4522"}]}
{"instance_id": "libraw.osv-2020-1362", "repo": "libraw/libraw", "base_commit": "371161a06d7f98f231a001dad4af2dfb463e270a", "date": "2021-07-27T07:02:08", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout 371161a06d7f98f231a001dad4af2dfb463e270a\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=24016\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4762894621999104\n\nProject: libraw\nFuzzing Engine: libFuzzer\nFuzz Target: libraw_cr2_fuzzer\nJob Type: libfuzzer_msan_libraw\nPlatform Id: linux\n\nCrash Type: Use-of-uninitialized-value\nCrash Address:\nCrash State:\n  LibRaw::init_fuji_block\n  LibRaw::fuji_decode_strip\n  LibRaw::fuji_decode_loop\n \nSanitizer: memory (MSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_msan_libraw&range=202006121756:202006130238\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4762894621999104\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  LibRaw lib_raw;\n\n  int result = lib_raw.open_buffer(\n      const_cast<char*>(reinterpret_cast<const char*>(data)), size);\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "363e91ea656f4ce46584b4b0af6285030f236b7e", "url": "https://github.com/libraw/libraw/commit/363e91ea656f4ce46584b4b0af6285030f236b7e"}]}
{"instance_id": "php.osv-2021-651", "repo": "php/php-src", "base_commit": "c8a966a9ae0d9d501395c142305d88e558bae357", "date": "2021-04-19T10:18:03", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout c8a966a9ae0d9d501395c142305d88e558bae357\nRUN git clone https://github.com/kkos/oniguruma.git php-src/oniguruma\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build oniguruma and link statically\npushd oniguruma\nautoreconf -vfi\n./configure\nmake -j$(nproc)\npopd\nexport ONIG_CFLAGS=\"-I$PWD/oniguruma/src\"\nexport ONIG_LIBS=\"-L$PWD/oniguruma/src/.libs -l:libonig.a\"\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# build project\n./buildconf\n./configure \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-mbstring \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-mbstring\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=33335\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5470432774979584\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-execute\nJob Type: libfuzzer_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x604000026c90\nCrash State:\n  zend_gc_delref\n  zval_delref_p\n  zval_ptr_dtor_nogc\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_php&range=202104150634:202104160611\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5470432774979584\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "08dafda1232ffb70d878cb9b334982163aa32357", "url": "https://github.com/php/php-src.git/commit/08dafda1232ffb70d878cb9b334982163aa32357"}]}
{"instance_id": "harfbuzz.osv-2023-1272", "repo": "harfbuzz/harfbuzz", "base_commit": "74e897117196629f2f736b8053386cbf2e454e11", "date": "2023-12-11T15:07:27", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y python3-pip ragel pkg-config && \\\n    pip3 install meson==0.56.0 ninja\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 74e897117196629f2f736b8053386cbf2e454e11\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\n\n# setup\nbuild=$WORK/build\n\n# cleanup\nrm -rf $build\nmkdir -p $build\n\n# Build the library.\nmeson --default-library=static --wrap-mode=nodownload \\\n      -Dexperimental_api=true \\\n      -Dfuzzer_ldflags=\"$(echo $LIB_FUZZING_ENGINE)\" \\\n      $build \\\n  || (cat build/meson-logs/meson-log.txt && false)\n\n# Build the fuzzers.\nninja -v -j$(nproc) -C $build test/fuzzing/hb-{shape,draw,repacker,subset,set}-fuzzer\nmv $build/test/fuzzing/hb-{shape,draw,repacker,subset,set}-fuzzer $OUT/\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shape/data/in-house/fonts \\\n\ttest/shape/data/aots/fonts \\\n\ttest/shape/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\tperf/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\n\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-draw-fuzzer_seed_corpus.zip\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\nzip $OUT/hb-set-fuzzer_seed_corpus.zip ./test/fuzzing/sets/*\nzip $OUT/hb-repacker-fuzzer_seed_corpus.zip ./test/fuzzing/graphs/*\n\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64859\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5393832740782080\n\nProject: harfbuzz\nFuzzing Engine: libFuzzer\nFuzz Target: hb-draw-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 2\nCrash Address: 0x60400000008f\nCrash State:\n  OT::cff2::accelerator_templ_t<CFF::cff2_private_dict_opset_t, CFF::cff2_private_\n  hb_ot_draw_glyph\n  hb_font_draw_glyph\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=202312060619:202312070627\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5393832740782080\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "hb-draw-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-repacker-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-set-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "5b325c0ae9cdd7ca03c002d7cae92a6d17f5111b", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/5b325c0ae9cdd7ca03c002d7cae92a6d17f5111b"}]}
{"instance_id": "php.osv-2021-1780", "repo": "php/php-src", "base_commit": "8147fec3727bffd5480a8261f58b048ca6fa98f0", "date": "2021-12-28T07:29:42", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 8147fec3727bffd5480a8261f58b048ca6fa98f0\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=43055\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5513940338081792\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-function-jit\nJob Type: libfuzzer_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x606000011c68\nCrash State:\n  zend_jit_fetch_dim_r_helper\n  zero\n  zend_execute\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_php&range=202112140600:202112150607\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5513940338081792\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "9362d6f5f08bf5f86fc30cf12433e1634f746c4d", "url": "https://github.com/php/php-src.git/commit/9362d6f5f08bf5f86fc30cf12433e1634f746c4d"}]}
{"instance_id": "espeak-ng.osv-2022-530", "repo": "espeak-ng/espeak-ng", "base_commit": "0fa9737a002cc9c99330f32b650e8804241e7436", "date": "2022-07-01T20:07:00", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout 0fa9737a002cc9c99330f32b650e8804241e7436\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=48589\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5636498354995200\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x602000000153\nCrash State:\n  string_decoder_getc_utf_8\n  text_decoder_getc\n  ReadClause\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202105130601:202105140612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5636498354995200\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "482ee1da05189252c3dee49514506e1d2271a2c0", "url": "https://github.com/espeak-ng/espeak-ng/commit/482ee1da05189252c3dee49514506e1d2271a2c0"}]}
{"instance_id": "harfbuzz.osv-2023-377", "repo": "harfbuzz/harfbuzz", "base_commit": "5f5660fc5d80a0ce84066206e8e9bad6e20a24d4", "date": "2023-05-05T17:52:17", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y python3-pip ragel pkg-config && \\\n    pip3 install meson==0.56.0 ninja\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 5f5660fc5d80a0ce84066206e8e9bad6e20a24d4\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\n\n# setup\nbuild=$WORK/build\n\n# cleanup\nrm -rf $build\nmkdir -p $build\n\n# Build the library.\nmeson --default-library=static --wrap-mode=nodownload \\\n      -Dexperimental_api=true \\\n      -Dfuzzer_ldflags=\"$(echo $LIB_FUZZING_ENGINE)\" \\\n      $build \\\n  || (cat build/meson-logs/meson-log.txt && false)\n\n# Build the fuzzers.\nninja -v -j$(nproc) -C $build test/fuzzing/hb-{shape,draw,repacker,subset,set}-fuzzer\nmv $build/test/fuzzing/hb-{shape,draw,repacker,subset,set}-fuzzer $OUT/\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shape/data/in-house/fonts \\\n\ttest/shape/data/aots/fonts \\\n\ttest/shape/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\tperf/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\n\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-draw-fuzzer_seed_corpus.zip\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\nzip $OUT/hb-set-fuzzer_seed_corpus.zip ./test/fuzzing/sets/*\nzip $OUT/hb-repacker-fuzzer_seed_corpus.zip ./test/fuzzing/graphs/*\n\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=58671\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4985737289007104\n\nProject: harfbuzz\nFuzzing Engine: libFuzzer\nFuzz Target: hb-subset-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: UNKNOWN WRITE\nCrash Address: 0x73e0043d3839\nCrash State:\n  bool OT::Layout::Common::CoverageFormat2_4<OT::Layout::MediumTypes>::serialize<h\n  bool OT::Layout::Common::Coverage::serialize<hb_sorted_array_t<unsigned int cons\n  OT::Layout::GSUB_impl::AlternateSubstFormat1_2<OT::Layout::SmallTypes>::subset\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=202305040622:202305050612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4985737289007104\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "hb-draw-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-repacker-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-set-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "cda646a598207642721b753ef5abcebb2525f61b", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/cda646a598207642721b753ef5abcebb2525f61b"}]}
{"instance_id": "libexif.osv-2021-1128", "repo": "libexif/libexif", "base_commit": "d0ebd6eac1f67c9a7b970179c0a88ea2b229c300", "date": "2021-08-14T09:25:13", "project_name": "libexif", "lang": "c++", "dockerfile": "# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool gettext autopoint\nRUN git clone https://github.com/libexif/libexif\nRUN git -C libexif checkout d0ebd6eac1f67c9a7b970179c0a88ea2b229c300\nRUN git clone --depth 1 https://github.com/ianare/exif-samples\nWORKDIR libexif\nCOPY exif_loader_fuzzer.cc exif_from_data_fuzzer.cc build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nautoreconf -fiv\n./configure --disable-docs --enable-shared=no --prefix=\"$WORK\"\nmake -j$(nproc)\nmake install\n\npushd $SRC\nmkdir -p exif_corpus\nfind exif-samples -type f -name '*.jpg' -exec mv -n {} exif_corpus/ \\; -o -name '*.tiff' -exec mv -n {} exif_corpus/ \\;\ncp libexif/test/testdata/*.jpg exif_corpus\nzip -r \"$WORK/exif_seed_corpus.zip\" exif_corpus/\npopd\n\nfor fuzzer in $(find $SRC/ -name '*_fuzzer.cc'); do\n  fuzzer_basename=$(basename -s .cc $fuzzer)\n  $CXX $CXXFLAGS \\\n      -std=c++11 \\\n      -I\"$WORK/include\" \\\n      $fuzzer \\\n      -o $OUT/$fuzzer_basename \\\n      $LIB_FUZZING_ENGINE \\\n      \"$WORK/lib/libexif.a\"\n  cp $WORK/exif_seed_corpus.zip \"${OUT}/${fuzzer_basename}_seed_corpus.zip\"\ndone\n", "work_dir": "/src/libexif", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37211\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4532703432146944\n\nProject: libexif\nFuzzing Engine: libFuzzer\nFuzz Target: exif_loader_fuzzer\nJob Type: libfuzzer_asan_libexif\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 3\nCrash Address: 0x6020000000b2\nCrash State:\n  exif_mnote_data_apple_identify\n  interpret_maker_note\n  exif_data_load_data\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libexif&range=202108140610:202108150609\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4532703432146944\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "exif_from_data_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <libexif/exif-data.h>\n#include <libexif/exif-loader.h>\n#include <stddef.h>\n#include <stdlib.h>\n\n/* Extract all MakerNote tags */\nstatic void mnote_dump(ExifData *data) {\n    ExifMnoteData *mn = exif_data_get_mnote_data(data);\n    if (mn) {\n        int num = exif_mnote_data_count(mn);\n\n        /* Loop through all MakerNote tags */\n        for (int i=0; i < num; ++i) {\n            char buf[1024];\n            exif_mnote_data_get_value(mn, i, buf, sizeof(buf));\n        }\n    }\n}\n\nstatic void dump_value(ExifEntry *entry, void *user_data) {\n  char buf[1024];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nstatic void data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, dump_value, NULL);\n}\n\n/* This is like exif_data_dump but without writing to stdout */\nstatic void data_dump(ExifData *data) {\n  exif_data_foreach_content(data, data_func, NULL);\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n\n  // Parse tags using (ultimately) exif_data_load_data()\n  auto image = exif_data_new_from_data(data, size);\n  if (image) {\n    // Exercise the EXIF tag manipulation code\n    exif_data_get_mnote_data(image);\n    data_dump(image);\n    mnote_dump(image);\n    unsigned char *buf;\n    unsigned int sz;\n    exif_data_save_data(image, &buf, &sz);\n    free(buf);\n    exif_data_fix(image);\n    exif_data_unref(image);\n  }\n\n  return 0;\n}\n"}, {"filename": "exif_loader_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stdio.h>\n#include <stdint.h>\n#include <libexif/exif-loader.h>\n\n\nvoid content_func(ExifEntry *entry, void *user_data) {\n  char buf[10000];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nvoid data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, content_func, NULL);\n}\n\nstatic void\ntest_exif_data (ExifData *d) {\n  unsigned int i, c;\n  char v[1024], *p;\n  ExifMnoteData *md;\n\n  md = exif_data_get_mnote_data (d);\n  if (!md) {\n    return;\n  }\n\n  exif_mnote_data_ref (md);\n  exif_mnote_data_unref (md);\n\n  c = exif_mnote_data_count (md);\n  for (i = 0; i < c; i++) {\n    const char *name = exif_mnote_data_get_name (md, i);\n    if (!name) {\n      break;\n    }\n    exif_mnote_data_get_title (md, i);\n    exif_mnote_data_get_description (md, i);\n    exif_mnote_data_get_value (md, i, v, sizeof (v));\n  }\n}\n\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  ExifLoader *loader = exif_loader_new();\n  ExifData *exif_data;\n  if (!loader) {\n    return 0;\n  }\n  exif_loader_write(loader, const_cast<unsigned char*>(data), size);\n  exif_data = exif_loader_get_data(loader);\n  if(!exif_data) {\n    exif_loader_unref(loader);\n    return 0;\n  }\n  exif_data_foreach_content(exif_data, data_func, NULL);\n  test_exif_data (exif_data);\n  exif_loader_unref(loader);\n  exif_data_unref(exif_data);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "22799320cc1187868d9a572661d12f0c3f9939b5", "url": "https://github.com/libexif/libexif/commit/22799320cc1187868d9a572661d12f0c3f9939b5"}]}
{"instance_id": "lwan.osv-2022-320", "repo": "lpereira/lwan", "base_commit": "4272b886241688021ddc5f938d21e4830b447bed", "date": "2022-04-10T00:29:57", "project_name": "lwan", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update\nRUN apt-get install -y build-essential cmake git ninja-build zlib1g-dev\n\nRUN git clone https://github.com/lpereira/lwan.git\nRUN git -C lwan checkout 4272b886241688021ddc5f938d21e4830b447bed\nWORKDIR lwan\n\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -euv\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\nmkdir -p $WORK/lwan\ncd $WORK/lwan\n\ncmake -GNinja \\\n\t-DCMAKE_BUILD_TYPE=Debug \\\n\t-DCMAKE_C_COMPILER=\"${CC}\" \\\n\t-DCMAKE_C_FLAGS=\"${CFLAGS}\" \\\n\t$SRC/lwan/\n\nninja -v liblwan.a\n\ncp $SRC/lwan/fuzz/*.dict $OUT/\n\nfor fuzzer in $SRC/lwan/src/bin/fuzz/*_fuzzer.cc; do\n\texecutable=$(basename $fuzzer .cc)\n\tcorpus_base=$(basename $fuzzer _fuzzer.cc)\n\n\tzip -jr $OUT/${executable}_seed_corpus.zip $SRC/lwan/fuzz/corpus/corpus-${corpus_base}-*\n\t\n\t$CXX $CXXFLAGS -std=c++11 \\\n\t\t-Wl,-whole-archive $WORK/lwan/src/lib/liblwan.a -Wl,-no-whole-archive \\\n\t\t-I$SRC/lwan/src/lib $fuzzer \\\n\t\t$LIB_FUZZING_ENGINE -lpthread -lz \\\n\t\t-o $OUT/$executable\ndone\n", "work_dir": "/src/lwan", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=46506\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4703583657918464\n\nProject: lwan\nFuzzing Engine: libFuzzer\nFuzz Target: h2_huffman_fuzzer\nJob Type: libfuzzer_asan_lwan\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 8\nCrash Address: 0x6020000000ba\nCrash State:\n  lwan_h2_huffman_decode_for_fuzzing\n  h2_huffman_fuzzer.cc\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_lwan&range=202204020612:202204060603\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4703583657918464\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "44283f701359c7b0bcf5e0b5466591c7442d081a", "url": "https://github.com/lpereira/lwan.git/commit/44283f701359c7b0bcf5e0b5466591c7442d081a"}]}
{"instance_id": "serenity.osv-2021-446", "repo": "serenityos/serenity", "base_commit": "9bc3c3c9628926de22fe19f12672472fc9dfe661", "date": "2021-02-24T16:01:37", "project_name": "serenity", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y build-essential cmake curl e2fsprogs libmpfr-dev libmpc-dev libgmp-dev ninja-build\nRUN git clone https://github.com/SerenityOS/serenity\nRUN git -C serenity checkout 9bc3c3c9628926de22fe19f12672472fc9dfe661\nCOPY build.sh $SRC/\nWORKDIR $SRC/serenity/Meta/Lagom", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Now build the content\nmkdir -p build\ncd build\ncmake -GNinja \\\n    -DBUILD_LAGOM=ON \\\n    -DENABLE_OSS_FUZZ=ON \\\n    -DCMAKE_C_COMPILER=$CC \\\n    -DCMAKE_CXX_COMPILER=$CXX \\\n    -DCMAKE_CXX_FLAGS=\"$CXXFLAGS -DOSS_FUZZ=ON\" \\\n    -DLINKER_FLAGS=\"$LIB_FUZZING_ENGINE\" \\\n    ..\nninja\ncp Fuzzers/Fuzz* $OUT/\n\n", "work_dir": "/src/serenity/Meta/Lagom", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=31351\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5630927108702208\n\nProject: serenity\nFuzzing Engine: libFuzzer\nFuzz Target: FuzzMarkdown\nJob Type: libfuzzer_asan_serenity\nPlatform Id: linux\n\nCrash Type: Global-buffer-overflow READ 1\nCrash Address: 0x0000009c9b84\nCrash State:\n  AK::StringView::operator==\n  Markdown::CodeBlock::parse\n  bool Markdown::helper<Markdown::CodeBlock>\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_serenity&range=202102230604:202102240611\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5630927108702208\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [], "candidate_fixes": [{"sha": "42133a196a0bea83705b5947921d5c7e5b9f201d", "url": "https://github.com/SerenityOS/serenity/commit/42133a196a0bea83705b5947921d5c7e5b9f201d"}]}
{"instance_id": "php.osv-2021-1217", "repo": "php/php-src", "base_commit": "b514e550a243586f8d778a89aaaa68f8f9c11535", "date": "2021-09-09T09:09:13", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout b514e550a243586f8d778a89aaaa68f8f9c11535\nRUN git clone https://github.com/kkos/oniguruma.git php-src/oniguruma\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build oniguruma and link statically\npushd oniguruma\nautoreconf -vfi\n./configure\nmake -j$(nproc)\npopd\nexport ONIG_CFLAGS=\"-I$PWD/oniguruma/src\"\nexport ONIG_LIBS=\"-L$PWD/oniguruma/src/.libs -l:libonig.a\"\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-mbstring \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-mbstring\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=38297\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5446821967691776\n\nProject: php\nFuzzing Engine: honggfuzz\nFuzz Target: php-fuzz-execute\nJob Type: honggfuzz_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 8\nCrash Address: 0x606000011078\nCrash State:\n  ZEND_FETCH_OBJ_R_SPEC_CV_CONST_INLINE_HANDLER\n  ZEND_FETCH_OBJ_R_SPEC_CV_CONST_HANDLER\n  fuzzer_execute_ex\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_php&range=202103150621:202103160620\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5446821967691776\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "6381a16f3f1d0ce5d260f90661a7026b8f05d074", "url": "https://github.com/php/php-src.git/commit/6381a16f3f1d0ce5d260f90661a7026b8f05d074"}]}
{"instance_id": "cyclonedds.osv-2023-273", "repo": "eclipse-cyclonedds/cyclonedds", "base_commit": "090b62ee46e8af9c539b2881aa36787e1de08079", "date": "2023-05-31T00:43:51", "project_name": "cyclonedds", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y \\\n    autoconf \\\n    automake \\\n    libssl-dev \\\n    libcunit1 \\\n    libcunit1-dev \\\n    bison \\\n    libbison-dev\n\nRUN git clone https://github.com/eclipse-cyclonedds/cyclonedds\nRUN git -C cyclonedds checkout 090b62ee46e8af9c539b2881aa36787e1de08079\n\nCOPY build.sh $SRC\nWORKDIR $SRC/cyclonedds\n# This is to fix Fuzz Introspector build by using LLVM old pass manager\n# re https://github.com/ossf/fuzz-introspector/issues/305\nENV OLD_LLVMPASS 1", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nsource fuzz/oss-fuzz-build.sh", "work_dir": "/src/cyclonedds", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=57614\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6189139925270528\n\nProject: cyclonedds\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz_type_object\nJob Type: libfuzzer_asan_cyclonedds\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 8\nCrash Address: 0x61d000003bc8\nCrash State:\n  add_complete_typeobj\n  ddsi_xt_type_add_typeobj\n  ddsi_type_add_typeobj\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_cyclonedds&range=202303140613:202303150608\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6189139925270528\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "708b9211ca8aeb3312b358df81d259c3d3c9fc70", "url": "https://github.com/eclipse-cyclonedds/cyclonedds/commit/708b9211ca8aeb3312b358df81d259c3d3c9fc70"}]}
{"instance_id": "libexif.osv-2021-1169", "repo": "libexif/libexif", "base_commit": "a4647a5463102c4b0c5a02461edd4cc085dfc1b6", "date": "2021-08-25T07:14:37", "project_name": "libexif", "lang": "c++", "dockerfile": "# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool gettext autopoint\nRUN git clone https://github.com/libexif/libexif\nRUN git -C libexif checkout a4647a5463102c4b0c5a02461edd4cc085dfc1b6\nRUN git clone --depth 1 https://github.com/ianare/exif-samples\nWORKDIR libexif\nCOPY exif_loader_fuzzer.cc exif_from_data_fuzzer.cc build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nautoreconf -fiv\n./configure --disable-docs --enable-shared=no --prefix=\"$WORK\"\nmake -j$(nproc)\nmake install\n\npushd $SRC\nmkdir -p exif_corpus\nfind exif-samples -type f -name '*.jpg' -exec mv -n {} exif_corpus/ \\; -o -name '*.tiff' -exec mv -n {} exif_corpus/ \\;\ncp libexif/test/testdata/*.jpg exif_corpus\nzip -r \"$WORK/exif_seed_corpus.zip\" exif_corpus/\npopd\n\nfor fuzzer in $(find $SRC/ -name '*_fuzzer.cc'); do\n  fuzzer_basename=$(basename -s .cc $fuzzer)\n  $CXX $CXXFLAGS \\\n      -std=c++11 \\\n      -I\"$WORK/include\" \\\n      $fuzzer \\\n      -o $OUT/$fuzzer_basename \\\n      $LIB_FUZZING_ENGINE \\\n      \"$WORK/lib/libexif.a\"\n  cp $WORK/exif_seed_corpus.zip \"${OUT}/${fuzzer_basename}_seed_corpus.zip\"\ndone\n", "work_dir": "/src/libexif", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37575\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4577720328126464\n\nProject: libexif\nFuzzing Engine: libFuzzer\nFuzz Target: exif_from_data_fuzzer\nJob Type: libfuzzer_asan_libexif\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x61110000009c\nCrash State:\n  exif_mnote_data_apple_load\n  exif_mnote_data_load\n  interpret_maker_note\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libexif&range=202108150609:202108160616\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4577720328126464\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "exif_from_data_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <libexif/exif-data.h>\n#include <libexif/exif-loader.h>\n#include <stddef.h>\n#include <stdlib.h>\n\n/* Extract all MakerNote tags */\nstatic void mnote_dump(ExifData *data) {\n    ExifMnoteData *mn = exif_data_get_mnote_data(data);\n    if (mn) {\n        int num = exif_mnote_data_count(mn);\n\n        /* Loop through all MakerNote tags */\n        for (int i=0; i < num; ++i) {\n            char buf[1024];\n            exif_mnote_data_get_value(mn, i, buf, sizeof(buf));\n        }\n    }\n}\n\nstatic void dump_value(ExifEntry *entry, void *user_data) {\n  char buf[1024];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nstatic void data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, dump_value, NULL);\n}\n\n/* This is like exif_data_dump but without writing to stdout */\nstatic void data_dump(ExifData *data) {\n  exif_data_foreach_content(data, data_func, NULL);\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n\n  // Parse tags using (ultimately) exif_data_load_data()\n  auto image = exif_data_new_from_data(data, size);\n  if (image) {\n    // Exercise the EXIF tag manipulation code\n    exif_data_get_mnote_data(image);\n    data_dump(image);\n    mnote_dump(image);\n    unsigned char *buf;\n    unsigned int sz;\n    exif_data_save_data(image, &buf, &sz);\n    free(buf);\n    exif_data_fix(image);\n    exif_data_unref(image);\n  }\n\n  return 0;\n}\n"}, {"filename": "exif_loader_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stdio.h>\n#include <stdint.h>\n#include <libexif/exif-loader.h>\n\n\nvoid content_func(ExifEntry *entry, void *user_data) {\n  char buf[10000];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nvoid data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, content_func, NULL);\n}\n\nstatic void\ntest_exif_data (ExifData *d) {\n  unsigned int i, c;\n  char v[1024], *p;\n  ExifMnoteData *md;\n\n  md = exif_data_get_mnote_data (d);\n  if (!md) {\n    return;\n  }\n\n  exif_mnote_data_ref (md);\n  exif_mnote_data_unref (md);\n\n  c = exif_mnote_data_count (md);\n  for (i = 0; i < c; i++) {\n    const char *name = exif_mnote_data_get_name (md, i);\n    if (!name) {\n      break;\n    }\n    exif_mnote_data_get_title (md, i);\n    exif_mnote_data_get_description (md, i);\n    exif_mnote_data_get_value (md, i, v, sizeof (v));\n  }\n}\n\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  ExifLoader *loader = exif_loader_new();\n  ExifData *exif_data;\n  if (!loader) {\n    return 0;\n  }\n  exif_loader_write(loader, const_cast<unsigned char*>(data), size);\n  exif_data = exif_loader_get_data(loader);\n  if(!exif_data) {\n    exif_loader_unref(loader);\n    return 0;\n  }\n  exif_data_foreach_content(exif_data, data_func, NULL);\n  test_exif_data (exif_data);\n  exif_loader_unref(loader);\n  exif_data_unref(exif_data);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "b1e292af7d6ff811755026ec551e37e73ae07469", "url": "https://github.com/libexif/libexif/commit/b1e292af7d6ff811755026ec551e37e73ae07469"}]}
{"instance_id": "pcre2.osv-2023-674", "repo": "pcre2project/pcre2", "base_commit": "5f77d022733a5b7e2ff1e3d80b547c0d89811efe", "date": "2023-08-08T10:15:24", "project_name": "pcre2", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool subversion\n\nRUN git clone https://github.com/PCRE2Project/pcre2 pcre2\nRUN git -C pcre2 checkout 5f77d022733a5b7e2ff1e3d80b547c0d89811efe\nWORKDIR pcre2\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build project\n./autogen.sh\n./configure --enable-fuzz-support --enable-never-backslash-C --with-match-limit=1000 --with-match-limit-depth=1000\nmake -j$(nproc) clean\nmake -j$(nproc) all\n\n# build fuzzer\n$CXX $CXXFLAGS -o $OUT/pcre2_fuzzer \\\n    $LIB_FUZZING_ENGINE .libs/libpcre2-fuzzsupport.a .libs/libpcre2-8.a\n\n# set up dictionary and options to use it\ncp pcre2_fuzzer.options pcre2_fuzzer.dict $OUT/\n", "work_dir": "/src/pcre2", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=61269\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5777252993073152\n\nProject: pcre2\nFuzzing Engine: libFuzzer\nFuzz Target: pcre2_fuzzer\nJob Type: libfuzzer_asan_pcre2\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 4\nCrash Address: 0x619000000484\nCrash State:\n  get_grouplength\n  get_branchlength\n  get_grouplength\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_pcre2&range=202308060619:202308070612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5777252993073152\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "fb1c7d27db09a4d0a2b6e1486c4f1a4d332e8b8c", "url": "https://github.com/PCRE2Project/pcre2/commit/fb1c7d27db09a4d0a2b6e1486c4f1a4d332e8b8c"}]}
{"instance_id": "cyclonedds.osv-2023-556", "repo": "eclipse-cyclonedds/cyclonedds", "base_commit": "5ca03776896510f22d6316bb0f237c786ad280b0", "date": "2023-07-07T00:56:18", "project_name": "cyclonedds", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y \\\n    autoconf \\\n    automake \\\n    libssl-dev \\\n    libcunit1 \\\n    libcunit1-dev \\\n    bison \\\n    libbison-dev\n\nRUN git clone https://github.com/eclipse-cyclonedds/cyclonedds\nRUN git -C cyclonedds checkout 5ca03776896510f22d6316bb0f237c786ad280b0\n\nCOPY build.sh $SRC\nWORKDIR $SRC/cyclonedds\n# This is to fix Fuzz Introspector build by using LLVM old pass manager\n# re https://github.com/ossf/fuzz-introspector/issues/305\nENV OLD_LLVMPASS 1", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nsource fuzz/oss-fuzz-build.sh", "work_dir": "/src/cyclonedds", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=60514\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4530077902438400\n\nProject: cyclonedds\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz_type_object\nJob Type: libfuzzer_asan_cyclonedds\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x602000000930\nCrash State:\n  xt_valid_enum_values\n  xt_validate_impl\n  ddsi_xt_type_add_typeobj\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_cyclonedds&range=202302280604:202303010613\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4530077902438400\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "748f19f0c5da7ecec73d350772c784e46c7d9d64", "url": "https://github.com/eclipse-cyclonedds/cyclonedds/commit/748f19f0c5da7ecec73d350772c784e46c7d9d64"}]}
{"instance_id": "harfbuzz.osv-2018-149", "repo": "harfbuzz/harfbuzz", "base_commit": "00fdbca4f6a5c4623b9c4838da502cccce8aaa74", "date": "2018-10-20T15:20:57", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout 00fdbca4f6a5c4623b9c4838da502cccce8aaa74\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=function,vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=function,vptr\"\n\n# Build the library.\n./autogen.sh\n./configure\nmake clean\nmake -j$(nproc) V=1 all\nmake CPPFLAGS=\"-DHB_NO_VISIBILITY\" -C src V=1 fuzzing\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-fuzzing.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset-fuzzing.a ./src/.libs/libharfbuzz-fuzzing.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nzip -j -r $OUT/hb-shape-fuzzer_seed_corpus.zip $SRC/harfbuzz/test/shaping/data/in-house/fonts $SRC/harfbuzz/test/shaping/data/text-rendering-tests/fonts $SRC/harfbuzz/test/api/fonts $SRC/harfbuzz/test/fuzzing/fonts\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11033\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5718464350650368\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x60b000000209\nCrash State:\n  BEInt<unsigned int, 4>::operator unsigned int\n  AAT::KerxSubTableFormat2::sanitize\n  hb_sanitize_context_t::return_t AAT::KerxTable::dispatch<hb_sanitize_context_t>\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201810130142:201810140143\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5718464350650368\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "68b705076808d4b0a4ac3bfa945b8f9ae23db1df", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/68b705076808d4b0a4ac3bfa945b8f9ae23db1df"}]}
{"instance_id": "espeak-ng.osv-2021-764", "repo": "espeak-ng/espeak-ng", "base_commit": "cd33c4042a022a3e1dea32da4c5541d6ca568cf0", "date": "2022-03-14T23:08:51", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout cd33c4042a022a3e1dea32da4c5541d6ca568cf0\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=34285\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4849410845573120\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Stack-buffer-overflow READ 1\nCrash Address: 0x7fe03240a1cf\nCrash State:\n  TranslateNumber_1\n  TranslateNumber\n  TranslateWord3\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202105130601:202105140612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4849410845573120\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "7b9c99cec7b0c517049d39cbbee610c3a8407fa4", "url": "https://github.com/espeak-ng/espeak-ng/commit/7b9c99cec7b0c517049d39cbbee610c3a8407fa4"}]}
{"instance_id": "exiv2.osv-2022-794", "repo": "exiv2/exiv2", "base_commit": "7a92e1bd0f8a1435eed7743e3aeadcb73f63182d", "date": "2022-08-29T02:15:55", "project_name": "exiv2", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\nFROM hwiwonlee/secb.base:latest\n\nRUN apt-get update && apt-get install -y cmake make ccache python3 libexpat1-dev zlib1g-dev libssh-dev libcurl4-openssl-dev libxml2-utils\nRUN git clone https://github.com/Exiv2/exiv2 exiv2\nRUN git -C exiv2 checkout 7a92e1bd0f8a1435eed7743e3aeadcb73f63182d\nWORKDIR exiv2\n\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Added to fix a false positive result: https://github.com/google/oss-fuzz/issues/6489\nCXXFLAGS=\"${CXXFLAGS} -fno-sanitize=float-divide-by-zero\"\n\n# Build Exiv2\nmkdir -p build\ncd build\ncmake -DEXIV2_ENABLE_PNG=ON -DEXIV2_ENABLE_WEBREADY=ON -DEXIV2_ENABLE_CURL=OFF -DEXIV2_ENABLE_BMFF=ON -DEXIV2_TEAM_WARNINGS_AS_ERRORS=ON -DBUILD_SHARED_LIBS=OFF -DCMAKE_CXX_COMPILER=\"${CXX}\" -DCMAKE_CXX_FLAGS=\"${CXXFLAGS}\" -DEXIV2_BUILD_FUZZ_TESTS=ON -DEXIV2_TEAM_OSS_FUZZ=ON -DLIB_FUZZING_ENGINE=\"${LIB_FUZZING_ENGINE}\" ..\nmake -j $(nproc)\n\n# Copy binary and dictionary to $OUT\ncp ./bin/fuzz-read-print-write $OUT\ncp ../fuzz/exiv2.dict $OUT/fuzz-read-print-write.dict\n\n# Initialize the corpus, using the files in test/data\nmkdir corpus\nfor f in $(find ../test/data -type f -size -20k); do\n    s=$(sha1sum \"$f\" | awk '{print $1}')\n    cp $f corpus/$s\ndone\n\nzip -j $OUT/fuzz-read-print-write.zip corpus/*\n", "work_dir": "/src/exiv2", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=50629\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6752421547737088\n\nProject: exiv2\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz-read-print-write\nJob Type: libfuzzer_asan_exiv2\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 5\nCrash Address: 0x6020000002b4\nCrash State:\n  std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<ch\n  Exiv2::QuickTimeVideo::previewTagDecoder\n  Exiv2::QuickTimeVideo::tagDecoder\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_exiv2&range=202208240610:202208250610\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6752421547737088\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "337fe1854ff17f169032e993789a24bbb53579c4", "url": "https://github.com/Exiv2/exiv2/commit/337fe1854ff17f169032e993789a24bbb53579c4"}]}
{"instance_id": "zstd.osv-2022-110", "repo": "facebook/zstd", "base_commit": "26c36fafb97e5eb45d73bc7489f2efb144b801a8", "date": "2022-02-01T13:10:32", "project_name": "zstd", "lang": "c++", "dockerfile": "# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make python wget\n# Clone source\nRUN git clone https://github.com/facebook/zstd\nRUN git -C zstd checkout 26c36fafb97e5eb45d73bc7489f2efb144b801a8\nWORKDIR zstd\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\ncd tests/fuzz\n\n# Download the seed corpora\nmake -j seedcorpora\n# Build all of the fuzzers\n./fuzz.py build all\n\nfor target in $(./fuzz.py list); do\n    cp \"$target\" \"$OUT\"\n\n    if [ -f \"$target.dict\" ]; then\n        cp \"$target.dict\" \"$OUT\"\n    fi\n\n    cp \"corpora/${target}_seed_corpus.zip\" \"$OUT\"\ndone\n", "work_dir": "/src/zstd", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=44239\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6749389635321856\n\nProject: zstd\nFuzzing Engine: libFuzzer\nFuzz Target: sequence_compression_api\nJob Type: libfuzzer_asan_zstd\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow WRITE 1\nCrash Address: 0x62c0000071b3\nCrash State:\n  ZSTD_compressLiterals\n  ZSTD_entropyCompressSeqStore\n  ZSTD_compressSequences\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_zstd&range=202201260602:202201270601\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6749389635321856\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "cad9f8d5f9c451b1cc8ce00a16c125e3d2ffc418", "url": "https://github.com/facebook/zstd/commit/cad9f8d5f9c451b1cc8ce00a16c125e3d2ffc418"}]}
{"instance_id": "php.osv-2023-1243", "repo": "php/php-src", "base_commit": "9a69bb2d582ed127fb2a82273e9f9b9d6d6e4612", "date": "2023-12-01T03:09:17", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# The current clang revision is broken, pin to older one.\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 9a69bb2d582ed127fb2a82273e9f9b9d6d6e4612\nWORKDIR php-src\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=64579\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6034106571685888\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-function-jit\nJob Type: libfuzzer_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x60800000cf40\nCrash State:\n  zend_reference_destroy\n  rc_dtor_func\n  zend_leave_helper_SPEC\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_php&range=202311280625:202311290620\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6034106571685888\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [], "candidate_fixes": [{"sha": "1e55c9760178f9d5e1de8b251537b3e8ccf44feb", "url": "https://github.com/php/php-src.git/commit/1e55c9760178f9d5e1de8b251537b3e8ccf44feb"}]}
{"instance_id": "wasm3.osv-2021-660", "repo": "wasm3/wasm3", "base_commit": "715a8d04df0a4b07de08213999037f3a028f2ab2", "date": "2021-04-17T17:10:36", "project_name": "wasm3", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\nRUN git clone https://github.com/wasm3/wasm3\nRUN git -C wasm3 checkout 715a8d04df0a4b07de08213999037f3a028f2ab2\nWORKDIR wasm3\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\nmkdir build && cd build\ncmake -DBUILD_WASI=none ..\nmake -j$(nproc)\n$CC $CFLAGS -c $SRC/wasm3/platforms/app_fuzz/fuzzer.c -o fuzzer.o -I/src/wasm3/source\n$CXX $CXXFLAGS $LIB_FUZZING_ENGINE -o $OUT/fuzzer fuzzer.o /src/wasm3/build/source/libm3.a\n", "work_dir": "/src/wasm3", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=33397\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4990068868644864\n\nProject: wasm3\nFuzzing Engine: honggfuzz\nFuzz Target: fuzzer\nJob Type: honggfuzz_asan_wasm3\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x60d0000401dc\nCrash State:\n  op_BranchIfPrologue_s\n  m3_CallVL\n  m3_CallV\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_wasm3&range=202104150622:202104160620\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4990068868644864\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "12a5277ec0977af493530b704a5a16e28f734788", "url": "https://github.com/wasm3/wasm3/commit/12a5277ec0977af493530b704a5a16e28f734788"}]}
{"instance_id": "libraw.osv-2023-184", "repo": "libraw/libraw", "base_commit": "f6a57cfb81561bb9a3bd884795896a61f65ba29e", "date": "2023-02-21T11:54:02", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config zlib1g-dev\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout f6a57cfb81561bb9a3bd884795896a61f65ba29e\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE -lz lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=57105\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4516421182029824\n\nProject: libraw\nFuzzing Engine: honggfuzz\nFuzz Target: libraw_nef_fuzzer\nJob Type: honggfuzz_asan_libraw\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x7f1343c777fd\nCrash State:\n  LibRaw::sget4\n  LibRaw::parseAdobeRAFMakernote\n  LibRaw::parse_tiff_ifd\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_libraw&range=202101290609:202101300625\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4516421182029824\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n#include <fuzzer/FuzzedDataProvider.h>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\nstatic const InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  FuzzedDataProvider fdp(data, size);\n  LibRaw lib_raw;\n\n  for(int i =0; i < 4; i++)\n    lib_raw.output_params_ptr()->aber[i] = fdp.ConsumeFloatingPoint<double>();\n  for(int i =0; i < 4; i++)\n    lib_raw.output_params_ptr()->user_mul[i] = fdp.ConsumeFloatingPoint<float>();\n  for(int i =0; i < 2; i++)\n    lib_raw.output_params_ptr()->gamm[i] = fdp.ConsumeFloatingPoint<double>();\n  lib_raw.output_params_ptr()->bright = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->threshold = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->use_auto_wb = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->output_color = fdp.ConsumeIntegralInRange<int>(0, 6);\n  lib_raw.output_params_ptr()->user_flip = fdp.ConsumeIntegralInRange<int>(0, 7);\n  lib_raw.output_params_ptr()->user_black = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->user_sat = fdp.ConsumeIntegral<int>();\n  lib_raw.output_params_ptr()->auto_bright_thr = fdp.ConsumeFloatingPoint<float>();\n  lib_raw.output_params_ptr()->adjust_maximum_thr = fdp.ConsumeFloatingPointInRange<float>(0.f, 1.f);\n  lib_raw.output_params_ptr()->fbdd_noiserd = fdp.ConsumeIntegralInRange<int>(0, 5);\n\n  std::vector<char> payload = fdp.ConsumeRemainingBytes<char>();\n  int result = lib_raw.open_buffer(payload.data(), payload.size());\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack_thumb();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.raw2image();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n  lib_raw.free_image();\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "e942a7db6b9abdcbaedc8a21400ffc5edacbd9c3", "url": "https://github.com/libraw/libraw/commit/e942a7db6b9abdcbaedc8a21400ffc5edacbd9c3"}]}
{"instance_id": "selinux.osv-2021-1733", "repo": "selinuxproject/selinux", "base_commit": "b2ba721ebba087123f5a527361e9796b6880ab85", "date": "2022-01-05T13:22:45", "project_name": "selinux", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends bison \\\n\tflex \\\n\tgawk \\\n\tgettext \\\n\tmake \\\n\tlibaudit-dev \\\n\tlibbz2-dev \\\n\tlibcap-dev \\\n\tlibcap-ng-dev \\\n\tlibglib2.0-dev \\\n\tlibpcre3-dev\nRUN git clone https://github.com/SELinuxProject/selinux\nRUN git -C selinux checkout b2ba721ebba087123f5a527361e9796b6880ab85\nWORKDIR selinux\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -e\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n./scripts/oss-fuzz.sh\n", "work_dir": "/src/selinux", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=42729\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4758829554860032\n\nProject: selinux\nFuzzing Engine: libFuzzer\nFuzz Target: binpolicy-fuzzer\nJob Type: libfuzzer_asan_selinux\nPlatform Id: linux\n\nCrash Type: UNKNOWN READ\nCrash Address: 0x0000003ffff8\nCrash State:\n  mls_semantic_level_expand\n  policydb_user_cache\n  hashtab_map\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_selinux&range=202112171200:202112171800\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4758829554860032\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "b78560fd372e01c11ca4f183f929d99b1f89f314", "url": "https://github.com/SELinuxProject/selinux/commit/b78560fd372e01c11ca4f183f929d99b1f89f314"}]}
{"instance_id": "icu.osv-2024-10", "repo": "unicode-org/icu", "base_commit": "906093f31b44316ba7da24972f95a0510355e61d", "date": "2024-01-10T03:30:32", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout 906093f31b44316ba7da24972f95a0510355e61d\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# need \"-p\" as otherwise centipede fails\nmkdir -p $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n# Pick up additional flags (-std=...) added by runConfigureICU.\nCXXFLAGS=\"$CXXFLAGS $(config/icu-config --noverify --cxxflags)\"\n\n$CXX $CXXFLAGS -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu/icu4c/source/common \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=65632\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6262084203511808\n\nProject: icu\nFuzzing Engine: libFuzzer\nFuzz Target: collator_compare_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 2\nCrash Address: 0x6020000000d4\nCrash State:\n  __string\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=202401050623:202401060621\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6262084203511808\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "23d1fc5989c87d5a0572eed54f7c1000f1e3e71b", "url": "https://github.com/unicode-org/icu.git/commit/23d1fc5989c87d5a0572eed54f7c1000f1e3e71b"}]}
{"instance_id": "openjpeg.osv-2017-5", "repo": "uclouvain/openjpeg", "base_commit": "8f92fc97913bec7ffa2dc10d062c0cdd19da20e4", "date": "2017-08-28T08:57:49", "project_name": "openjpeg", "lang": "c++", "dockerfile": "# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER antonin@gmail.com\nRUN apt-get update && apt-get install -y make cmake g++\nRUN git clone https://github.com/uclouvain/openjpeg openjpeg\nRUN git -C openjpeg checkout 8f92fc97913bec7ffa2dc10d062c0cdd19da20e4\n# openjpeg-data is used to create a seed corpus\nRUN git clone --depth 1 https://github.com/uclouvain/openjpeg-data openjpeg/data\nWORKDIR openjpeg\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2017 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir build\ncd build\ncmake ..\nmake clean -s\nmake -j$(nproc) -s\ncd ..\n\n./tests/fuzzers/build_google_oss_fuzzers.sh\n./tests/fuzzers/build_seed_corpus.sh\n", "work_dir": "/src/openjpeg", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=3115\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=4717233764827136\n\nProject: openjpeg\nFuzzer: libFuzzer_openjpeg_opj_decompress_fuzzer\nFuzz target binary: opj_decompress_fuzzer\nJob Type: libfuzzer_asan_openjpeg\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x60d000001200\nCrash State:\n  opj_dwt_interleave_partial_v\n  opj_dwt_decode_partial_tile\n  opj_tcd_dwt_decode\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_openjpeg&range=201708210414:201708220124\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4717233764827136\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you have questions for the OSS-Fuzz team, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [], "candidate_fixes": [{"sha": "a55c024fc6b917a409b85aeafd7326421c4aea34", "url": "https://github.com/uclouvain/openjpeg/commit/a55c024fc6b917a409b85aeafd7326421c4aea34"}]}
{"instance_id": "mruby.osv-2023-366", "repo": "mruby/mruby", "base_commit": "0bb08718b8cab3d6c63d5762ab2dca5417ddf17c", "date": "2023-06-05T10:31:36", "project_name": "mruby", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y build-essential ruby bison ninja-build \\\n    cmake zlib1g-dev libbz2-dev liblzma-dev\nRUN git clone https://github.com/mruby/mruby mruby\nRUN git -C mruby checkout 0bb08718b8cab3d6c63d5762ab2dca5417ddf17c\nRUN git clone --depth 1 https://github.com/bshastry/mruby_seeds.git mruby_seeds\nRUN git clone --depth 1 https://github.com/google/libprotobuf-mutator.git\nRUN mkdir LPM; \\\n  cd LPM; \\\n  cmake $SRC/libprotobuf-mutator -GNinja -DLIB_PROTO_MUTATOR_DOWNLOAD_PROTOBUF=ON -DLIB_PROTO_MUTATOR_TESTING=OFF -DCMAKE_BUILD_TYPE=Release; \\\n  ninja;\n\nCOPY build.sh $SRC", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Instrument mruby\n(\ncd $SRC/mruby\nexport LD=$CC\nexport LDFLAGS=\"$CFLAGS\"\nrake -m\n\n# build fuzzers\nFUZZ_TARGET=$SRC/mruby/oss-fuzz/mruby_fuzzer.c\nname=$(basename $FUZZ_TARGET .c)\n$CC -c $CFLAGS -Iinclude \\\n     ${FUZZ_TARGET} -o $OUT/${name}.o\n$CXX $CXXFLAGS $OUT/${name}.o $LIB_FUZZING_ENGINE -lm \\\n    $SRC/mruby/build/host/lib/libmruby.a -o $OUT/${name}\nrm -f $OUT/${name}.o\n)\n\n# Construct options files\ncat > $SRC/mruby/oss-fuzz/config/mruby_fuzzer.options <<EOF\n[libfuzzer]\ndict = mruby.dict\nonly_ascii = 1\nEOF\ncp $SRC/mruby/oss-fuzz/config/mruby_fuzzer.options $SRC/mruby/oss-fuzz/config/mruby_proto_fuzzer.options\n\n# Build proto fuzzer: ASan and UBSan\nif [[ $CFLAGS != *sanitize=memory* ]]; then\n    PROTO_FUZZ_TARGET=$SRC/mruby/oss-fuzz/mruby_proto_fuzzer.cpp\n    PROTO_CONVERTER=$SRC/mruby/oss-fuzz/proto_to_ruby.cpp\n    rm -rf $SRC/mruby/genfiles\n    mkdir $SRC/mruby/genfiles\n    $SRC/LPM/external.protobuf/bin/protoc --proto_path=$SRC/mruby/oss-fuzz ruby.proto --cpp_out=$SRC/mruby/genfiles\n    $CXX -c $CXXFLAGS $SRC/mruby/genfiles/ruby.pb.cc -DNDEBUG -o $SRC/mruby/genfiles/ruby.pb.o -I $SRC/LPM/external.protobuf/include\n    $CXX -I $SRC/mruby/include -I $SRC/LPM/external.protobuf/include $CXXFLAGS $PROTO_FUZZ_TARGET $SRC/mruby/genfiles/ruby.pb.o $PROTO_CONVERTER \\\n      -I $SRC/mruby/genfiles \\\n      -I $SRC/libprotobuf-mutator \\\n      -I $SRC/mruby/include -lz -lm \\\n      $SRC/LPM/src/libfuzzer/libprotobuf-mutator-libfuzzer.a \\\n      $SRC/LPM/src/libprotobuf-mutator.a \\\n      -Wl,--start-group $SRC/LPM/external.protobuf/lib/lib*.a -Wl,--end-group \\\n      $SRC/mruby/build/host/lib/libmruby.a \\\n      $LIB_FUZZING_ENGINE \\\n      -o $OUT/mruby_proto_fuzzer\n\n    # Copy config\n    cp $SRC/mruby/oss-fuzz/config/mruby_proto_fuzzer.options $OUT\nfi\n\n# dict and config\ncp $SRC/mruby/oss-fuzz/config/mruby.dict $OUT\ncp $SRC/mruby/oss-fuzz/config/mruby_fuzzer.options $OUT\n\n# seeds\nzip -rq $OUT/mruby_fuzzer_seed_corpus $SRC/mruby_seeds\n", "work_dir": "/src/mruby", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=58577\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6042731473666048\n\nProject: mruby\nFuzzing Engine: libFuzzer\nFuzz Target: mruby_fuzzer\nJob Type: libfuzzer_asan_mruby\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x62f000043c60\nCrash State:\n  gc_mark_children\n  incremental_gc\n  mrb_full_gc\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_mruby&range=202212060611:202212070606\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6042731473666048\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "b47c8b738ae3e400ec02269fae9857222218e9d5", "url": "https://github.com/mruby/mruby/commit/b47c8b738ae3e400ec02269fae9857222218e9d5"}]}
{"instance_id": "exiv2.osv-2022-223", "repo": "exiv2/exiv2", "base_commit": "6e9eca445aa6fffa308e30fcf0168cb28c106a70", "date": "2022-04-06T08:53:33", "project_name": "exiv2", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\nFROM hwiwonlee/secb.base:latest\n\nRUN apt-get update && apt-get install -y cmake make ccache python3 libexpat1-dev zlib1g-dev libssh-dev libcurl4-openssl-dev libxml2-utils\nRUN git clone https://github.com/Exiv2/exiv2 exiv2\nRUN git -C exiv2 checkout 6e9eca445aa6fffa308e30fcf0168cb28c106a70\nWORKDIR exiv2\n\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Added to fix a false positive result: https://github.com/google/oss-fuzz/issues/6489\nCXXFLAGS=\"${CXXFLAGS} -fno-sanitize=float-divide-by-zero\"\n\n# Build Exiv2\nmkdir -p build\ncd build\ncmake -DEXIV2_ENABLE_PNG=ON -DEXIV2_ENABLE_WEBREADY=ON -DEXIV2_ENABLE_CURL=OFF -DEXIV2_ENABLE_BMFF=ON -DEXIV2_TEAM_WARNINGS_AS_ERRORS=ON -DBUILD_SHARED_LIBS=OFF -DCMAKE_CXX_COMPILER=\"${CXX}\" -DCMAKE_CXX_FLAGS=\"${CXXFLAGS}\" -DEXIV2_BUILD_FUZZ_TESTS=ON -DEXIV2_TEAM_OSS_FUZZ=ON -DLIB_FUZZING_ENGINE=\"${LIB_FUZZING_ENGINE}\" ..\nmake -j $(nproc)\n\n# Copy binary and dictionary to $OUT\ncp ./bin/fuzz-read-print-write $OUT\ncp ../fuzz/exiv2.dict $OUT/fuzz-read-print-write.dict\n\n# Initialize the corpus, using the files in test/data\nmkdir corpus\nfor f in $(find ../test/data -type f -size -20k); do\n    s=$(sha1sum \"$f\" | awk '{print $1}')\n    cp $f corpus/$s\ndone\n\nzip -j $OUT/fuzz-read-print-write.zip corpus/*\n", "work_dir": "/src/exiv2", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45302\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4560990975426560\n\nProject: exiv2\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz-read-print-write\nJob Type: libfuzzer_asan_exiv2\nPlatform Id: linux\n\nCrash Type: Container-overflow READ 4\nCrash Address: 0x63100003c88e\nCrash State:\n  Exiv2::Photoshop::locateIrb\n  Exiv2::Photoshop::setIptcIrb\n  Exiv2::JpegBase::doWriteMetadata\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_exiv2&range=202203040604:202203050613\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4560990975426560\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "e715243aa51fa38a89d35ea377d267600217e192", "url": "https://github.com/Exiv2/exiv2/commit/e715243aa51fa38a89d35ea377d267600217e192"}]}
{"instance_id": "libdwarf.osv-2022-389", "repo": "davea42/libdwarf-code", "base_commit": "436ea0d3fd7bef82679be01af8ce69e3f84e1c62", "date": "2022-07-23T10:40:32", "project_name": "libdwarf-code", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool\nRUN git clone https://github.com/davea42/libdwarf-code libdwarf\nRUN git -C libdwarf checkout 436ea0d3fd7bef82679be01af8ce69e3f84e1c62\nRUN git clone --depth=1 https://github.com/DavidKorczynski/binary-samples $SRC/binary-samples\nWORKDIR libdwarf\nCOPY build.sh $SRC/\nCOPY fuzz*.c $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nexport CFLAGS=\"${CFLAGS} -g -Werror\"\nexport CXXFLAGS=\"${CXXFLAGS} -g -Werror\"\n\nmkdir build\ncd build\ncmake ../\nmake\n\n# Build corpus for fuzzing\nmkdir $SRC/corp\ncp $SRC/binary-samples/elf* $SRC/corp\ncp $SRC/binary-samples/Mach* $SRC/corp\ncp $SRC/binary-samples/pe* $SRC/corp\ncp $SRC/binary-samples/lib* $SRC/corp\n\nzip -r -j $OUT/fuzz_init_path_seed_corpus.zip $SRC/corp\ncp $OUT/fuzz_init_path_seed_corpus.zip $OUT/fuzz_init_binary_seed_corpus.zip\n\nfor fuzzName in init_path init_binary; do\n  $CC $CFLAGS $LIB_FUZZING_ENGINE -I../src/lib/libdwarf/ \\\n    $SRC/fuzz_${fuzzName}.c -o $OUT/fuzz_${fuzzName} ./src/lib/libdwarf/libdwarf.a\ndone\n", "work_dir": "/src/libdwarf", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=47150\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6727387238236160\n\nProject: libdwarf\nFuzzing Engine: honggfuzz\nFuzz Target: fuzz_init_path\nJob Type: honggfuzz_asan_libdwarf\nPlatform Id: linux\n\nCrash Type: Global-buffer-overflow READ 1\nCrash Address: 0x00000064d0c1\nCrash State:\n  _dwarf_pathjoinl\n  _dwarf_construct_linkedto_path\n  dwarf_gnu_debuglink\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_libdwarf&range=202204290611:202204300608\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6727387238236160\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "fuzz_init_binary.c", "content": "/* Copyright 2021 Google LLC\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n      http://www.apache.org/licenses/LICENSE-2.0\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n#include <stdint.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n\n/*\n * Libdwarf library callers can only use these headers.\n */\n#include \"dwarf.h\"\n#include \"libdwarf.h\"\n\n/*\n * A fuzzer that simulates a small part of the simplereader.c example.\n * This fuzzer targets dwarf_init_b.\n */\nint LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  char filename[256];\n  sprintf(filename, \"/tmp/libfuzzer.%d\", getpid());\n\n  FILE *fp = fopen(filename, \"wb\");\n  if (!fp) {\n    return 0;\n  }\n  fwrite(data, size, 1, fp);\n  fclose(fp);\n\n  int my_init_fd = 0;\n  Dwarf_Ptr errarg = 0;\n  Dwarf_Handler errhand = 0;\n  Dwarf_Error *errp = NULL;\n  Dwarf_Debug dbg = 0;\n\n  my_init_fd = open(filename, O_RDONLY);\n  if (my_init_fd != -1) {\n    dwarf_init_b(my_init_fd,DW_GROUPNUMBER_ANY,errhand,errarg,&dbg,errp);\n    dwarf_finish(dbg);\n    close(my_init_fd);\n  }\n\n  unlink(filename);\n  return 0;\n}\n"}, {"filename": "fuzz_init_path.c", "content": "/* Copyright 2021 Google LLC\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n      http://www.apache.org/licenses/LICENSE-2.0\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n#include <stdint.h>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include <unistd.h>\n\n/*\n * Libdwarf library callers can only use these headers.\n */\n#include \"dwarf.h\"\n#include \"libdwarf.h\"\n\n/*\n * A fuzzer that simulates a small part of the simplereader.c example.\n */\nint LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  char filename[256];\n  sprintf(filename, \"/tmp/libfuzzer.%d\", getpid());\n\n  FILE *fp = fopen(filename, \"wb\");\n  if (!fp) {\n    return 0;\n  }\n  fwrite(data, size, 1, fp);\n  fclose(fp);\n  Dwarf_Ptr errarg = 0;\n  Dwarf_Handler errhand = 0;\n  Dwarf_Debug dbg = 0;\n  Dwarf_Error *errp = NULL;\n#define MACHO_PATH_LEN 2000\n  char macho_real_path[2000];\n  dwarf_init_path(filename, macho_real_path, MACHO_PATH_LEN,\n                  DW_GROUPNUMBER_ANY, errhand, errarg, &dbg, errp);\n\n  dwarf_finish(dbg);\n\n  unlink(filename);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "24dff940cc4c71a9c3cb5475aee231b19163a12c", "url": "https://github.com/davea42/libdwarf-code/commit/24dff940cc4c71a9c3cb5475aee231b19163a12c"}]}
{"instance_id": "pcre2.osv-2023-673", "repo": "pcre2project/pcre2", "base_commit": "b0b3fc4c4bc4bd8ada9ada3292a28a44570794f1", "date": "2023-08-06T12:21:17", "project_name": "pcre2", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool subversion\n\nRUN git clone https://github.com/PCRE2Project/pcre2 pcre2\nRUN git -C pcre2 checkout b0b3fc4c4bc4bd8ada9ada3292a28a44570794f1\nWORKDIR pcre2\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build project\n./autogen.sh\n./configure --enable-fuzz-support --enable-never-backslash-C --with-match-limit=1000 --with-match-limit-depth=1000\nmake -j$(nproc) clean\nmake -j$(nproc) all\n\n# build fuzzer\n$CXX $CXXFLAGS -o $OUT/pcre2_fuzzer \\\n    $LIB_FUZZING_ENGINE .libs/libpcre2-fuzzsupport.a .libs/libpcre2-8.a\n\n# set up dictionary and options to use it\ncp pcre2_fuzzer.options pcre2_fuzzer.dict $OUT/\n", "work_dir": "/src/pcre2", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=61268\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5439866803191808\n\nProject: pcre2\nFuzzing Engine: libFuzzer\nFuzz Target: pcre2_fuzzer\nJob Type: libfuzzer_asan_pcre2\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x6020000000ba\nCrash State:\n  match\n  pcre2_match_8\n  pcre2_fuzzsupport.c\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_pcre2&range=202308060619:202308070612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5439866803191808\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "5f77d022733a5b7e2ff1e3d80b547c0d89811efe", "url": "https://github.com/PCRE2Project/pcre2/commit/5f77d022733a5b7e2ff1e3d80b547c0d89811efe"}]}
{"instance_id": "espeak-ng.osv-2021-787", "repo": "espeak-ng/espeak-ng", "base_commit": "9de65fcb96f7150e899a882460ab8caa57c6efac", "date": "2022-06-30T02:44:15", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout 9de65fcb96f7150e899a882460ab8caa57c6efac\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=34533\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5632950604529664\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x602000000153\nCrash State:\n  string_decoder_getc_utf_8\n  text_decoder_getc\n  GetC\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202105130601:202105140612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5632950604529664\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "9decedb8c229e1a4219baceaab7a3d656e889e31", "url": "https://github.com/espeak-ng/espeak-ng/commit/9decedb8c229e1a4219baceaab7a3d656e889e31"}]}
{"instance_id": "icu.osv-2021-1206", "repo": "unicode-org/icu", "base_commit": "29443b8be710640ded073116b768da35f00cf0dd", "date": "2021-09-15T13:43:15", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout 29443b8be710640ded073116b768da35f00cf0dd\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=38156\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4509226890821632\n\nProject: icu\nFuzzing Engine: libFuzzer\nFuzz Target: uloc_canonicalize_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: Stack-use-after-scope READ 1\nCrash Address: 0x7fff22d2f2dd\nCrash State:\n  uprv_stricmp_70\n  ulocimp_getLanguage_70\n  _canonicalize\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=202109030601:202109050610\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4509226890821632\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "adb109f440f5dc9c7bb9f2b1df3a9d63109aa585", "url": "https://github.com/unicode-org/icu.git/commit/adb109f440f5dc9c7bb9f2b1df3a9d63109aa585"}]}
{"instance_id": "php.osv-2022-235", "repo": "php/php-src", "base_commit": "6e8f2ba6b87e65069895bc7839c9e9416865e807", "date": "2022-10-24T06:42:41", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# The current clang revision is broken, pin to older one.\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 6e8f2ba6b87e65069895bc7839c9e9416865e807\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=45369\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6096176166862848\n\nProject: php\nFuzzing Engine: honggfuzz\nFuzz Target: php-fuzz-execute\nJob Type: honggfuzz_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x7fd1cbbfb810\nCrash State:\n  zend_gc_collect_cycles\n  fuzzer_request_shutdown\n  fuzzer_do_request_from_buffer\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_php&range=202202110604:202202120607\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6096176166862848\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "c4ecd82f9399850a36bf2466d0a54a045b6dfa15", "url": "https://github.com/php/php-src.git/commit/c4ecd82f9399850a36bf2466d0a54a045b6dfa15"}]}
{"instance_id": "sleuthkit.osv-2021-1380", "repo": "sleuthkit/sleuthkit", "base_commit": "ce1c9c61c8168d0292842fcdd53275fc4459f02d", "date": "2022-01-05T11:02:20", "project_name": "sleuthkit", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool\nRUN git clone https://github.com/sleuthkit/sleuthkit sleuthkit\nRUN git -C sleuthkit checkout ce1c9c61c8168d0292842fcdd53275fc4459f02d\nWORKDIR sleuthkit\nCOPY build.sh buildcorpus.sh sleuthkit_mem_img.h *_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nexport CFLAGS=\"$CFLAGS -Wno-error=non-c-typedef-for-linkage\"\nexport CXXFLAGS=\"$CXXFLAGS -Wno-error=non-c-typedef-for-linkage\"\n\n# Dont fail if some of the seed downloads fail.\n${SRC}/buildcorpus.sh || true\n\n./bootstrap\n./configure --enable-static --disable-shared --disable-java --without-afflib --without-libewf --without-libvhdi --without-libvmdk\nmake -j$(nproc)\n\ndeclare -A TSK_FS_TYPES=(\n  [\"ext\"]=\"TSK_FS_TYPE_EXT_DETECT\"\n  [\"fat\"]=\"TSK_FS_TYPE_FAT_DETECT\"\n  [\"hfs\"]=\"TSK_FS_TYPE_HFS\"\n  [\"ntfs\"]=\"TSK_FS_TYPE_NTFS\"\n  [\"iso9660\"]=\"TSK_FS_TYPE_ISO9660\"\n)\n\ndeclare -A TSK_VS_TYPES=(\n  [\"dos\"]=\"TSK_VS_TYPE_DOS\"\n  [\"gpt\"]=\"TSK_VS_TYPE_GPT\"\n  [\"mac\"]=\"TSK_VS_TYPE_MAC\"\n  [\"sun\"]=\"TSK_VS_TYPE_SUN\"\n)\n\n# The fls APFS fuzz target has a seperate source file since it uses the libtsk\n# pool layer.\n$CXX $CXXFLAGS -std=c++14 -I.. -I. -Itsk \\\n    $SRC/sleuthkit_fls_apfs_fuzzer.cc -o $OUT/sleuthkit_fls_apfs_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/sleuthkit/tsk/.libs/libtsk.a\n\nfor type in ${!TSK_FS_TYPES[@]}; do\n  $CXX $CXXFLAGS -std=c++14 -I.. -I. -Itsk -DFSTYPE=${TSK_FS_TYPES[$type]} \\\n      $SRC/sleuthkit_fls_fuzzer.cc -o $OUT/sleuthkit_fls_${type}_fuzzer \\\n      $LIB_FUZZING_ENGINE $SRC/sleuthkit/tsk/.libs/libtsk.a\ndone\n\nfor type in ${!TSK_VS_TYPES[@]}; do\n  $CXX $CXXFLAGS -std=c++14 -I.. -I. -Itsk -DVSTYPE=${TSK_VS_TYPES[$type]} \\\n      $SRC/sleuthkit_mmls_fuzzer.cc -o $OUT/sleuthkit_mmls_${type}_fuzzer \\\n      $LIB_FUZZING_ENGINE $SRC/sleuthkit/tsk/.libs/libtsk.a\ndone\n", "work_dir": "/src/sleuthkit", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39317\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5756145092919296\n\nProject: sleuthkit\nFuzzing Engine: libFuzzer\nFuzz Target: sleuthkit_fls_ntfs_fuzzer\nJob Type: libfuzzer_asan_sleuthkit\nPlatform Id: linux\n\nCrash Type: Negative-size-param\nCrash Address:\nCrash State:\n  ntfs_attr_walk_special\n  tsk_fs_attr_walk\n  ntfs_proc_attrseq\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_sleuthkit&range=202109240601:202109260610\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5756145092919296\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "buildcorpus.sh", "content": "#!/bin/bash -eu\n#\n# Script to downloads test data and build the corpus\n#\n# Copyright 2021 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Test data provided by:\n#\n# The Fuzzing Project: https://fuzzing-project.org/resources.html\n#   As CC0 1.0 Universal (CC0 1.0) Public Domain Dedication\n#   https://creativecommons.org/publicdomain/zero/1.0/\n#\n# The dfVFS project: https://github.com/log2timeline/dfvfs\n#   As Apache 2 https://github.com/log2timeline/dfvfs/blob/main/LICENSE\n\n# Files to use for fls fuzz targets\ndeclare -A FLS_TEST_FILES=(\n  [\"apfs\"]=\"https://github.com/log2timeline/dfvfs/blob/main/test_data/apfs.raw?raw=true\"\n  [\"ext\"]=\"https://files.fuzzing-project.org/filesystems/ext2.img\"\n  [\"fat\"]=\"https://files.fuzzing-project.org/filesystems/exfat.img https://files.fuzzing-project.org/filesystems/fat12.img https://files.fuzzing-project.org/filesystems/fat16.img https://files.fuzzing-project.org/filesystems/fat32.img\"\n  [\"hfs\"]=\"https://files.fuzzing-project.org/filesystems/hfsplus.img\"\n  [\"iso9660\"]=\"https://files.fuzzing-project.org/discimages/iso9660.iso\"\n  [\"ntfs\"]=\"https://files.fuzzing-project.org/filesystems/ntfs.img\"\n)\n\n# Files to use for mmls fuzz targets\ndeclare -A MMLS_TEST_FILES=(\n  [\"dos\"]=\"https://files.fuzzing-project.org/discimages/partition-dos\"\n  [\"gpt\"]=\"https://files.fuzzing-project.org/discimages/partition-gpt\"\n  [\"mac\"]=\"https://files.fuzzing-project.org/discimages/partition-mac\"\n)\n\n\nfor type in ${!FLS_TEST_FILES[@]}; do\n  fuzz_target=\"sleuthkit_fls_${type}_fuzzer\"\n\n  mkdir -p \"test_data/${fuzz_target}\"\n\n  IFS=\" \"; for url in ${FLS_TEST_FILES[$type]}; do\n    filename=$( echo ${url} | sed 's/?[^?]*$//' )\n    filename=$( basename ${filename} )\n\n    curl -L -o \"test_data/${fuzz_target}/${filename}\" \"${url}\"\n  done\n\n  (cd \"test_data/${fuzz_target}\" && zip ${OUT}/${fuzz_target}_seed_corpus.zip *)\ndone\n\n\nfor type in ${!MMLS_TEST_FILES[@]}; do\n  fuzz_target=\"sleuthkit_mmls_${type}_fuzzer\"\n\n  mkdir -p \"test_data/${fuzz_target}\"\n\n  IFS=\" \"; for url in ${MMLS_TEST_FILES[$type]}; do\n    filename=$( echo ${url} | sed 's/?[^?]*$//' )\n    filename=$( basename ${filename} )\n\n    curl -L -o \"test_data/${fuzz_target}/${filename}\" \"${url}\"\n  done\n\n  (cd \"test_data/${fuzz_target}\" && zip ${OUT}/${fuzz_target}_seed_corpus.zip *)\ndone\n"}, {"filename": "sleuthkit_fls_apfs_fuzzer.cc", "content": "// Copyright 2021 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n#include \"sleuthkit/tsk/fs/tsk_fs.h\"\n#include \"sleuthkit/tsk/pool/tsk_pool.h\"\n#include \"sleuthkit_mem_img.h\"\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  TSK_IMG_INFO* img;\n  TSK_IMG_INFO* pool_img;\n  TSK_FS_INFO* fs;\n  const TSK_POOL_INFO* pool;\n\n  img = mem_open(data, size);\n  if (img == nullptr) {\n    return 0;\n  }\n  pool = tsk_pool_open_img_sing(img, 0, TSK_POOL_TYPE_APFS);\n\n  if (pool == nullptr) {\n    goto out_img;\n  }\n  // Pool start block is APFS container specific and is hard coded for now\n  pool_img = pool->get_img_info(pool, (TSK_DADDR_T) 106);\n\n  if (pool_img == nullptr) {\n    goto out_pool;\n  }\n  fs = tsk_fs_open_img_decrypt(pool_img, 0, TSK_FS_TYPE_APFS_DETECT, \"\");\n\n  if (fs != nullptr) {\n    tsk_fs_fls(fs, TSK_FS_FLS_FULL, fs->root_inum, TSK_FS_DIR_WALK_FLAG_RECURSE, nullptr, 0);\n\n    fs->close(fs);\n  }\n  tsk_img_close(pool_img);\n\nout_pool:\n  tsk_pool_close(pool);\n\nout_img:\n  tsk_img_close(img);\n\n  return 0;\n}\n"}, {"filename": "sleuthkit_fls_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n#include \"sleuthkit_mem_img.h\"\n\n#ifndef FSTYPE\n#error Define FSTYPE as a valid value of TSK_FS_TYPE_ENUM.\n#endif\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  TSK_IMG_INFO *img;\n  TSK_FS_INFO *fs;\n\n  img = mem_open(data, size);\n  if (img == nullptr)\n    return 0;\n\n  fs = tsk_fs_open_img(img, 0, FSTYPE);\n  if (fs != nullptr) {\n    tsk_fs_fls(fs, TSK_FS_FLS_FULL, fs->root_inum, TSK_FS_DIR_WALK_FLAG_RECURSE,\n               nullptr, 0);\n\n    fs->close(fs);\n  }\n\n  img->close(img);\n  return 0;\n}\n"}, {"filename": "sleuthkit_mem_img.h", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#ifndef MEM_IMG_H\n#define MEM_IMG_H\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n\ntypedef struct {\n  TSK_IMG_INFO img_info;\n  const uint8_t *data;\n  size_t size;\n} IMG_MEM_INFO;\n\nstatic ssize_t mem_read(TSK_IMG_INFO *img_info, TSK_OFF_T offset, char *buf,\n                        size_t len) {\n  IMG_MEM_INFO *mem_info = reinterpret_cast<IMG_MEM_INFO *>(img_info);\n  // Bounds-checking exists in the real drivers.\n  if (offset > mem_info->size) {\n    return -1;\n  }\n  ssize_t read_len = len;\n  if (offset + len > mem_info->size) {\n    read_len = mem_info->size - offset;\n  }\n  if (memcpy(buf, mem_info->data + offset, read_len) == nullptr) {\n    return -1;\n  } else {\n    return read_len;\n  }\n}\n\nstatic void mem_close(TSK_IMG_INFO *img_info) {\n  IMG_MEM_INFO *mem_info = reinterpret_cast<IMG_MEM_INFO *>(img_info);\n  tsk_deinit_lock(&(img_info->cache_lock));\n  free(mem_info);\n}\n\nstatic void mem_imgstat(TSK_IMG_INFO *img_info, FILE *hFile) {}\n\nTSK_IMG_INFO *mem_open(const uint8_t *data, size_t size) {\n  IMG_MEM_INFO *inmemory_img =\n      reinterpret_cast<IMG_MEM_INFO *>(malloc(sizeof(IMG_MEM_INFO)));\n  TSK_IMG_INFO *img;\n  if (inmemory_img == nullptr) {\n    return nullptr;\n  }\n  img = reinterpret_cast<TSK_IMG_INFO *>(inmemory_img);\n  img->itype = TSK_IMG_TYPE_RAW;\n  img->read = mem_read;\n  img->close = mem_close;\n  img->imgstat = mem_imgstat;\n  img->size = size;\n  img->sector_size = 512;\n  tsk_init_lock(&(img->cache_lock));\n  inmemory_img->data = data;\n  inmemory_img->size = size;\n  return img;\n}\n\n#endif // # MEM_IMG_H\n"}, {"filename": "sleuthkit_mmls_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include \"sleuthkit/tsk/tsk_tools_i.h\"\n#include \"sleuthkit_mem_img.h\"\n\n#ifndef VSTYPE\n#error Define VSTYPE as a valid value of TSK_VS_TYPE_ENUM.\n#endif\n\nstatic TSK_WALK_RET_ENUM part_act(TSK_VS_INFO *vs, const TSK_VS_PART_INFO *part,\n                                  void *ptr) {\n  return TSK_WALK_CONT;\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  TSK_IMG_INFO *img;\n  TSK_VS_INFO *vs;\n\n  img = mem_open(data, size);\n  if (img == nullptr)\n    return 0;\n\n  vs = tsk_vs_open(img, 0, VSTYPE);\n  if (vs != nullptr) {\n    tsk_vs_part_walk(vs, 0, vs->part_count - 1, TSK_VS_PART_FLAG_ALL, part_act,\n                     nullptr);\n\n    tsk_vs_close(vs);\n  }\n\n  img->close(img);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "0c25e58d667a9c605dfc250671cb9dc7796e5a22", "url": "https://github.com/sleuthkit/sleuthkit/commit/0c25e58d667a9c605dfc250671cb9dc7796e5a22"}]}
{"instance_id": "harfbuzz.osv-2018-61", "repo": "harfbuzz/harfbuzz", "base_commit": "a3fa7d33360a58df5333dbbd121328e580f08849", "date": "2019-01-14T14:37:36", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout a3fa7d33360a58df5333dbbd121328e580f08849\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr\"\n\n# Build the library.\n./autogen.sh\n./configure --enable-static --disable-shared\nmake clean\nmake -j$(nproc) CPPFLAGS=\"-DHB_NO_VISIBILITY\" V=1 all\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset.a ./src/.libs/libharfbuzz.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shaping/data/in-house/fonts \\\n\ttest/shaping/data/aots/fonts \\\n\ttest/shaping/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=12312\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5631444412530688\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 2\nCrash Address: 0x613000000350\nCrash State:\n  BEInt<unsigned short, 2>::operator unsigned short\n  OT::IntType<unsigned short, 2u>::operator unsigned int\n  OT::OffsetTo<OT::UnsizedOffsetListOf<AAT::Lookup<OT::IntType<unsigned short, 2u>\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201812010220:201812020220\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5631444412530688\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "7a6686a589ed6bf17a5af0b8012501e4d4ee2ded", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/7a6686a589ed6bf17a5af0b8012501e4d4ee2ded"}]}
{"instance_id": "c-ares.osv-2020-569", "repo": "c-ares/c-ares", "base_commit": "c5bfbe0dc3086b39218a4d9a8ef2ce4f538673da", "date": "2019-06-19T08:22:39", "project_name": "c-ares", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool\nRUN git clone https://github.com/c-ares/c-ares.git\nRUN git -C c-ares checkout c5bfbe0dc3086b39218a4d9a8ef2ce4f538673da\nWORKDIR c-ares\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Remove -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION from CFLAGS\n# as a workaround for https://github.com/google/oss-fuzz/issues/413.\n# It's unclear why the c-ares configure is that picky;\n# a better fix would probably be in the c-ares build system.\nCFLAGS=$(for f in $CFLAGS; do [ $f != \"-DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\" ] && echo $f; done);\n\n# Build the project.\n./buildconf\n./configure --enable-debug\nmake clean\nmake -j$(nproc) V=1 all\n\n# Build the fuzzers.\n$CC $CFLAGS -I. -c $SRC/c-ares/test/ares-test-fuzz.c -o $WORK/ares-test-fuzz.o\n$CXX $CXXFLAGS -std=c++11 $WORK/ares-test-fuzz.o \\\n    -o $OUT/ares_parse_reply_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/c-ares/.libs/libcares.a\n\n$CC $CFLAGS -I. -c $SRC/c-ares/test/ares-test-fuzz-name.c \\\n    -o $WORK/ares-test-fuzz-name.o\n$CXX $CXXFLAGS -std=c++11 $WORK/ares-test-fuzz-name.o \\\n    -o $OUT/ares_create_query_fuzzer \\\n    $LIB_FUZZING_ENGINE $SRC/c-ares/.libs/libcares.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nzip -j $OUT/ares_parse_reply_fuzzer_seed_corpus.zip $SRC/c-ares/test/fuzzinput/*\nzip -j $OUT/ares_create_query_fuzzer_seed_corpus.zip \\\n    $SRC/c-ares/test/fuzznames/*\n", "work_dir": "/src/c-ares", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=15388\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5697835103682560\n\nProject: c-ares\nFuzzer: libFuzzer_c-ares_ares_parse_reply_fuzzer\nFuzz target binary: ares_parse_reply_fuzzer\nJob Type: libfuzzer_ubsan_c-ares\nPlatform Id: linux\n\nCrash Type: Null-dereference READ\nCrash Address: 0x000000000000\nCrash State:\n  NULL\nSanitizer: undefined (UBSAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_ubsan_c-ares&range=201906180157:201906190155\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5697835103682560\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "5dd3629bc93449840c36dd635ea6cce606b8c366", "url": "https://github.com/c-ares/c-ares.git/commit/5dd3629bc93449840c36dd635ea6cce606b8c366"}]}
{"instance_id": "php.osv-2020-1735", "repo": "php/php-src", "base_commit": "a009d370e93fdc5928b2de9321d433ca39e7c6e6", "date": "2020-09-15T09:27:17", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout a009d370e93fdc5928b2de9321d433ca39e7c6e6\nRUN git clone https://github.com/kkos/oniguruma.git php-src/oniguruma\nWORKDIR php-src\nCOPY build.sh *.options $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# build oniguruma and link statically\npushd oniguruma\nautoreconf -vfi\n./configure\nmake -j$(nproc)\npopd\nexport ONIG_CFLAGS=\"-I$PWD/oniguruma/src\"\nexport ONIG_LIBS=\"-L$PWD/oniguruma/src/.libs -l:libonig.a\"\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# build project\n./buildconf\n./configure \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-mbstring \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-mbstring\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=25526\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5725932898484224\n\nProject: php\nFuzzing Engine: honggfuzz\nFuzz Target: php-fuzz-execute\nJob Type: honggfuzz_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x6120000145c0\nCrash State:\n  zend_gc_delref\n  i_zval_ptr_dtor\n  zval_ptr_dtor\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_php&range=202008280605:202008290628\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5725932898484224\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "cosmic.list", "content": "deb http://archive.ubuntu.com/ubuntu/ cosmic universe\n\n"}], "candidate_fixes": [{"sha": "3c53732332c4b9d3904eec0d1c42f0d4d4bf65c6", "url": "https://github.com/php/php-src.git/commit/3c53732332c4b9d3904eec0d1c42f0d4d4bf65c6"}]}
{"instance_id": "liblouis.osv-2023-599", "repo": "liblouis/liblouis", "base_commit": "2e9409c1b4f32e2c752bf22686c8e752ffd868e2", "date": "2023-12-04T09:36:00", "project_name": "liblouis", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool \\\n  pkg-config zlib1g-dev libpci-dev\nRUN git clone https://github.com/liblouis/liblouis\nRUN git -C liblouis checkout 2e9409c1b4f32e2c752bf22686c8e752ffd868e2\nWORKDIR liblouis\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n$SRC/liblouis/tests/fuzzing/build.sh\n", "work_dir": "/src/liblouis", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=60723\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6608976274653184\n\nProject: liblouis\nFuzzing Engine: libFuzzer\nFuzz Target: fuzz_translate_generic\nJob Type: libfuzzer_asan_liblouis\nPlatform Id: linux\n\nCrash Type: Negative-size-param\nCrash Address:\nCrash State:\n  passDoAction\n  translateString\n  _lou_translate\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_liblouis&range=202304240604:202304250611\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6608976274653184\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "878ef436e6cf401e5134899d70d5a8c0815cd549", "url": "https://github.com/liblouis/liblouis/commit/878ef436e6cf401e5134899d70d5a8c0815cd549"}]}
{"instance_id": "icu.osv-2023-873", "repo": "unicode-org/icu", "base_commit": "2ca7c49662cfa0455c211f310998302a2e0d64d9", "date": "2023-09-20T16:46:00", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout 2ca7c49662cfa0455c211f310998302a2e0d64d9\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62425\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4871952818634752\n\nProject: icu\nFuzzing Engine: libFuzzer\nFuzz Target: calendar_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: UNKNOWN WRITE\nCrash Address: 0x616400000c68\nCrash State:\n  icu_74::Calendar::set\n  calendar_fuzzer.cpp\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=202309140626:202309160609\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4871952818634752\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "6a42197331c23ed7e09d040f6deaa7c352c02cca", "url": "https://github.com/unicode-org/icu.git/commit/6a42197331c23ed7e09d040f6deaa7c352c02cca"}]}
{"instance_id": "serenity.osv-2021-315", "repo": "serenityos/serenity", "base_commit": "9aa91e6c6f267c843b92cf57eeae289ccae82799", "date": "2021-02-27T00:20:52", "project_name": "serenity", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y build-essential cmake curl e2fsprogs libmpfr-dev libmpc-dev libgmp-dev ninja-build\nRUN git clone https://github.com/SerenityOS/serenity\nRUN git -C serenity checkout 9aa91e6c6f267c843b92cf57eeae289ccae82799\nCOPY build.sh $SRC/\nWORKDIR $SRC/serenity/Meta/Lagom", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Now build the content\nmkdir -p build\ncd build\ncmake -GNinja \\\n    -DBUILD_LAGOM=ON \\\n    -DENABLE_OSS_FUZZ=ON \\\n    -DCMAKE_C_COMPILER=$CC \\\n    -DCMAKE_CXX_COMPILER=$CXX \\\n    -DCMAKE_CXX_FLAGS=\"$CXXFLAGS -DOSS_FUZZ=ON\" \\\n    -DLINKER_FLAGS=\"$LIB_FUZZING_ENGINE\" \\\n    ..\nninja\ncp Fuzzers/Fuzz* $OUT/\n\n", "work_dir": "/src/serenity/Meta/Lagom", "sanitizer": "honggfuzz", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=30507\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5911674068533248\n\nProject: serenity\nFuzzing Engine: honggfuzz\nFuzz Target: FuzzGIFLoader\nJob Type: honggfuzz_asan_serenity\nPlatform Id: linux\n\nCrash Type: Global-buffer-overflow READ 4\nCrash Address: 0x0000006ab150\nCrash State:\n  Gfx::decode_frame\n  Gfx::GIFImageDecoderPlugin::frame\n  Gfx::GIFImageDecoderPlugin::bitmap\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=honggfuzz_asan_serenity&range=202102060612:202102070602\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5911674068533248\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [], "candidate_fixes": [{"sha": "ce5fe2a6e807b819866b4f429ca6f7a2d74445b7", "url": "https://github.com/SerenityOS/serenity/commit/ce5fe2a6e807b819866b4f429ca6f7a2d74445b7"}]}
{"instance_id": "php.osv-2023-598", "repo": "php/php-src", "base_commit": "6ae9cf40d11eb31562246fbcac7cc73cdc8a2278", "date": "2023-08-01T11:40:25", "project_name": "php-src", "lang": "c++", "dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# The current clang revision is broken, pin to older one.\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && \\\n    apt-get install -y autoconf automake libtool bison re2c pkg-config\nRUN git clone --branch master https://github.com/php/php-src.git php-src\nRUN git -C php-src checkout 6ae9cf40d11eb31562246fbcac7cc73cdc8a2278\nWORKDIR php-src\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# PHP's zend_function union is incompatible with the object-size sanitizer\nexport CFLAGS=\"$CFLAGS -fno-sanitize=object-size\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=object-size\"\n\n# Disable JIT profitability checks.\nexport CFLAGS=\"$CFLAGS -DPROFITABILITY_CHECKS=0\"\n\n# Make sure the right assembly files are picked\nBUILD_FLAG=\"\"\nif [ \"$ARCHITECTURE\" = \"i386\" ]; then\n    BUILD_FLAG=\"--build=i686-pc-linux-gnu\"\nfi\n\n# build project\n./buildconf\n./configure $BUILD_FLAG \\\n    --disable-all \\\n    --enable-debug-assertions \\\n    --enable-option-checking=fatal \\\n    --enable-fuzzer \\\n    --enable-exif \\\n    --enable-opcache \\\n    --without-pcre-jit \\\n    --disable-phpdbg \\\n    --disable-cgi \\\n    --with-pic\nmake -j$(nproc)\n\n# Generate corpuses and dictionaries.\nsapi/cli/php sapi/fuzzer/generate_all.php\n\n# Copy dictionaries to expected locations.\ncp sapi/fuzzer/dict/unserialize $OUT/php-fuzz-unserialize.dict\ncp sapi/fuzzer/dict/parser $OUT/php-fuzz-parser.dict\ncp sapi/fuzzer/json.dict $OUT/php-fuzz-json.dict\n\nFUZZERS=\"php-fuzz-json\nphp-fuzz-exif\nphp-fuzz-unserialize\nphp-fuzz-unserializehash\nphp-fuzz-parser\nphp-fuzz-execute\"\nfor fuzzerName in $FUZZERS; do\n\tcp sapi/fuzzer/$fuzzerName $OUT/\ndone\n\n# The JIT fuzzer is fundamentally incompatible with memory sanitizer,\n# as that would require the JIT to emit msan instrumentation itself.\n# In practice it is currently also incompatible with ubsan.\nif [ \"$SANITIZER\" != \"memory\" ] && [ \"$SANITIZER\" != \"undefined\" ]; then\n    cp sapi/fuzzer/php-fuzz-function-jit $OUT/\n    cp sapi/fuzzer/php-fuzz-tracing-jit $OUT/\n\n    # Copy opcache.so extension, which does not support static linking.\n    mkdir -p $OUT/modules\n    cp modules/opcache.so $OUT/modules\nfi\n\n# copy corpora from source\nfor fuzzerName in `ls sapi/fuzzer/corpus`; do\n\tzip -j $OUT/php-fuzz-${fuzzerName}_seed_corpus.zip sapi/fuzzer/corpus/${fuzzerName}/*\ndone\n\n", "work_dir": "/src/php-src", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=60734\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5995844627988480\n\nProject: php\nFuzzing Engine: libFuzzer\nFuzz Target: php-fuzz-tracing-jit\nJob Type: libfuzzer_asan_php\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 4\nCrash Address: 0x604000026b50\nCrash State:\n  zval_call_destructor\n  zend_hash_reverse_apply\n  shutdown_destructors\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_php&range=202307170619:202307180605\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5995844627988480\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [], "candidate_fixes": [{"sha": "2fbec0974fd6ec89555f37356a8376f680b9bf49", "url": "https://github.com/php/php-src.git/commit/2fbec0974fd6ec89555f37356a8376f680b9bf49"}]}
{"instance_id": "harfbuzz.osv-2021-1381", "repo": "harfbuzz/harfbuzz", "base_commit": "a52c6df38a38c4e36ff991dfb4b7d92e48a44553", "date": "2021-09-27T16:18:36", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y python3-pip ragel pkg-config && \\\n    pip3 install meson==0.53.0 ninja\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout a52c6df38a38c4e36ff991dfb4b7d92e48a44553\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr -DHB_NO_VISIBILITY\"\n\n# setup\nbuild=$WORK/build\n\n# cleanup\nrm -rf $build\nmkdir -p $build\n\n# Build the library.\nmeson --default-library=static --wrap-mode=nodownload \\\n      -Dexperimental_api=true \\\n      -Dfuzzer_ldflags=\"$(echo $LIB_FUZZING_ENGINE)\" \\\n      $build \\\n  || (cat build/meson-logs/meson-log.txt && false)\n\n# Build the fuzzers.\nninja -v -j$(nproc) -C $build test/fuzzing/hb-{shape,draw,subset,set}-fuzzer\nmv $build/test/fuzzing/hb-{shape,draw,subset,set}-fuzzer $OUT/\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shape/data/in-house/fonts \\\n\ttest/shape/data/aots/fonts \\\n\ttest/shape/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\tperf/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-draw-fuzzer_seed_corpus.zip\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\nzip $OUT/hb-set-fuzzer_seed_corpus.zip ./test/fuzzing/sets/*\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39225\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5891183595880448\n\nProject: harfbuzz\nFuzzing Engine: libFuzzer\nFuzz Target: hb-subset-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 4\nCrash Address: 0x6190000043ec\nCrash State:\n  OT::MathValueRecord::copy\n  OT::MathGlyphAssembly::subset\n  OT::MathGlyphConstruction::subset\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=202109220610:202109230614\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5891183595880448\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "hb-draw-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-set-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "794b00db4b63e8314aee96c23a20ecb878452eef", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/794b00db4b63e8314aee96c23a20ecb878452eef"}]}
{"instance_id": "libraw.osv-2020-1519", "repo": "libraw/libraw", "base_commit": "371161a06d7f98f231a001dad4af2dfb463e270a", "date": "2021-07-27T07:02:08", "project_name": "libraw", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool pkg-config\nRUN git clone https://github.com/libraw/libraw\nRUN git -C libraw checkout 371161a06d7f98f231a001dad4af2dfb463e270a\nWORKDIR libraw\n\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_cr2_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_nef_fuzzer_seed_corpus.zip $SRC/\nADD http://oss-fuzz-corpus.storage.googleapis.com/libraw/libraw_raf_fuzzer_seed_corpus.zip $SRC/\n\nCOPY build.sh libraw_fuzzer.cc $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# copy corpuses\ncp $SRC/libraw_cr2_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_nef_fuzzer_seed_corpus.zip \\\n    $SRC/libraw_raf_fuzzer_seed_corpus.zip \\\n    $OUT/\n\n# build project\nautoreconf --install\n./configure --disable-examples\nmake\n\n# build fuzzers\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_cr2_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_nef_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n\n$CXX $CXXFLAGS -std=c++11 -Ilibraw \\\n    $SRC/libraw_fuzzer.cc -o $OUT/libraw_raf_fuzzer \\\n    $LIB_FUZZING_ENGINE lib/.libs/libraw.a\n", "work_dir": "/src/libraw", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=23837\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6229491834945536\n\nProject: libraw\nFuzzing Engine: libFuzzer\nFuzz Target: libraw_raf_fuzzer\nJob Type: libfuzzer_ubsan_libraw\nPlatform Id: linux\n\nCrash Type: Index-out-of-bounds\nCrash Address:\nCrash State:\n  DHT::hide_hots\n  LibRaw::dht_interpolate\n  LibRaw::dcraw_process\n \nSanitizer: undefined (UBSAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_ubsan_libraw&range=202006121756:202006130238\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6229491834945536\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "libraw_fuzzer.cc", "content": "/*  Copyright 2020 Google Inc.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\n#include <stddef.h>\n#include <stdint.h>\n\n#include <string>\n\n#include <libraw.h>\n\nenum InterpolationOptions {\n  Linear = 0,\n  Vng = 1, \n  Ppg = 2,\n  Ahd = 3,\n  Dcb = 4,\n  Dht = 11,\n  AhdModified = 12\n};\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t* data, size_t size) {\n  // Input less than 15mb\n  if (size > 15000000) {\n    return 0;\n  }\n\n  LibRaw lib_raw;\n\n  int result = lib_raw.open_buffer(\n      const_cast<char*>(reinterpret_cast<const char*>(data)), size);\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  result = lib_raw.unpack();\n  if (result != LIBRAW_SUCCESS) {\n    return 0;\n  }\n\n  InterpolationOptions options[] = {Linear, Vng, Ppg, Ahd, Dcb, Dht, AhdModified};\n\n  for (int i = 0; i < sizeof(options)/sizeof(*options); i++) {\n    lib_raw.output_params_ptr()->user_qual = static_cast<int>(options[i]);\n\n    result = lib_raw.dcraw_process();\n    if (result != LIBRAW_SUCCESS) {\n      return 0;\n    }\n  }\n\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "363e91ea656f4ce46584b4b0af6285030f236b7e", "url": "https://github.com/libraw/libraw/commit/363e91ea656f4ce46584b4b0af6285030f236b7e"}]}
{"instance_id": "harfbuzz.osv-2018-129", "repo": "harfbuzz/harfbuzz", "base_commit": "cf4b7db6b1e01c11d7a8a26d95cf947935a234a7", "date": "2018-12-05T04:53:23", "project_name": "harfbuzz", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER mmoroz@chromium.org\nRUN apt-get update && apt-get install -y make autoconf automake libtool ragel pkg-config\n\nRUN git clone https://github.com/harfbuzz/harfbuzz.git\nRUN git -C harfbuzz checkout cf4b7db6b1e01c11d7a8a26d95cf947935a234a7\nWORKDIR harfbuzz\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Disable:\n# 1. UBSan vptr since target built with -fno-rtti.\nexport CFLAGS=\"$CFLAGS -fno-sanitize=vptr\"\nexport CXXFLAGS=\"$CXXFLAGS -fno-sanitize=vptr\"\n\n# Build the library.\n./autogen.sh\n./configure --enable-static --disable-shared\nmake clean\nmake -j$(nproc) CPPFLAGS=\"-DHB_NO_VISIBILITY\" V=1 all\n\n# Build the fuzzer.\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-shape-fuzzer.cc -o $OUT/hb-shape-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz.a\n\n$CXX $CXXFLAGS -std=c++11 -Isrc \\\n    ./test/fuzzing/hb-subset-fuzzer.cc -o $OUT/hb-subset-fuzzer \\\n    -lFuzzingEngine ./src/.libs/libharfbuzz-subset.a ./src/.libs/libharfbuzz.a\n\n# Archive and copy to $OUT seed corpus if the build succeeded.\nmkdir all-fonts\nfor d in \\\n\ttest/shaping/data/in-house/fonts \\\n\ttest/shaping/data/aots/fonts \\\n\ttest/shaping/data/text-rendering-tests/fonts \\\n\ttest/api/fonts \\\n\ttest/fuzzing/fonts \\\n\t; do\n\tcp $d/* all-fonts/\ndone\nzip $OUT/hb-shape-fuzzer_seed_corpus.zip all-fonts/*\ncp $OUT/hb-shape-fuzzer_seed_corpus.zip $OUT/hb-subset-fuzzer_seed_corpus.zip\n", "work_dir": "/src/harfbuzz", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=11657\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5700264032468992\n\nProject: harfbuzz\nFuzzer: libFuzzer_harfbuzz_hb-shape-fuzzer\nFuzz target binary: hb-shape-fuzzer\nJob Type: libfuzzer_asan_harfbuzz\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 2\nCrash Address: 0x617000000688\nCrash State:\n  BEInt<unsigned short, 2>::operator unsigned short\n  OT::IntType<unsigned short, 2u>::operator unsigned int\n  CFF::Charset1_2<OT::IntType<unsigned char, 1u> >::get_glyph\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_harfbuzz&range=201812010220:201812020220\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5700264032468992\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for more information.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [{"filename": "hb-shape-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}, {"filename": "hb-subset-fuzzer.options", "content": "[libfuzzer]\ntimeout = 5\n"}], "candidate_fixes": [{"sha": "79e7e3445efef2dc57f8a10c7e355e802af08868", "url": "https://github.com/harfbuzz/harfbuzz.git/commit/79e7e3445efef2dc57f8a10c7e355e802af08868"}]}
{"instance_id": "serenity.osv-2021-397", "repo": "serenityos/serenity", "base_commit": "4d40864b9dc3837c00b1d02b567d6a648e0048f2", "date": "2021-02-14T07:30:10", "project_name": "serenity", "lang": "c++", "dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y build-essential cmake curl e2fsprogs libmpfr-dev libmpc-dev libgmp-dev ninja-build\nRUN git clone https://github.com/SerenityOS/serenity\nRUN git -C serenity checkout 4d40864b9dc3837c00b1d02b567d6a648e0048f2\nCOPY build.sh $SRC/\nWORKDIR $SRC/serenity/Meta/Lagom", "build_sh": "#!/bin/bash -eu\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Now build the content\nmkdir -p build\ncd build\ncmake -GNinja \\\n    -DBUILD_LAGOM=ON \\\n    -DENABLE_OSS_FUZZ=ON \\\n    -DCMAKE_C_COMPILER=$CC \\\n    -DCMAKE_CXX_COMPILER=$CXX \\\n    -DCMAKE_CXX_FLAGS=\"$CXXFLAGS -DOSS_FUZZ=ON\" \\\n    -DLINKER_FLAGS=\"$LIB_FUZZING_ENGINE\" \\\n    ..\nninja\ncp Fuzzers/Fuzz* $OUT/\n\n", "work_dir": "/src/serenity/Meta/Lagom", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=30920\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5566060432588800\n\nProject: serenity\nFuzzing Engine: libFuzzer\nFuzz Target: FuzzRSAKeyParsing\nJob Type: libfuzzer_asan_serenity\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x60a000000520\nCrash State:\n  Crypto::UnsignedBigInteger::UnsignedBigInteger\n  Crypto::UnsignedBigInteger::import_data\n  Crypto::der_decode_integer\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_serenity&range=202102080622:202102130619\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5566060432588800\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.", "additional_files": [], "candidate_fixes": [{"sha": "3fe7ac0924ada70faaf27636b6e0f40bcde24f77", "url": "https://github.com/SerenityOS/serenity/commit/3fe7ac0924ada70faaf27636b6e0f40bcde24f77"}]}
{"instance_id": "systemd.osv-2020-682", "repo": "systemd/systemd", "base_commit": "16b4623620acdccb232392901074a61e360aa2a4", "date": "2019-03-22T16:07:47", "project_name": "systemd", "lang": "c++", "dockerfile": "# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nMAINTAINER jonathan@titanous.com\nRUN apt-get update &&\\\n    apt-get install -y gperf m4 gettext python3-pip \\\n        libcap-dev libmount-dev libkmod-dev \\\n        pkg-config wget &&\\\n    pip3 install meson ninja\nRUN git clone https://github.com/systemd/systemd systemd\nRUN git -C systemd checkout 16b4623620acdccb232392901074a61e360aa2a4\nWORKDIR systemd\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\ntools/oss-fuzz.sh\n", "work_dir": "/src/systemd", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=13878\n## Description:\nDetailed report: https://oss-fuzz.com/testcase?key=5751069692395520\n\nProject: systemd\nFuzzer: libFuzzer_systemd_fuzz-link-parser\nFuzz target binary: fuzz-link-parser\nJob Type: libfuzzer_asan_systemd\nPlatform Id: linux\n\nCrash Type: Heap-use-after-free READ 8\nCrash Address: 0x603000000170\nCrash State:\n  condition_free_list_type\n  link_config_free\n  link_load_one\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_systemd&range=201903210209:201903230207\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5751069692395520\n\nIssue filed automatically.\n\nSee https://github.com/google/oss-fuzz/blob/master/docs/reproducing.md for instructions to reproduce this bug locally.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.\n\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues.", "additional_files": [], "candidate_fixes": [{"sha": "7bb55ed099f611ec7077db69684a6cb93d42dc70", "url": "https://github.com/systemd/systemd/commit/7bb55ed099f611ec7077db69684a6cb93d42dc70"}]}
{"instance_id": "icu.osv-2023-849", "repo": "unicode-org/icu", "base_commit": "832997c57e7ad4a128447d8c90ee338d90a0faf3", "date": "2023-09-15T12:46:23", "project_name": "icu", "lang": "c++", "dockerfile": "# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make\n\nRUN git clone https://github.com/unicode-org/icu.git icu\nRUN git -C icu checkout 832997c57e7ad4a128447d8c90ee338d90a0faf3\nCOPY build.sh $SRC/", "build_sh": "#!/bin/bash -eux\n#\n# Copyright 2016 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nmkdir $WORK/icu\ncd $WORK/icu\n\n# TODO: icu build failes without -DU_USE_STRTOD_L=0\nDEFINES=\"-DU_CHARSET_IS_UTF8=1 -DU_USING_ICU_NAMESPACE=0 -DU_ENABLE_DYLOAD=0 -DU_USE_STRTOD_L=0\"\nCFLAGS=\"$CFLAGS $DEFINES\"\nCXXFLAGS=\"$CXXFLAGS $DEFINES\"\n\nCFLAGS=$CFLAGS CXXFLAGS=$CXXFLAGS CC=$CC CXX=$CXX \\\n  /bin/bash $SRC/icu/icu4c/source/runConfigureICU Linux \\\n   --with-library-bits=64 --with-data-packaging=static --enable-static --disable-shared\n\nexport ASAN_OPTIONS=\"detect_leaks=0\"\nexport UBSAN_OPTIONS=\"detect_leaks=0\"\n\nmake -j$(nproc)\n\n$CXX $CXXFLAGS -std=c++11 -c $SRC/icu/icu4c/source/test/fuzzer/locale_util.cpp \\\n     -I$SRC/icu4c/source/test/fuzzer\n\nFUZZER_PATH=$SRC/icu/icu4c/source/test/fuzzer\n# Assumes that all fuzzers files end with'_fuzzer.cpp'.\nFUZZERS=$FUZZER_PATH/*_fuzzer.cpp\n\nfor fuzzer in $FUZZERS; do\n  file=${fuzzer:${#FUZZER_PATH}+1}\n  $CXX $CXXFLAGS -std=c++11 \\\n    $fuzzer -o $OUT/${file/.cpp/} locale_util.o \\\n    -I$SRC/icu/icu4c/source/common -I$SRC/icu/icu4c/source/i18n -L$WORK/icu/lib \\\n    $LIB_FUZZING_ENGINE -licui18n -licuuc -licutu -licudata\ndone\n\n# Assumes that all seed files end with '*_fuzzer_seed_corpus.txt'.\nCORPUS=$SRC/icu/icu4c/source/test/fuzzer/*_fuzzer_seed_corpus.txt\nfor corpus in $CORPUS; do\n    zipfile=${corpus:${#FUZZER_PATH}+1}\n    zip $OUT/${zipfile/.txt/.zip} $corpus\ndone\n\ncp $SRC/icu/icu4c/source/test/fuzzer/*.dict  $OUT/\n", "work_dir": "/src/icu", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=62348\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=4822681071255552\n\nProject: icu\nFuzzing Engine: libFuzzer\nFuzz Target: locale_morph_fuzzer\nJob Type: libfuzzer_asan_icu\nPlatform Id: linux\n\nCrash Type: Stack-buffer-overflow WRITE 1\nCrash Address: 0x7ffc60b2cc54\nCrash State:\n  ulocimp_toLanguageTag_74\n  icu_74::Locale::toLanguageTag\n  locale_morph_fuzzer.cpp\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: High\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_icu&range=202309050627:202309060613\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=4822681071255552\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "386e9a10db28af620658ca0c635e1d98915f6306", "url": "https://github.com/unicode-org/icu.git/commit/386e9a10db28af620658ca0c635e1d98915f6306"}]}
{"instance_id": "espeak-ng.osv-2021-1354", "repo": "espeak-ng/espeak-ng", "base_commit": "ccb1c31ba3cfa785d27c5974f3be65df2967e7a0", "date": "2021-11-07T07:55:57", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout ccb1c31ba3cfa785d27c5974f3be65df2967e7a0\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=39042\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6480243527909376\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Stack-buffer-underflow READ 8\nCrash Address: 0x7f0f709db000\nCrash State:\n  InterpretPhoneme\n  InterpretPhoneme2\n  CalcLengths\n \nSanitizer: address (ASAN)\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202109090610:202109100607\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6480243527909376\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "be962b067b889852da6194342b26e1759e1d7952", "url": "https://github.com/espeak-ng/espeak-ng/commit/be962b067b889852da6194342b26e1759e1d7952"}]}
{"instance_id": "libexif.osv-2021-1138", "repo": "libexif/libexif", "base_commit": "790fb01e1c33c5c83e7f3e051fe6c6d5c3396ade", "date": "2021-08-16T05:10:12", "project_name": "libexif", "lang": "c++", "dockerfile": "# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt-get install -y make autoconf automake libtool gettext autopoint\nRUN git clone https://github.com/libexif/libexif\nRUN git -C libexif checkout 790fb01e1c33c5c83e7f3e051fe6c6d5c3396ade\nRUN git clone --depth 1 https://github.com/ianare/exif-samples\nWORKDIR libexif\nCOPY exif_loader_fuzzer.cc exif_from_data_fuzzer.cc build.sh $SRC/", "build_sh": "#!/bin/bash -eu\n# Copyright 2018 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nautoreconf -fiv\n./configure --disable-docs --enable-shared=no --prefix=\"$WORK\"\nmake -j$(nproc)\nmake install\n\npushd $SRC\nmkdir -p exif_corpus\nfind exif-samples -type f -name '*.jpg' -exec mv -n {} exif_corpus/ \\; -o -name '*.tiff' -exec mv -n {} exif_corpus/ \\;\ncp libexif/test/testdata/*.jpg exif_corpus\nzip -r \"$WORK/exif_seed_corpus.zip\" exif_corpus/\npopd\n\nfor fuzzer in $(find $SRC/ -name '*_fuzzer.cc'); do\n  fuzzer_basename=$(basename -s .cc $fuzzer)\n  $CXX $CXXFLAGS \\\n      -std=c++11 \\\n      -I\"$WORK/include\" \\\n      $fuzzer \\\n      -o $OUT/$fuzzer_basename \\\n      $LIB_FUZZING_ENGINE \\\n      \"$WORK/lib/libexif.a\"\n  cp $WORK/exif_seed_corpus.zip \"${OUT}/${fuzzer_basename}_seed_corpus.zip\"\ndone\n", "work_dir": "/src/libexif", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=37226\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=5021203147390976\n\nProject: libexif\nFuzzing Engine: libFuzzer\nFuzz Target: exif_from_data_fuzzer\nJob Type: libfuzzer_asan_libexif\nPlatform Id: linux\n\nCrash Type: Heap-buffer-overflow READ 1\nCrash Address: 0x615000000505\nCrash State:\n  exif_get_sshort\n  exif_get_short\n  exif_mnote_data_apple_load\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_libexif&range=202108140610:202108150609\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=5021203147390976\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [{"filename": "exif_from_data_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <libexif/exif-data.h>\n#include <libexif/exif-loader.h>\n#include <stddef.h>\n#include <stdlib.h>\n\n/* Extract all MakerNote tags */\nstatic void mnote_dump(ExifData *data) {\n    ExifMnoteData *mn = exif_data_get_mnote_data(data);\n    if (mn) {\n        int num = exif_mnote_data_count(mn);\n\n        /* Loop through all MakerNote tags */\n        for (int i=0; i < num; ++i) {\n            char buf[1024];\n            exif_mnote_data_get_value(mn, i, buf, sizeof(buf));\n        }\n    }\n}\n\nstatic void dump_value(ExifEntry *entry, void *user_data) {\n  char buf[1024];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nstatic void data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, dump_value, NULL);\n}\n\n/* This is like exif_data_dump but without writing to stdout */\nstatic void data_dump(ExifData *data) {\n  exif_data_foreach_content(data, data_func, NULL);\n}\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n\n  // Parse tags using (ultimately) exif_data_load_data()\n  auto image = exif_data_new_from_data(data, size);\n  if (image) {\n    // Exercise the EXIF tag manipulation code\n    exif_data_get_mnote_data(image);\n    data_dump(image);\n    mnote_dump(image);\n    unsigned char *buf;\n    unsigned int sz;\n    exif_data_save_data(image, &buf, &sz);\n    free(buf);\n    exif_data_fix(image);\n    exif_data_unref(image);\n  }\n\n  return 0;\n}\n"}, {"filename": "exif_loader_fuzzer.cc", "content": "// Copyright 2020 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n#include <stdio.h>\n#include <stdint.h>\n#include <libexif/exif-loader.h>\n\n\nvoid content_func(ExifEntry *entry, void *user_data) {\n  char buf[10000];\n  exif_entry_get_value(entry, buf, sizeof(buf));\n}\n\nvoid data_func(ExifContent *content, void *user_data) {\n  exif_content_foreach_entry(content, content_func, NULL);\n}\n\nstatic void\ntest_exif_data (ExifData *d) {\n  unsigned int i, c;\n  char v[1024], *p;\n  ExifMnoteData *md;\n\n  md = exif_data_get_mnote_data (d);\n  if (!md) {\n    return;\n  }\n\n  exif_mnote_data_ref (md);\n  exif_mnote_data_unref (md);\n\n  c = exif_mnote_data_count (md);\n  for (i = 0; i < c; i++) {\n    const char *name = exif_mnote_data_get_name (md, i);\n    if (!name) {\n      break;\n    }\n    exif_mnote_data_get_title (md, i);\n    exif_mnote_data_get_description (md, i);\n    exif_mnote_data_get_value (md, i, v, sizeof (v));\n  }\n}\n\n\nextern \"C\" int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n  ExifLoader *loader = exif_loader_new();\n  ExifData *exif_data;\n  if (!loader) {\n    return 0;\n  }\n  exif_loader_write(loader, const_cast<unsigned char*>(data), size);\n  exif_data = exif_loader_get_data(loader);\n  if(!exif_data) {\n    exif_loader_unref(loader);\n    return 0;\n  }\n  exif_data_foreach_content(exif_data, data_func, NULL);\n  test_exif_data (exif_data);\n  exif_loader_unref(loader);\n  exif_data_unref(exif_data);\n  return 0;\n}\n"}], "candidate_fixes": [{"sha": "eb452f533b2d906130a557ced3d6e38d7b064ff9", "url": "https://github.com/libexif/libexif/commit/eb452f533b2d906130a557ced3d6e38d7b064ff9"}]}
{"instance_id": "espeak-ng.osv-2021-769", "repo": "espeak-ng/espeak-ng", "base_commit": "43d07abec4abf07cc536e4fcf13088508231da76", "date": "2022-03-11T11:31:53", "project_name": "espeak-ng", "lang": "c++", "dockerfile": "# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM hwiwonlee/secb.base:latest\nRUN apt-get update && apt install -y automake autoconf libtool pkg-config\nRUN git clone https://github.com/espeak-ng/espeak-ng\nRUN git -C espeak-ng checkout 43d07abec4abf07cc536e4fcf13088508231da76\nCOPY build.sh $SRC\nWORKDIR $SRC/espeak-ng", "build_sh": "#!/bin/bash -eu\n# Copyright 2021 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n\n# build project\nexport ASAN_OPTIONS=detect_leaks=0\n./autogen.sh\n./configure --with-libfuzzer=yes --disable-shared --with-speechplayer=no\nmake check || true\ncp tests/ssml-fuzzer.test $OUT/ssml-fuzzer\ncp -r espeak-ng-data/ $OUT/\n", "work_dir": "/src/espeak-ng", "sanitizer": "", "bug_description": "================= Bug Report (1/1) ==================\n## Source: Chromium\n## URL: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=34332\n## Description:\nDetailed Report: https://oss-fuzz.com/testcase?key=6060397091225600\n\nProject: espeak-ng\nFuzzing Engine: libFuzzer\nFuzz Target: ssml-fuzzer\nJob Type: libfuzzer_asan_espeak-ng\nPlatform Id: linux\n\nCrash Type: Stack-buffer-overflow READ 16\nCrash Address: 0x7f78eb3a6120\nCrash State:\n  TranslateClause\n  SpeakNextClause\n  Synthesize\n \nSanitizer: address (ASAN)\n\nRecommended Security Severity: Medium\n\nRegressed: https://oss-fuzz.com/revisions?job=libfuzzer_asan_espeak-ng&range=202105130601:202105140612\n\nReproducer Testcase: https://oss-fuzz.com/download?testcase_id=6060397091225600\n\nIssue filed automatically.\n\nSee https://google.github.io/oss-fuzz/advanced-topics/reproducing for instructions to reproduce this bug locally.\nWhen you fix this bug, please\n  * mention the fix revision(s).\n  * state whether the bug was a short-lived regression or an old bug in any stable releases.\n  * add any other useful information.\nThis information can help downstream consumers.\n\nIf you need to contact the OSS-Fuzz team with a question, concern, or any other feedback, please file an issue at https://github.com/google/oss-fuzz/issues. Comments on individual Monorail issues are not monitored.\n\nThis bug is subject to a 90 day disclosure deadline. If 90 days elapse\nwithout an upstream patch, then the bug report will automatically\nbecome visible to the public.", "additional_files": [], "candidate_fixes": [{"sha": "7f1222c6ad6a3652be35afbbc980a382076ff0a9", "url": "https://github.com/espeak-ng/espeak-ng/commit/7f1222c6ad6a3652be35afbbc980a382076ff0a9"}]}
