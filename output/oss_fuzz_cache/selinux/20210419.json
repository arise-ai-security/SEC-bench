{
  "commit": "ef2f42b3b10af381d3d55cc901fde0729e54573b",
  "files": {
    "Dockerfile": "# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM gcr.io/oss-fuzz-base/base-builder\nRUN apt-get update && \\\n    apt-get install -y bison \\\n\tflex \\\n\tgawk \\\n\tgettext \\\n\tmake \\\n\tlibaudit-dev \\\n\tlibbz2-dev \\\n\tlibcap-dev \\\n\tlibcap-ng-dev \\\n\tlibglib2.0-dev \\\n\tlibpcre3-dev \\\n\txmlto\nRUN git clone --depth 1 https://github.com/SELinuxProject/selinux\nWORKDIR selinux\nCOPY build.sh *.c $SRC/\n",
    "build.sh": "#!/bin/bash -e\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nexport DESTDIR=$(pwd)/DESTDIR\nexport LDFLAGS=\"${LDFLAGS:-} $CFLAGS\"\n\nfind -name Makefile | xargs sed -i 's/,-z,defs//'\nmake V=1 -j$(nproc) install\n\n$CC $CFLAGS -I$DESTDIR/usr/include -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64 -c -o secilc-fuzzer.o $SRC/secilc-fuzzer.c\n$CXX $CXXFLAGS $LIB_FUZZING_ENGINE secilc-fuzzer.o $DESTDIR/usr/lib/libsepol.a -o $OUT/secilc-fuzzer\nzip -r $OUT/secilc-fuzzer_seed_corpus.zip secilc/test\n",
    "project.yaml": "homepage: \"https://github.com/SELinuxProject/selinux\"\nlanguage: c\nprimary_contact: \"nicolas.iooss_ossfuzzselinux@m4x.org\"\nbuilds_per_day: 4\nsanitizers:\n  - address\n  - undefined\n  - memory\nauto_ccs:\n  - evverx@gmail.com\n  - nicolas.iooss.ossfuzz@gmail.com\n  - omosnacek@gmail.com\n  - jwcart2@gmail.com\nmain_repo: 'https://github.com/SELinuxProject/selinux'\n",
    "secilc-fuzzer.c": "/*\n# Copyright 2020 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n*/\n\n#include <stdlib.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <string.h>\n#include <getopt.h>\n#include <sys/stat.h>\n\n#include <sepol/cil/cil.h>\n#include <sepol/policydb.h>\n\nint LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {\n\tenum cil_log_level log_level = CIL_ERR;\n\tstruct sepol_policy_file *pf = NULL;\n\tFILE *dev_null = NULL;\n\tint target = SEPOL_TARGET_SELINUX;\n\tint disable_dontaudit = 0;\n\tint multiple_decls = 0;\n\tint disable_neverallow = 0;\n\tint preserve_tunables = 0;\n\tint policyvers = POLICYDB_VERSION_MAX;\n\tint mls = -1;\n\tint attrs_expand_generated = 0;\n\tstruct cil_db *db = NULL;\n\tsepol_policydb_t *pdb = NULL;\n\n\tcil_set_log_level(log_level);\n\n\tcil_db_init(&db);\n\tcil_set_disable_dontaudit(db, disable_dontaudit);\n\tcil_set_multiple_decls(db, multiple_decls);\n\tcil_set_disable_neverallow(db, disable_neverallow);\n\tcil_set_preserve_tunables(db, preserve_tunables);\n\tcil_set_mls(db, mls);\n\tcil_set_target_platform(db, target);\n\tcil_set_policy_version(db, policyvers);\n\tcil_set_attrs_expand_generated(db, attrs_expand_generated);\n\n\tif (cil_add_file(db, \"fuzz\", data, size) != SEPOL_OK)\n\t\tgoto exit;\n\n\tif (cil_compile(db) != SEPOL_OK)\n\t\tgoto exit;\n\n\tif (cil_build_policydb(db, &pdb) != SEPOL_OK)\n\t\tgoto exit;\n\n\tif (sepol_policydb_optimize(pdb) != SEPOL_OK)\n\t\tgoto exit;\n\n\tdev_null = fopen(\"/dev/null\", \"w\");\n\tif (dev_null == NULL)\n\t\tgoto exit;\n\n\tif (sepol_policy_file_create(&pf) != 0)\n\t\tgoto exit;\n\n\tsepol_policy_file_set_fp(pf, dev_null);\n\n\tif (sepol_policydb_write(pdb, pf) != 0)\n\t\tgoto exit;\nexit:\n\tif (dev_null != NULL)\n\t\tfclose(dev_null);\n\n\tcil_db_destroy(&db);\n\tsepol_policydb_free(pdb);\n\tsepol_policy_file_free(pf);\n\treturn 0;\n}\n"
  },
  "date": "2021-04-19T10:40:26",
  "cached_at": "2025-10-24T20:28:04.256567"
}