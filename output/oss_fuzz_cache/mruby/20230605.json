{
  "commit": "a455e651de867eb7aed4c351b424d1d9538f4e50",
  "files": {
    "Dockerfile": "# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\nFROM gcr.io/oss-fuzz-base/base-builder\nRUN apt-get update && apt-get install -y build-essential ruby bison ninja-build \\\n    cmake zlib1g-dev libbz2-dev liblzma-dev\nRUN git clone --depth 1 https://github.com/mruby/mruby mruby\nRUN git clone --depth 1 https://github.com/bshastry/mruby_seeds.git mruby_seeds\nRUN git clone --depth 1 https://github.com/google/libprotobuf-mutator.git\nRUN mkdir LPM; \\\n  cd LPM; \\\n  cmake $SRC/libprotobuf-mutator -GNinja -DLIB_PROTO_MUTATOR_DOWNLOAD_PROTOBUF=ON -DLIB_PROTO_MUTATOR_TESTING=OFF -DCMAKE_BUILD_TYPE=Release; \\\n  ninja;\n\nCOPY build.sh $SRC\n",
    "build.sh": "#!/bin/bash -eu\n# Copyright 2019 Google Inc.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n################################################################################\n\n# Instrument mruby\n(\ncd $SRC/mruby\nexport LD=$CC\nexport LDFLAGS=\"$CFLAGS\"\nrake -m\n\n# build fuzzers\nFUZZ_TARGET=$SRC/mruby/oss-fuzz/mruby_fuzzer.c\nname=$(basename $FUZZ_TARGET .c)\n$CC -c $CFLAGS -Iinclude \\\n     ${FUZZ_TARGET} -o $OUT/${name}.o\n$CXX $CXXFLAGS $OUT/${name}.o $LIB_FUZZING_ENGINE -lm \\\n    $SRC/mruby/build/host/lib/libmruby.a -o $OUT/${name}\nrm -f $OUT/${name}.o\n)\n\n# Construct options files\ncat > $SRC/mruby/oss-fuzz/config/mruby_fuzzer.options <<EOF\n[libfuzzer]\ndict = mruby.dict\nonly_ascii = 1\nEOF\ncp $SRC/mruby/oss-fuzz/config/mruby_fuzzer.options $SRC/mruby/oss-fuzz/config/mruby_proto_fuzzer.options\n\n# Build proto fuzzer: ASan and UBSan\nif [[ $CFLAGS != *sanitize=memory* ]]; then\n    PROTO_FUZZ_TARGET=$SRC/mruby/oss-fuzz/mruby_proto_fuzzer.cpp\n    PROTO_CONVERTER=$SRC/mruby/oss-fuzz/proto_to_ruby.cpp\n    rm -rf $SRC/mruby/genfiles\n    mkdir $SRC/mruby/genfiles\n    $SRC/LPM/external.protobuf/bin/protoc --proto_path=$SRC/mruby/oss-fuzz ruby.proto --cpp_out=$SRC/mruby/genfiles\n    $CXX -c $CXXFLAGS $SRC/mruby/genfiles/ruby.pb.cc -DNDEBUG -o $SRC/mruby/genfiles/ruby.pb.o -I $SRC/LPM/external.protobuf/include\n    $CXX -I $SRC/mruby/include -I $SRC/LPM/external.protobuf/include $CXXFLAGS $PROTO_FUZZ_TARGET $SRC/mruby/genfiles/ruby.pb.o $PROTO_CONVERTER \\\n      -I $SRC/mruby/genfiles \\\n      -I $SRC/libprotobuf-mutator \\\n      -I $SRC/mruby/include -lz -lm \\\n      $SRC/LPM/src/libfuzzer/libprotobuf-mutator-libfuzzer.a \\\n      $SRC/LPM/src/libprotobuf-mutator.a \\\n      -Wl,--start-group $SRC/LPM/external.protobuf/lib/lib*.a -Wl,--end-group \\\n      $SRC/mruby/build/host/lib/libmruby.a \\\n      $LIB_FUZZING_ENGINE \\\n      -o $OUT/mruby_proto_fuzzer\n\n    # Copy config\n    cp $SRC/mruby/oss-fuzz/config/mruby_proto_fuzzer.options $OUT\nfi\n\n# dict and config\ncp $SRC/mruby/oss-fuzz/config/mruby.dict $OUT\ncp $SRC/mruby/oss-fuzz/config/mruby_fuzzer.options $OUT\n\n# seeds\nzip -rq $OUT/mruby_fuzzer_seed_corpus $SRC/mruby_seeds\n",
    "project.yaml": "homepage: https://www.mruby.org/\nlanguage: c++\nprimary_contact: \"yukihiro@gmail.com\"\nauto_ccs:\n  - \"bshas3@gmail.com\"\nsanitizers:\n  - address\n  - memory\n  - undefined\nmain_repo: 'https://github.com/mruby/mruby'\n\nfuzzing_engines:\n  - afl\n  - honggfuzz\n  - libfuzzer\n\n"
  },
  "date": "2023-06-05T10:31:36",
  "cached_at": "2025-10-24T18:26:45.718599"
}